  [1m[36m (457.2ms)[0m  [1mCREATE DATABASE "baukis_test" ENCODING = 'unicode'[0m
  [1m[36m (5.9ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) [0m
  [1m[35m (6.2ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateStaffMembers (20140723082116)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (9.6ms)[0m  [1mCREATE TABLE "staff_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "hashed_password" character varying(255), "start_date" date NOT NULL, "end_date" date, "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (2.9ms)[0m  CREATE UNIQUE INDEX  "index_staff_members_on_email_for_index" ON "staff_members"  ("email_for_index")
  [1m[36m (3.7ms)[0m  [1mCREATE  INDEX  "index_staff_members_on_family_name_kana_and_given_name_kana" ON "staff_members"  ("family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140723082116"]]
  [1m[36m (2.0ms)[0m  [1mCOMMIT[0m
Migrating to CreateAdminMembers (20140723111825)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (8.7ms)[0m  [1mCREATE TABLE "admin_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "hashed_password" character varying(255), "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (4.7ms)[0m  CREATE UNIQUE INDEX  "index_admin_members_on_email_for_index" ON "admin_members"  ("email_for_index")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140723111825"]]
  [1m[35m (2.1ms)[0m  COMMIT
Migrating to CreateStaffEvents (20140803013844)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (4.6ms)[0m  CREATE TABLE "staff_events" ("id" serial primary key, "staff_member_id" integer NOT NULL, "type" character varying(255) NOT NULL, "created_at" timestamp NOT NULL) 
  [1m[36m (3.6ms)[0m  [1mCREATE  INDEX  "index_staff_events_on_created_at" ON "staff_events"  ("created_at")[0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_staff_events_on_staff_member_id_and_created_at" ON "staff_events"  ("staff_member_id", "created_at")
  [1m[36m (2.5ms)[0m  [1mALTER TABLE "staff_events" ADD CONSTRAINT "staff_events_staff_member_id_fk" FOREIGN KEY ("staff_member_id") REFERENCES "staff_members"(id)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140803013844"]]
  [1m[36m (2.1ms)[0m  [1mCOMMIT[0m
Migrating to CreateCustomers (20140809065211)
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (14.8ms)[0m  [1mCREATE TABLE "customers" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "gender" character varying(255), "birthday" date, "hashed_password" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (2.7ms)[0m  CREATE UNIQUE INDEX  "index_customers_on_email_for_index" ON "customers"  ("email_for_index")
  [1m[36m (2.4ms)[0m  [1mCREATE  INDEX  "index_customers_on_family_name_kana_and_given_name_kana" ON "customers"  ("family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140809065211"]]
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Migrating to CreateAddresses (20140809065229)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (9.7ms)[0m  [1mCREATE TABLE "addresses" ("id" serial primary key, "customer_id" integer NOT NULL, "type" character varying(255) NOT NULL, "postal_code" character varying(255) NOT NULL, "prefecture" character varying(255) NOT NULL, "city" character varying(255) NOT NULL, "address1" character varying(255) NOT NULL, "address2" character varying(255) NOT NULL, "company_name" character varying(255) DEFAULT '' NOT NULL, "division_name" character varying(255) DEFAULT '' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_addresses_on_customer_id" ON "addresses"  ("customer_id")
  [1m[36m (2.8ms)[0m  [1mCREATE UNIQUE INDEX  "index_addresses_on_type_and_customer_id" ON "addresses"  ("type", "customer_id")[0m
  [1m[35m (1.8ms)[0m  ALTER TABLE "addresses" ADD CONSTRAINT "addresses_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140809065229"]]
  [1m[35m (4.0ms)[0m  COMMIT
Migrating to CreatePhones (20140811122237)
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (6.7ms)[0m  CREATE TABLE "phones" ("id" serial primary key, "customer_id" integer NOT NULL, "address_id" integer, "number" character varying(255) NOT NULL, "number_for_index" character varying(255) NOT NULL, "primary" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (2.4ms)[0m  [1mCREATE  INDEX  "index_phones_on_customer_id" ON "phones"  ("customer_id")[0m
  [1m[35m (4.0ms)[0m  CREATE  INDEX  "index_phones_on_address_id" ON "phones"  ("address_id")
  [1m[36m (5.0ms)[0m  [1mCREATE  INDEX  "index_phones_on_number_for_index" ON "phones"  ("number_for_index")[0m
  [1m[35m (2.7ms)[0m  ALTER TABLE "phones" ADD CONSTRAINT "phones_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (1.2ms)[0m  [1mALTER TABLE "phones" ADD CONSTRAINT "phones_address_id_fk" FOREIGN KEY ("address_id") REFERENCES "addresses"(id)[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140811122237"]]
  [1m[36m (1.8ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers1 (20140812034537)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "customers" ADD COLUMN "birth_year" integer[0m
  [1m[35m (0.2ms)[0m  ALTER TABLE "customers" ADD COLUMN "birth_month" integer
  [1m[36m (0.2ms)[0m  [1mALTER TABLE "customers" ADD COLUMN "birth_mday" integer[0m
  [1m[35m (2.9ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_birth_month_and_birth_mday" ON "customers"  ("birth_year", "birth_month", "birth_mday")
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_birth_mday" ON "customers"  ("birth_month", "birth_mday")[0m
  [1m[35m (2.9ms)[0m  CREATE  INDEX  "index_customers_on_given_name_kana" ON "customers"  ("given_name_kana")
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_year_and_furigana" ON "customers"  ("birth_year", "family_name_kana", "given_name_kana")[0m
  [1m[35m (4.9ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_given_name_kana" ON "customers"  ("birth_year", "given_name_kana")
  [1m[36m (5.5ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_furigana" ON "customers"  ("birth_month", "family_name_kana", "given_name_kana")[0m
  [1m[35m (2.8ms)[0m  CREATE  INDEX  "index_customers_on_birth_month_and_given_name_kana" ON "customers"  ("birth_month", "given_name_kana")
  [1m[36m (3.7ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_mday_and_furigana" ON "customers"  ("birth_mday", "family_name_kana", "given_name_kana")[0m
  [1m[35m (2.9ms)[0m  CREATE  INDEX  "index_customers_on_birth_mday_and_given_name_kana" ON "customers"  ("birth_mday", "given_name_kana")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140812034537"]]
  [1m[35m (1.9ms)[0m  COMMIT
Migrating to AlterAddresses1 (20140812034548)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (4.0ms)[0m  CREATE  INDEX  "index_addresses_on_type_and_prefecture_and_city" ON "addresses"  ("type", "prefecture", "city")
  [1m[36m (3.1ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_city" ON "addresses"  ("type", "city")[0m
  [1m[35m (2.7ms)[0m  CREATE  INDEX  "index_addresses_on_prefecture_and_city" ON "addresses"  ("prefecture", "city")
  [1m[36m (4.0ms)[0m  [1mCREATE  INDEX  "index_addresses_on_city" ON "addresses"  ("city")[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812034548"]]
  [1m[36m (3.6ms)[0m  [1mCOMMIT[0m
Migrating to UpdateCustomers1 (20140812041117)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (1.8ms)[0m  [1m
      UPDATE customers SET birth_year = EXTRACT(YEAR FROM birthday),
        birth_month = EXTRACT(MONTH FROM birthday),
        birth_mday = EXTRACT(DAY FROM birthday)
        WHERE birthday IS NOT NULL
      [0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812041117"]]
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers2 (20140812080925)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (3.0ms)[0m  [1mCREATE  INDEX  "index_customers_on_gender_and_furigana" ON "customers"  ("gender", "family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812080925"]]
  [1m[36m (1.1ms)[0m  [1mCOMMIT[0m
Migrating to AlterAddress2 (20140812082005)
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (2.3ms)[0m  [1mCREATE  INDEX  "index_addresses_on_postal_code" ON "addresses"  ("postal_code")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812082005"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to AlterPhone2 (20140812093211)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mALTER TABLE "phones" ADD COLUMN "last_four_digits" character varying(255)[0m
  [1m[35m (2.8ms)[0m  CREATE  INDEX  "index_phones_on_last_four_digits" ON "phones"  ("last_four_digits")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140812093211"]]
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (3.7ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'addresses'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (2.3ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'admin_members'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[35m (1.8ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'customers'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (1.4ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'phones'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[35m (1.8ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'staff_events'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (5.5ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'staff_members'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[36m (117.5ms)[0m  [1mDROP DATABASE IF EXISTS "baukis_test"[0m
  [1m[35m (303.0ms)[0m  CREATE DATABASE "baukis_test" ENCODING = 'unicode'
  [1m[36mSQL (0.2ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (13.4ms)[0m  CREATE TABLE "addresses" ("id" serial primary key, "customer_id" integer NOT NULL, "type" character varying(255) NOT NULL, "postal_code" character varying(255) NOT NULL, "prefecture" character varying(255) NOT NULL, "city" character varying(255) NOT NULL, "address1" character varying(255) NOT NULL, "address2" character varying(255) NOT NULL, "company_name" character varying(255) DEFAULT '' NOT NULL, "division_name" character varying(255) DEFAULT '' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (7.4ms)[0m  [1mCREATE  INDEX  "index_addresses_on_city" ON "addresses" USING btree ("city")[0m
  [1m[35m (5.7ms)[0m  CREATE  INDEX  "index_addresses_on_customer_id" ON "addresses" USING btree ("customer_id")
  [1m[36m (8.6ms)[0m  [1mCREATE  INDEX  "index_addresses_on_postal_code" ON "addresses" USING btree ("postal_code")[0m
  [1m[35m (3.0ms)[0m  CREATE  INDEX  "index_addresses_on_prefecture_and_city" ON "addresses" USING btree ("prefecture", "city")
  [1m[36m (4.4ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_city" ON "addresses" USING btree ("type", "city")[0m
  [1m[35m (4.6ms)[0m  CREATE UNIQUE INDEX  "index_addresses_on_type_and_customer_id" ON "addresses" USING btree ("type", "customer_id")
  [1m[36m (3.9ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_prefecture_and_city" ON "addresses" USING btree ("type", "prefecture", "city")[0m
  [1m[35m (12.5ms)[0m  CREATE TABLE "admin_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "hashed_password" character varying(255), "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (6.3ms)[0m  [1mCREATE UNIQUE INDEX  "index_admin_members_on_email_for_index" ON "admin_members" USING btree ("email_for_index")[0m
  [1m[35m (8.2ms)[0m  CREATE TABLE "customers" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "gender" character varying(255), "birthday" date, "hashed_password" character varying(255), "created_at" timestamp, "updated_at" timestamp, "birth_year" integer, "birth_month" integer, "birth_mday" integer) 
  [1m[36m (7.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_mday_and_furigana" ON "customers" USING btree ("birth_mday", "family_name_kana", "given_name_kana")[0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_customers_on_birth_mday_and_given_name_kana" ON "customers" USING btree ("birth_mday", "given_name_kana")
  [1m[36m (4.7ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_birth_mday" ON "customers" USING btree ("birth_month", "birth_mday")[0m
  [1m[35m (4.3ms)[0m  CREATE  INDEX  "index_customers_on_birth_month_and_furigana" ON "customers" USING btree ("birth_month", "family_name_kana", "given_name_kana")
  [1m[36m (4.1ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_given_name_kana" ON "customers" USING btree ("birth_month", "given_name_kana")[0m
  [1m[35m (5.2ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_birth_month_and_birth_mday" ON "customers" USING btree ("birth_year", "birth_month", "birth_mday")
  [1m[36m (4.4ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_year_and_furigana" ON "customers" USING btree ("birth_year", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.6ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_given_name_kana" ON "customers" USING btree ("birth_year", "given_name_kana")
  [1m[36m (3.9ms)[0m  [1mCREATE UNIQUE INDEX  "index_customers_on_email_for_index" ON "customers" USING btree ("email_for_index")[0m
  [1m[35m (4.1ms)[0m  CREATE  INDEX  "index_customers_on_family_name_kana_and_given_name_kana" ON "customers" USING btree ("family_name_kana", "given_name_kana")
  [1m[36m (4.6ms)[0m  [1mCREATE  INDEX  "index_customers_on_gender_and_furigana" ON "customers" USING btree ("gender", "family_name_kana", "given_name_kana")[0m
  [1m[35m (5.5ms)[0m  CREATE  INDEX  "index_customers_on_given_name_kana" ON "customers" USING btree ("given_name_kana")
  [1m[36m (9.5ms)[0m  [1mCREATE TABLE "phones" ("id" serial primary key, "customer_id" integer NOT NULL, "address_id" integer, "number" character varying(255) NOT NULL, "number_for_index" character varying(255) NOT NULL, "primary" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp, "last_four_digits" character varying(255)) [0m
  [1m[35m (4.7ms)[0m  CREATE  INDEX  "index_phones_on_address_id" ON "phones" USING btree ("address_id")
  [1m[36m (4.5ms)[0m  [1mCREATE  INDEX  "index_phones_on_customer_id" ON "phones" USING btree ("customer_id")[0m
  [1m[35m (5.5ms)[0m  CREATE  INDEX  "index_phones_on_last_four_digits" ON "phones" USING btree ("last_four_digits")
  [1m[36m (8.0ms)[0m  [1mCREATE  INDEX  "index_phones_on_number_for_index" ON "phones" USING btree ("number_for_index")[0m
  [1m[35m (9.1ms)[0m  CREATE TABLE "staff_events" ("id" serial primary key, "staff_member_id" integer NOT NULL, "type" character varying(255) NOT NULL, "created_at" timestamp NOT NULL) 
  [1m[36m (5.1ms)[0m  [1mCREATE  INDEX  "index_staff_events_on_created_at" ON "staff_events" USING btree ("created_at")[0m
  [1m[35m (3.4ms)[0m  CREATE  INDEX  "index_staff_events_on_staff_member_id_and_created_at" ON "staff_events" USING btree ("staff_member_id", "created_at")
  [1m[36m (12.8ms)[0m  [1mCREATE TABLE "staff_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "hashed_password" character varying(255), "start_date" date NOT NULL, "end_date" date, "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (5.8ms)[0m  CREATE UNIQUE INDEX  "index_staff_members_on_email_for_index" ON "staff_members" USING btree ("email_for_index")
  [1m[36m (3.6ms)[0m  [1mCREATE  INDEX  "index_staff_members_on_family_name_kana_and_given_name_kana" ON "staff_members" USING btree ("family_name_kana", "given_name_kana")[0m
  [1m[35m (2.6ms)[0m  ALTER TABLE "addresses" ADD CONSTRAINT "addresses_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (2.7ms)[0m  [1mALTER TABLE "phones" ADD CONSTRAINT "phones_address_id_fk" FOREIGN KEY ("address_id") REFERENCES "addresses"(id)[0m
  [1m[35m (4.8ms)[0m  ALTER TABLE "phones" ADD CONSTRAINT "phones_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (4.1ms)[0m  [1mALTER TABLE "staff_events" ADD CONSTRAINT "staff_events_staff_member_id_fk" FOREIGN KEY ("staff_member_id") REFERENCES "staff_members"(id)[0m
  [1m[35m (1.1ms)[0m  CREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) 
  [1m[36m (11.2ms)[0m  [1mCREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")[0m
  [1m[35m (0.3ms)[0m  SELECT version FROM "schema_migrations"
  [1m[36m (0.6ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812093211')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140723082116')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140723111825')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140803013844')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140809065211')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140809065229')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140811122237')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812034537')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812034548')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812041117')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812080925')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812082005')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (4.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.7ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin1@example.com' LIMIT 1
  [1m[36mSQL (2.7ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:39.705116"], ["email", "admin1@example.com"], ["email_for_index", "admin1@example.com"], ["hashed_password", "$2a$10$zO4utg.y7SwBY/ACjdiiSO/SSUf3RB4s/r8/CyxyE6HhCUNvACJkm"], ["updated_at", "2014-08-20 07:59:39.705116"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-19", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.4ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:39.833934"], ["email", "member1@example.com"], ["email_for_index", "member1@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$gfHjcx/y.QCpO94p/KkE8eHB1An6y/UouHk304QwX.Q5nNPo9aT3q"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:39.833934"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 114ms (ActiveRecord: 3.5ms)
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-20 07:59:39.917061"], ["email", "admin2@example.com"], ["email_for_index", "admin2@example.com"], ["hashed_password", "$2a$10$wC.NVZucEkZaHM6WEmPtzO0uFhp/UUe7gKmHdj68d2cJGYE9Fs.9a"], ["updated_at", "2014-08-20 07:59:39.917061"]]
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 2 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:40.005360"], ["email", "admin3@example.com"], ["email_for_index", "admin3@example.com"], ["hashed_password", "$2a$10$XpafF8asD9OrGqXNeVqCpepLBAzSb/fBxGbA.6Dbn0XS15rFxBGyS"], ["updated_at", "2014-08-20 07:59:40.005360"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:40.088458"], ["email", "member3@example.com"], ["email_for_index", "member3@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$vfF11tqRZhTeT/6JFq85MOagtZJE.c/je026zlJyrF5vGsanw844K"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:40.088458"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-19", "end_date"=>nil, "suspended"=>true}, "id"=>"2"}
  [1m[36mAdminMember Load (0.2ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 3 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1  [["id", 2]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member2@example.com' AND "staff_members"."id" != 2) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "hashed_password" = $3, "suspended" = $4, "updated_at" = $5 WHERE "staff_members"."id" = 2[0m  [["email", "member2@example.com"], ["email_for_index", "member2@example.com"], ["hashed_password", "$2a$10$tpO50e.lsS/jkZmw2YfKgeLV522D5DzGLB3PJA7by2dNZAiCtj.rm"], ["suspended", "t"], ["updated_at", "2014-08-20 07:59:40.174433"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 95ms (ActiveRecord: 1.3ms)
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-20 07:59:40.265502"], ["email", "admin4@example.com"], ["email_for_index", "admin4@example.com"], ["hashed_password", "$2a$10$RljTw6aifujVj/fH/IaoROZ83rkL3Lsc4i1CtWXW1LGODfb0jad4q"], ["updated_at", "2014-08-20 07:59:40.265502"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:40.352979"], ["email", "member5@example.com"], ["email_for_index", "member5@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$xtV/D71qYR671sziEkuXeO0Xxb9fVnLSguMZXdMt.d9u6dRhRwbju"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:40.352979"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-19", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"3"}
  [1m[35mAdminMember Load (1.1ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 4 LIMIT 1
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 3]]
Unpermitted parameters: hashed_password
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member4@example.com' AND "staff_members"."id" != 3) LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 3  [["email", "member4@example.com"], ["email_for_index", "member4@example.com"], ["updated_at", "2014-08-20 07:59:40.362138"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 8ms (ActiveRecord: 2.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-20 07:59:40.446163"], ["email", "admin5@example.com"], ["email_for_index", "admin5@example.com"], ["hashed_password", "$2a$10$55Q1rvXpvybzp.0wWiaQW.0uAFQ42iUf0vLgWjMREN6qHS8RT34Ey"], ["updated_at", "2014-08-20 07:59:40.446163"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 5 LIMIT 1
Completed 200 OK in 64ms (Views: 62.8ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin6@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:40.591494"], ["email", "admin6@example.com"], ["email_for_index", "admin6@example.com"], ["hashed_password", "$2a$10$kbVemzGysvnpwv5UmJGYGO0hKb2uYbgPhtGu9OcDk9JIRZf6ngDRu"], ["updated_at", "2014-08-20 07:59:40.591494"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mUPDATE "admin_members" SET "suspended" = 't' WHERE "admin_members"."id" = 6[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.8ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 6 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.8ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:40.679774"], ["email", "admin7@example.com"], ["email_for_index", "admin7@example.com"], ["hashed_password", "$2a$10$gtEYUJWlkVTlAw502vgMnObO1ZvFWoRW.l612okX/yE1h6h6atjyC"], ["updated_at", "2014-08-20 07:59:40.679774"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.2ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 7 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:40.769312"], ["email", "member6@example.com"], ["email_for_index", "member6@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wsaWSFbkA3tzmWagmbWRUODHPAV4UrgwC2i9HpLfkoV3etcdFFXnG"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:40.769312"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"4", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-19", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 4 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'test@example.com' AND "staff_members"."id" != 4) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 4[0m  [["email", "test@example.com"], ["email_for_index", "test@example.com"], ["updated_at", "2014-08-20 07:59:40.777427"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
  [1m[36mStaffMember Load (0.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 4]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:40.872198"], ["email", "member8@example.com"], ["email_for_index", "member8@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$x11FxSSK4Okhbe8umOYgBufwvZJopDidchus4QgbIK3QBgsHRo1WS"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:40.872198"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"5"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 5 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:40.963608"], ["email", "member9@example.com"], ["email_for_index", "member9@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$c9rFuX9LKBub6jldjM/cH.E9KdcGJSmveXWPo5fqk5jHTzeEV6rLa"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:40.963608"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"6", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-19", "end_date"=>"2014-08-21", "suspended"=>false}}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 6 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member10@example.com' AND "staff_members"."id" != 6) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 6  [["email", "member10@example.com"], ["email_for_index", "member10@example.com"], ["updated_at", "2014-08-20 07:59:40.971705"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:41.051286"], ["email", "member11@example.com"], ["email_for_index", "member11@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P9QwAZ8v5aCtfc0gjjJn5u8qm5gquqYzD13whTVw9NPv8UU0SMS/."], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:41.051286"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"7", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-19", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 7 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member12@example.com' AND "staff_members"."id" != 7) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 7[0m  [["email", "member12@example.com"], ["email_for_index", "member12@example.com"], ["updated_at", "2014-08-20 07:59:41.060019"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 5ms (ActiveRecord: 0.9ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:41.138483"], ["email", "member13@example.com"], ["email_for_index", "member13@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$qIWPlfiB041E7sUuS5iLe.Rf8W5E0Jx6j6PQNrMlXATE/cuR4Mgye"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:41.138483"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 8 LIMIT 1[0m
Completed 200 OK in 49ms (Views: 47.9ms | ActiveRecord: 0.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:41.269536"], ["email", "member14@example.com"], ["email_for_index", "member14@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$AP.U5uw6z1ANBz.hKiPkqu9N6jz2snKHGkvpki6klebGdHqm8VBhK"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:41.269536"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "suspended" = 't' WHERE "staff_members"."id" = 9
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 9 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:41.352449"], ["email", "member15@example.com"], ["email_for_index", "member15@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$am07cCnAbEH4T96o64F7Mejw1LPjzOM8yislbXzb628pG/B6gQu6O"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:41.352449"]]
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 10 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.2ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member1@example.jp' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:41.562112"], ["email", "member1@example.jp"], ["email_for_index", "member1@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$2UVP6Tt3aNn1Pnoru1GrseGIbrz.CQYtpHDyO.9XEzeUTMDauM30u"], ["updated_at", "2014-08-20 07:59:41.562112"]]
  [1m[35mSQL (2.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:41.564637"], ["customer_id", 1], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:41.564637"]]
  [1m[36mSQL (2.7ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:41.568898"], ["customer_id", 1], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:41.568898"]]
  [1m[35m (0.7ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:41.659413"], ["email", "member16@example.com"], ["email_for_index", "member16@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$cfiEw7S5UhG7FdO24YyhG.mfmI..U3fL9.MZQ38a/ibZcXNwCS3yS"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:41.659413"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:41 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.4ms)
Completed 200 OK in 568ms (Views: 533.3ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:42 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:42.414884"], ["staff_member_id", 11], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 131ms (ActiveRecord: 2.5ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:42 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 14ms (Views: 10.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (69.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 199ms (Views: 189.7ms | ActiveRecord: 1.1ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-20 07:59:42 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (8.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (112.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (33.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (14.1ms)
  Rendered staff/customers/_form.html.erb (224.6ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 336ms (Views: 278.6ms | ActiveRecord: 1.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:43.177484"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$.mE1abF2VbKdHEfhaClIV.L01k4YjrlKtJvEb07WgLmoU5DhCGOd2"], ["updated_at", "2014-08-20 07:59:43.177484"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:43.179147"], ["customer_id", 2], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:43.179147"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:43.180894"], ["customer_id", 2], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:43.180894"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 102ms (ActiveRecord: 1.7ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (19.5ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 32.5ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.9ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 2]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 2]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.5ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:43.311207"], ["email", "member2@example.jp"], ["email_for_index", "member2@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$3/9ktUk.N5w.vGzlG.6w6uW0Pw/hxfbxfdl166rK7FItNRd9vFV6y"], ["updated_at", "2014-08-20 07:59:43.311207"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:43.313191"], ["customer_id", 3], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:43.313191"]]
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:43.315202"], ["customer_id", 3], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:43.315202"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:43.399074"], ["email", "member17@example.com"], ["email_for_index", "member17@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$OEiack.w0GXyqvrFpTWjJeEZXBxrLBV5MthwQrPQ4KJ.oNp9WbfF."], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:43.399074"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 10ms (Views: 9.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:43.493143"], ["staff_member_id", 12], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 76ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 15ms (Views: 12.5ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 40ms (Views: 36.7ms | ActiveRecord: 0.9ms)
Started GET "/customers/3/edit" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"3"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 3]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 3]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 5]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 6]]
  Rendered staff/customers/_phone_fields.html.erb (2.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_customer_fields.html.erb (10.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.0ms)
  Rendered staff/customers/_form.html.erb (35.9ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 92ms (Views: 78.8ms | ActiveRecord: 2.0ms)
Started PATCH "/customers/3" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"3"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35m (0.6ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 3]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 5]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 6]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'test@example.jp' AND "customers"."id" != 3) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "customers" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "customers"."id" = 3[0m  [["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["updated_at", "2014-08-20 07:59:43.731862"]]
  [1m[35mSQL (0.3ms)[0m  UPDATE "addresses" SET "postal_code" = $1, "updated_at" = $2 WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."id" = 5  [["postal_code", "9999999"], ["updated_at", "2014-08-20 07:59:43.733588"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 24ms (ActiveRecord: 3.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (23.7ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 45ms (Views: 41.8ms | ActiveRecord: 1.0ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:43.880538"], ["email", "member3@example.jp"], ["email_for_index", "member3@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$BS2Fcsaa9UwcWTrJHq.9U.FzOhFMZL5enB55Zilacg73gzX8.a08m"], ["updated_at", "2014-08-20 07:59:43.880538"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:43.882013"], ["customer_id", 4], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:43.882013"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:43.883625"], ["customer_id", 4], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:43.883625"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:43.961817"], ["email", "member18@example.com"], ["email_for_index", "member18@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$POjXG9KcfGvfmeg2G9ehh.TvyK4mDQOV38dVriRsmGQ/opToDGj/y"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:43.961817"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 12ms (Views: 11.2ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:43 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-20 07:59:44.059269"], ["staff_member_id", 13], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:44 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 17ms (Views: 14.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (19.9ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 43ms (Views: 38.7ms | ActiveRecord: 1.1ms)
Started GET "/customers/4/edit" for 127.0.0.1 at 2014-08-20 07:59:44 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"4"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 4]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 4]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 4]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 4]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 7]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 8]]
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (12.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.4ms)
  Rendered staff/customers/_form.html.erb (36.8ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 63ms (Views: 51.1ms | ActiveRecord: 1.7ms)
Started PATCH "/customers/4" for 127.0.0.1 at 2014-08-20 07:59:44 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"4"}
  [1m[36mStaffMember Load (1.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 4]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 4]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 4]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 4]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 7]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 8]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member3@example.jp' AND "customers"."id" != 4) LIMIT 1[0m
  [1m[35m (1.8ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (11.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.6ms)
  Rendered staff/customers/_form.html.erb (37.0ms)
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 593ms (Views: 51.7ms | ActiveRecord: 4.8ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:44.900416"], ["email", "member4@example.jp"], ["email_for_index", "member4@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$XlqZ8M4r9YInpowjpdxWY..7tqzBdYVLbCdOdt6VPccodEYIXgI0W"], ["updated_at", "2014-08-20 07:59:44.900416"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:44.903019"], ["customer_id", 5], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:44.903019"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:44.904848"], ["customer_id", 5], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:44.904848"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:44.982008"], ["email", "member19@example.com"], ["email_for_index", "member19@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$yjQs9uM1Ju/BeIdEXa6IqOkc4hI4gxSvfhZRpc30mbLgQLl5yKrVm"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:44.982008"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:44 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 12ms (Views: 11.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:45.080572"], ["staff_member_id", 14], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 14.4ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.4ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 38ms (Views: 35.3ms | ActiveRecord: 0.8ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (10.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (13.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.0ms)
  Rendered staff/customers/_form.html.erb (37.0ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 58ms (Views: 52.0ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:45.353651"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$iHplsFM4Bg3R.uRXRDJ1hOKwsBoc5BN14nTzUCGWxxMM3iZqse/0K"], ["updated_at", "2014-08-20 07:59:45.353651"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 103ms (ActiveRecord: 1.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (25.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 48ms (Views: 45.0ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 6]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 6]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:45.493833"], ["email", "member5@example.jp"], ["email_for_index", "member5@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$S514nPihBOAVH4cAeKm2DO0A24S0jBGdxmhzvF8N7dY5EYBaMxVEu"], ["updated_at", "2014-08-20 07:59:45.493833"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:45.495937"], ["customer_id", 7], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:45.495937"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:45.497727"], ["customer_id", 7], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:45.497727"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:45.575525"], ["email", "member20@example.com"], ["email_for_index", "member20@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$DVTvTQOb1ovZ9/Op9SlS5eI/yVgau4qZeuxj1SRq0/7FAw1T7EZBi"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:45.575525"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 19ms (Views: 18.4ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:45.680207"], ["staff_member_id", 15], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 16ms (Views: 13.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 12]]
  [1m[35mSQL (0.4ms)[0m  DELETE FROM "addresses" WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."id" = $1  [["id", 12]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (21.7ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 36.1ms | ActiveRecord: 0.9ms)
Started GET "/customers/7/edit" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 7]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 7]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 11]]
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_customer_fields.html.erb (12.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.4ms)
  Rendered staff/customers/_phone_fields.html.erb (2.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (15.1ms)
  Rendered staff/customers/_form.html.erb (40.1ms)
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 67ms (Views: 55.6ms | ActiveRecord: 1.1ms)
Started PATCH "/customers/7" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 7]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 7]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 11]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member5@example.jp' AND "customers"."id" != 7) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テストテスト"], ["created_at", "2014-08-20 07:59:45.863439"], ["customer_id", 7], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:45.863439"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 29ms (ActiveRecord: 2.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 36.1ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:45.991721"], ["email", "member6@example.jp"], ["email_for_index", "member6@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$h7lKy/9vQIdMqrvZoXweZ.t0mtSbJguXACG8IDQ4ABZ0h1jz0JPLi"], ["updated_at", "2014-08-20 07:59:45.991721"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:45.993121"], ["customer_id", 8], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:45.993121"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:45.994713"], ["customer_id", 8], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:45.994713"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:46.077878"], ["email", "member21@example.com"], ["email_for_index", "member21@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$pAOkRCj9rB/nk037sEN2a.9mECas.3Lt9AVBbcwN6n4idfuDO00L."], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:46.077878"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 11ms (Views: 10.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-20 07:59:46.174231"], ["staff_member_id", 16], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 17ms (Views: 14.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 36.3ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_customer_fields.html.erb (12.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (14.0ms)
  Rendered staff/customers/_form.html.erb (39.2ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 62ms (Views: 55.7ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:46.438107"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$yQUIGFCtDU0xaYEIUINtmecy3sYX5ydBjR8SxRqpz74mYdr8FH3YG"], ["updated_at", "2014-08-20 07:59:46.438107"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:46.439131"], ["customer_id", 9], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:46.439131"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 87ms (ActiveRecord: 1.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.5ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 36.2ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 9]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 9]]
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.1ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:46.572832"], ["email", "member7@example.jp"], ["email_for_index", "member7@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$vKzFGhcFVbA2JFkWEeId1OnaoD.qsACo2BZBS5iYq8Vwmf.mjsmea"], ["updated_at", "2014-08-20 07:59:46.572832"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:46.574914"], ["customer_id", 10], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:46.574914"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:46.576539"], ["customer_id", 10], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:46.576539"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:46.655620"], ["email", "member22@example.com"], ["email_for_index", "member22@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$cpBrpKJFeSUmG95DXf7A0.MuJeZ1QDzjvtgyRwf0uCg2fUP2B6dZK"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:46.655620"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 14ms (Views: 13.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:46.754198"], ["staff_member_id", 17], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 76ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 16ms (Views: 14.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.2ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 40ms (Views: 37.2ms | ActiveRecord: 0.7ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (10.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.6ms)
  Rendered staff/customers/_form.html.erb (32.8ms)
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 47.4ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-20 07:59:46 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:47.005522"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$7KPqYf4luzG5YGh5oKdrA.p23JsYIl4cen1KX69eAHq/lEr.xrLg2"], ["updated_at", "2014-08-20 07:59:47.005522"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:47.007487"], ["customer_id", 11], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:47.007487"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 87ms (ActiveRecord: 1.1ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.5ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 41ms (Views: 37.6ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 11]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 11]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:47.136608"], ["email", "member8@example.jp"], ["email_for_index", "member8@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$/oQdj0V5O4DvI0V1OjhbguFQw4k5.EXDfs2qJBRrmvVZJbq/7SOdK"], ["updated_at", "2014-08-20 07:59:47.136608"]]
  [1m[36mSQL (1.5ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:47.202735"], ["customer_id", 12], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:47.202735"]]
  [1m[35mSQL (1.1ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:47.205755"], ["customer_id", 12], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:47.205755"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:47.290966"], ["email", "member23@example.com"], ["email_for_index", "member23@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Envi.FfiEWPGp6vTtWUBCeSt67IZGSooswlIo06qv/gJck2nb3RJC"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:47.290966"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 12ms (Views: 11.4ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-20 07:59:47.389854"], ["staff_member_id", 18], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 11ms (Views: 8.3ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (25.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 43ms (Views: 40.7ms | ActiveRecord: 1.0ms)
Started GET "/customers/12/edit" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"12"}
  [1m[35mStaffMember Load (0.7ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  [1m[36mCustomer Load (0.1ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 12]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 12]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 12]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 12]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 20]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 21]]
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (9.6ms)
  Rendered staff/customers/_phone_fields.html.erb (2.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (13.4ms)
  Rendered staff/customers/_phone_fields.html.erb (2.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_work_address_fields.html.erb (20.2ms)
  Rendered staff/customers/_form.html.erb (45.5ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 72ms (Views: 61.7ms | ActiveRecord: 1.7ms)
Started PATCH "/customers/12" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"12"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 12]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 12]]
  [1m[35mHomeAddress Load (0.4ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 12]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 12]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 20]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 21]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member8@example.jp' AND "customers"."id" != 12) LIMIT 1[0m
  [1m[35mSQL (1.2ms)[0m  INSERT INTO "phones" ("created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["created_at", "2014-08-20 07:59:47.564537"], ["customer_id", 12], ["last_four_digits", "9999"], ["number", "090-9999-9999"], ["number_for_index", "09099999999"], ["primary", "t"], ["updated_at", "2014-08-20 07:59:47.564537"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 47ms (ActiveRecord: 3.1ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (16.6ms)
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 34ms (Views: 31.5ms | ActiveRecord: 0.7ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 12]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 12]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  ORDER BY "phones"."id" ASC[0m  [["customer_id", 12]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:47.715188"], ["email", "member9@example.jp"], ["email_for_index", "member9@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$dSQNhNVwyoAcwXrNCpQyS.IeM4I4Q8Bv4oHz0UqJfBhEEur/k4Grq"], ["updated_at", "2014-08-20 07:59:47.715188"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:47.716936"], ["customer_id", 13], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:47.716936"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:47.718814"], ["customer_id", 13], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:47.718814"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:47.803428"], ["email", "member24@example.com"], ["email_for_index", "member24@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$3fDDEky63pmpMrGHNSnnIuFaH0wIbI1xrnarVpC.M9I9lO8S0VLLa"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:47.803428"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 11ms (Views: 10.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-20 07:59:47.899936"], ["staff_member_id", 19], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 10ms (Views: 7.8ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (15.5ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 31ms (Views: 28.1ms | ActiveRecord: 0.8ms)
Started GET "/customers/13/edit" for 127.0.0.1 at 2014-08-20 07:59:47 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"13"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 13]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 13]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 22]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 23]]
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (12.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (2.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (13.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.9ms)
  Rendered staff/customers/_form.html.erb (40.1ms)
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 63ms (Views: 51.8ms | ActiveRecord: 1.3ms)
Started PATCH "/customers/13" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"13"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 13]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 13]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 13]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 22]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 23]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member9@example.jp' AND "customers"."id" != 13) LIMIT 1[0m
  [1m[35mAddress Load (0.0ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1  [["id", 22]]
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["address_id", 22], ["created_at", "2014-08-20 07:59:48.094956"], ["customer_id", 13], ["last_four_digits", "9999"], ["number", "03-9999-9999"], ["number_for_index", "0399999999"], ["primary", "t"], ["updated_at", "2014-08-20 07:59:48.094956"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 41ms (ActiveRecord: 2.8ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.0ms)
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 33.3ms | ActiveRecord: 1.0ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 22]]
  [1m[35mPhone Load (0.2ms)[0m  SELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC  [["address_id", 22]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.2ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-20 07:59:48.243523"], ["email", "member10@example.jp"], ["email_for_index", "member10@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$WnT7N0oqahWj4FmsI2ZyOOY909lf7u9lsVCsLvNFaev015wrYqLwK"], ["updated_at", "2014-08-20 07:59:48.243523"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-20 07:59:48.245366"], ["customer_id", 14], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-20 07:59:48.245366"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-20 07:59:48.247226"], ["customer_id", 14], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-20 07:59:48.247226"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:48.332685"], ["email", "member25@example.com"], ["email_for_index", "member25@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$MDb/Me.R8IkvdWStoXzL5OGMavYNw6dsCxIeEOryFkVgR8lohDZTC"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:48.332685"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 14ms (Views: 13.4ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:48.430098"], ["staff_member_id", 20], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 76ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 11ms (Views: 8.5ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (15.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 32.9ms | ActiveRecord: 0.9ms)
Started GET "/customers/14/edit" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"14"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 14]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 14]]
  [1m[36mWorkAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 24]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 25]]
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_customer_fields.html.erb (9.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (8.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_work_address_fields.html.erb (62.1ms)
  Rendered staff/customers/_form.html.erb (81.2ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 105ms (Views: 95.1ms | ActiveRecord: 1.1ms)
Started PATCH "/customers/14" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"14"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 14]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 14]]
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 14]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 24]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 25]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member10@example.jp' AND "customers"."id" != 14) LIMIT 1
  [1m[36mAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1[0m  [["id", 25]]
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["address_id", 25], ["created_at", "2014-08-20 07:59:48.632265"], ["customer_id", 14], ["last_four_digits", "1111"], ["number", "03-9999-1111"], ["number_for_index", "0399991111"], ["primary", "t"], ["updated_at", "2014-08-20 07:59:48.632265"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 22ms (ActiveRecord: 2.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-20 07:59:48 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 38ms (Views: 35.3ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 25]]
  [1m[36mPhone Load (0.1ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 25]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:48.940232"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ek79TYWVyc8oc018JIxs6.vnvJUYdunRVp2vT3aj1TdCSHJuWGlnG"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:48.940232"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:49.018372"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$W7tvDSE6p84F2lbNX1ZLIOdZKMOFovh3jCviozVO3uBZvzs997pui"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:49.018372"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:49.098600"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Ud7pg/X1uQidNijmC.t/2OruM0HjHffPfy5ynShKU1QZ8bYSNf1wC"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:49.098600"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:49.184328"], ["email", "member26@example.com"], ["email_for_index", "member26@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$W6MJyyxpAJW/ofKoT4OzTeSxlvx434buGDZtF/BJycstJDoimvO76"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:49.184328"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-20 07:59:49.262336"], ["email", "member27@example.com"], ["email_for_index", "member27@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Sp6I76bwE1nMKaWBLWHiruC.rgx5pgK1Q7lKy6wlH5ghb1T/yedIq"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:49.262336"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member29@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-20 07:59:49.582668"], ["email", "member30@example.com"], ["email_for_index", "member30@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$/GSxeof7EhyN.WkMgDX0n.Bjj1yYX1BU4QdjqqM81sS5uaEi3VtXG"], ["start_date", "2014-08-19"], ["updated_at", "2014-08-20 07:59:49.582668"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.5ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member31@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (295.6ms)[0m  [1mCREATE DATABASE "baukis_test" ENCODING = 'unicode'[0m
  [1m[36m (13.9ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) [0m
  [1m[35m (5.1ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36mActiveRecord::SchemaMigration Load (5.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
Migrating to CreateStaffMembers (20140723082116)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (7.8ms)[0m  [1mCREATE TABLE "staff_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "hashed_password" character varying(255), "start_date" date NOT NULL, "end_date" date, "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (4.8ms)[0m  CREATE UNIQUE INDEX  "index_staff_members_on_email_for_index" ON "staff_members"  ("email_for_index")
  [1m[36m (4.3ms)[0m  [1mCREATE  INDEX  "index_staff_members_on_family_name_kana_and_given_name_kana" ON "staff_members"  ("family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140723082116"]]
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
Migrating to CreateAdminMembers (20140723111825)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (9.1ms)[0m  [1mCREATE TABLE "admin_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "hashed_password" character varying(255), "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (4.8ms)[0m  CREATE UNIQUE INDEX  "index_admin_members_on_email_for_index" ON "admin_members"  ("email_for_index")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140723111825"]]
  [1m[35m (2.7ms)[0m  COMMIT
Migrating to CreateStaffEvents (20140803013844)
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (4.4ms)[0m  CREATE TABLE "staff_events" ("id" serial primary key, "staff_member_id" integer NOT NULL, "type" character varying(255) NOT NULL, "created_at" timestamp NOT NULL) 
  [1m[36m (4.2ms)[0m  [1mCREATE  INDEX  "index_staff_events_on_created_at" ON "staff_events"  ("created_at")[0m
  [1m[35m (3.9ms)[0m  CREATE  INDEX  "index_staff_events_on_staff_member_id_and_created_at" ON "staff_events"  ("staff_member_id", "created_at")
  [1m[36m (2.0ms)[0m  [1mALTER TABLE "staff_events" ADD CONSTRAINT "staff_events_staff_member_id_fk" FOREIGN KEY ("staff_member_id") REFERENCES "staff_members"(id)[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140803013844"]]
  [1m[36m (2.2ms)[0m  [1mCOMMIT[0m
Migrating to CreateCustomers (20140809065211)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (7.1ms)[0m  [1mCREATE TABLE "customers" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "gender" character varying(255), "birthday" date, "hashed_password" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (2.6ms)[0m  CREATE UNIQUE INDEX  "index_customers_on_email_for_index" ON "customers"  ("email_for_index")
  [1m[36m (5.4ms)[0m  [1mCREATE  INDEX  "index_customers_on_family_name_kana_and_given_name_kana" ON "customers"  ("family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140809065211"]]
  [1m[36m (2.3ms)[0m  [1mCOMMIT[0m
Migrating to CreateAddresses (20140809065229)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (9.4ms)[0m  [1mCREATE TABLE "addresses" ("id" serial primary key, "customer_id" integer NOT NULL, "type" character varying(255) NOT NULL, "postal_code" character varying(255) NOT NULL, "prefecture" character varying(255) NOT NULL, "city" character varying(255) NOT NULL, "address1" character varying(255) NOT NULL, "address2" character varying(255) NOT NULL, "company_name" character varying(255) DEFAULT '' NOT NULL, "division_name" character varying(255) DEFAULT '' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (3.3ms)[0m  CREATE  INDEX  "index_addresses_on_customer_id" ON "addresses"  ("customer_id")
  [1m[36m (3.6ms)[0m  [1mCREATE UNIQUE INDEX  "index_addresses_on_type_and_customer_id" ON "addresses"  ("type", "customer_id")[0m
  [1m[35m (1.0ms)[0m  ALTER TABLE "addresses" ADD CONSTRAINT "addresses_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140809065229"]]
  [1m[35m (1.6ms)[0m  COMMIT
Migrating to CreatePhones (20140811122237)
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (10.0ms)[0m  CREATE TABLE "phones" ("id" serial primary key, "customer_id" integer NOT NULL, "address_id" integer, "number" character varying(255) NOT NULL, "number_for_index" character varying(255) NOT NULL, "primary" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (5.5ms)[0m  [1mCREATE  INDEX  "index_phones_on_customer_id" ON "phones"  ("customer_id")[0m
  [1m[35m (3.9ms)[0m  CREATE  INDEX  "index_phones_on_address_id" ON "phones"  ("address_id")
  [1m[36m (4.9ms)[0m  [1mCREATE  INDEX  "index_phones_on_number_for_index" ON "phones"  ("number_for_index")[0m
  [1m[35m (2.7ms)[0m  ALTER TABLE "phones" ADD CONSTRAINT "phones_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (1.5ms)[0m  [1mALTER TABLE "phones" ADD CONSTRAINT "phones_address_id_fk" FOREIGN KEY ("address_id") REFERENCES "addresses"(id)[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140811122237"]]
  [1m[36m (3.7ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers1 (20140812034537)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (1.8ms)[0m  [1mALTER TABLE "customers" ADD COLUMN "birth_year" integer[0m
  [1m[35m (0.3ms)[0m  ALTER TABLE "customers" ADD COLUMN "birth_month" integer
  [1m[36m (0.4ms)[0m  [1mALTER TABLE "customers" ADD COLUMN "birth_mday" integer[0m
  [1m[35m (2.9ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_birth_month_and_birth_mday" ON "customers"  ("birth_year", "birth_month", "birth_mday")
  [1m[36m (2.8ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_birth_mday" ON "customers"  ("birth_month", "birth_mday")[0m
  [1m[35m (4.7ms)[0m  CREATE  INDEX  "index_customers_on_given_name_kana" ON "customers"  ("given_name_kana")
  [1m[36m (3.4ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_year_and_furigana" ON "customers"  ("birth_year", "family_name_kana", "given_name_kana")[0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_given_name_kana" ON "customers"  ("birth_year", "given_name_kana")
  [1m[36m (3.8ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_furigana" ON "customers"  ("birth_month", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.1ms)[0m  CREATE  INDEX  "index_customers_on_birth_month_and_given_name_kana" ON "customers"  ("birth_month", "given_name_kana")
  [1m[36m (4.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_mday_and_furigana" ON "customers"  ("birth_mday", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.2ms)[0m  CREATE  INDEX  "index_customers_on_birth_mday_and_given_name_kana" ON "customers"  ("birth_mday", "given_name_kana")
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140812034537"]]
  [1m[35m (1.6ms)[0m  COMMIT
Migrating to AlterAddresses1 (20140812034548)
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35m (6.2ms)[0m  CREATE  INDEX  "index_addresses_on_type_and_prefecture_and_city" ON "addresses"  ("type", "prefecture", "city")
  [1m[36m (3.4ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_city" ON "addresses"  ("type", "city")[0m
  [1m[35m (3.8ms)[0m  CREATE  INDEX  "index_addresses_on_prefecture_and_city" ON "addresses"  ("prefecture", "city")
  [1m[36m (4.6ms)[0m  [1mCREATE  INDEX  "index_addresses_on_city" ON "addresses"  ("city")[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812034548"]]
  [1m[36m (0.9ms)[0m  [1mCOMMIT[0m
Migrating to UpdateCustomers1 (20140812041117)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (4.4ms)[0m  [1m
      UPDATE customers SET birth_year = EXTRACT(YEAR FROM birthday),
        birth_month = EXTRACT(MONTH FROM birthday),
        birth_mday = EXTRACT(DAY FROM birthday)
        WHERE birthday IS NOT NULL
      [0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812041117"]]
  [1m[36m (0.8ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers2 (20140812080925)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_gender_and_furigana" ON "customers"  ("gender", "family_name_kana", "given_name_kana")[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812080925"]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
Migrating to AlterAddress2 (20140812082005)
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (4.3ms)[0m  [1mCREATE  INDEX  "index_addresses_on_postal_code" ON "addresses"  ("postal_code")[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "schema_migrations" ("version") VALUES ($1)  [["version", "20140812082005"]]
  [1m[36m (0.7ms)[0m  [1mCOMMIT[0m
Migrating to AlterPhone2 (20140812093211)
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mALTER TABLE "phones" ADD COLUMN "last_four_digits" character varying(255)[0m
  [1m[35m (3.4ms)[0m  CREATE  INDEX  "index_phones_on_last_four_digits" ON "phones"  ("last_four_digits")
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ($1)[0m  [["version", "20140812093211"]]
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (2.0ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'addresses'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (1.6ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'admin_members'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[35m (1.7ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'customers'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (1.7ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'phones'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[35m (2.7ms)[0m  
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'staff_events'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        
  [1m[36m (2.0ms)[0m  [1m
          SELECT t2.relname AS to_table, a1.attname AS column, a2.attname AS primary_key, c.conname AS name, c.confdeltype AS dependency
          FROM pg_constraint c
          JOIN pg_class t1 ON c.conrelid = t1.oid
          JOIN pg_class t2 ON c.confrelid = t2.oid
          JOIN pg_attribute a1 ON a1.attnum = c.conkey[1] AND a1.attrelid = t1.oid
          JOIN pg_attribute a2 ON a2.attnum = c.confkey[1] AND a2.attrelid = t2.oid
          JOIN pg_namespace t3 ON c.connamespace = t3.oid
          WHERE c.contype = 'f'
            AND t1.relname = 'staff_members'
            AND t3.nspname = ANY (current_schemas(false))
          ORDER BY c.conname
        [0m
  [1m[36m (108.6ms)[0m  [1mDROP DATABASE IF EXISTS "baukis_test"[0m
  [1m[35m (291.5ms)[0m  CREATE DATABASE "baukis_test" ENCODING = 'unicode'
  [1m[36mSQL (8.7ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (21.7ms)[0m  CREATE TABLE "addresses" ("id" serial primary key, "customer_id" integer NOT NULL, "type" character varying(255) NOT NULL, "postal_code" character varying(255) NOT NULL, "prefecture" character varying(255) NOT NULL, "city" character varying(255) NOT NULL, "address1" character varying(255) NOT NULL, "address2" character varying(255) NOT NULL, "company_name" character varying(255) DEFAULT '' NOT NULL, "division_name" character varying(255) DEFAULT '' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (7.5ms)[0m  [1mCREATE  INDEX  "index_addresses_on_city" ON "addresses" USING btree ("city")[0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_addresses_on_customer_id" ON "addresses" USING btree ("customer_id")
  [1m[36m (7.5ms)[0m  [1mCREATE  INDEX  "index_addresses_on_postal_code" ON "addresses" USING btree ("postal_code")[0m
  [1m[35m (4.1ms)[0m  CREATE  INDEX  "index_addresses_on_prefecture_and_city" ON "addresses" USING btree ("prefecture", "city")
  [1m[36m (6.6ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_city" ON "addresses" USING btree ("type", "city")[0m
  [1m[35m (3.1ms)[0m  CREATE UNIQUE INDEX  "index_addresses_on_type_and_customer_id" ON "addresses" USING btree ("type", "customer_id")
  [1m[36m (5.7ms)[0m  [1mCREATE  INDEX  "index_addresses_on_type_and_prefecture_and_city" ON "addresses" USING btree ("type", "prefecture", "city")[0m
  [1m[35m (11.7ms)[0m  CREATE TABLE "admin_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "hashed_password" character varying(255), "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (6.4ms)[0m  [1mCREATE UNIQUE INDEX  "index_admin_members_on_email_for_index" ON "admin_members" USING btree ("email_for_index")[0m
  [1m[35m (7.7ms)[0m  CREATE TABLE "customers" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "gender" character varying(255), "birthday" date, "hashed_password" character varying(255), "created_at" timestamp, "updated_at" timestamp, "birth_year" integer, "birth_month" integer, "birth_mday" integer) 
  [1m[36m (5.3ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_mday_and_furigana" ON "customers" USING btree ("birth_mday", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.7ms)[0m  CREATE  INDEX  "index_customers_on_birth_mday_and_given_name_kana" ON "customers" USING btree ("birth_mday", "given_name_kana")
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_birth_mday" ON "customers" USING btree ("birth_month", "birth_mday")[0m
  [1m[35m (5.8ms)[0m  CREATE  INDEX  "index_customers_on_birth_month_and_furigana" ON "customers" USING btree ("birth_month", "family_name_kana", "given_name_kana")
  [1m[36m (4.6ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_month_and_given_name_kana" ON "customers" USING btree ("birth_month", "given_name_kana")[0m
  [1m[35m (3.9ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_birth_month_and_birth_mday" ON "customers" USING btree ("birth_year", "birth_month", "birth_mday")
  [1m[36m (4.0ms)[0m  [1mCREATE  INDEX  "index_customers_on_birth_year_and_furigana" ON "customers" USING btree ("birth_year", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.8ms)[0m  CREATE  INDEX  "index_customers_on_birth_year_and_given_name_kana" ON "customers" USING btree ("birth_year", "given_name_kana")
  [1m[36m (3.3ms)[0m  [1mCREATE UNIQUE INDEX  "index_customers_on_email_for_index" ON "customers" USING btree ("email_for_index")[0m
  [1m[35m (4.6ms)[0m  CREATE  INDEX  "index_customers_on_family_name_kana_and_given_name_kana" ON "customers" USING btree ("family_name_kana", "given_name_kana")
  [1m[36m (4.7ms)[0m  [1mCREATE  INDEX  "index_customers_on_gender_and_furigana" ON "customers" USING btree ("gender", "family_name_kana", "given_name_kana")[0m
  [1m[35m (3.7ms)[0m  CREATE  INDEX  "index_customers_on_given_name_kana" ON "customers" USING btree ("given_name_kana")
  [1m[36m (13.2ms)[0m  [1mCREATE TABLE "phones" ("id" serial primary key, "customer_id" integer NOT NULL, "address_id" integer, "number" character varying(255) NOT NULL, "number_for_index" character varying(255) NOT NULL, "primary" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp, "last_four_digits" character varying(255)) [0m
  [1m[35m (3.8ms)[0m  CREATE  INDEX  "index_phones_on_address_id" ON "phones" USING btree ("address_id")
  [1m[36m (6.1ms)[0m  [1mCREATE  INDEX  "index_phones_on_customer_id" ON "phones" USING btree ("customer_id")[0m
  [1m[35m (5.0ms)[0m  CREATE  INDEX  "index_phones_on_last_four_digits" ON "phones" USING btree ("last_four_digits")
  [1m[36m (5.9ms)[0m  [1mCREATE  INDEX  "index_phones_on_number_for_index" ON "phones" USING btree ("number_for_index")[0m
  [1m[35m (7.0ms)[0m  CREATE TABLE "staff_events" ("id" serial primary key, "staff_member_id" integer NOT NULL, "type" character varying(255) NOT NULL, "created_at" timestamp NOT NULL) 
  [1m[36m (6.3ms)[0m  [1mCREATE  INDEX  "index_staff_events_on_created_at" ON "staff_events" USING btree ("created_at")[0m
  [1m[35m (3.4ms)[0m  CREATE  INDEX  "index_staff_events_on_staff_member_id_and_created_at" ON "staff_events" USING btree ("staff_member_id", "created_at")
  [1m[36m (9.8ms)[0m  [1mCREATE TABLE "staff_members" ("id" serial primary key, "email" character varying(255) NOT NULL, "email_for_index" character varying(255) NOT NULL, "family_name" character varying(255) NOT NULL, "given_name" character varying(255) NOT NULL, "family_name_kana" character varying(255) NOT NULL, "given_name_kana" character varying(255) NOT NULL, "hashed_password" character varying(255), "start_date" date NOT NULL, "end_date" date, "suspended" boolean DEFAULT 'f' NOT NULL, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (6.2ms)[0m  CREATE UNIQUE INDEX  "index_staff_members_on_email_for_index" ON "staff_members" USING btree ("email_for_index")
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_staff_members_on_family_name_kana_and_given_name_kana" ON "staff_members" USING btree ("family_name_kana", "given_name_kana")[0m
  [1m[35m (4.9ms)[0m  ALTER TABLE "addresses" ADD CONSTRAINT "addresses_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (2.8ms)[0m  [1mALTER TABLE "phones" ADD CONSTRAINT "phones_address_id_fk" FOREIGN KEY ("address_id") REFERENCES "addresses"(id)[0m
  [1m[35m (3.7ms)[0m  ALTER TABLE "phones" ADD CONSTRAINT "phones_customer_id_fk" FOREIGN KEY ("customer_id") REFERENCES "customers"(id)
  [1m[36m (3.6ms)[0m  [1mALTER TABLE "staff_events" ADD CONSTRAINT "staff_events_staff_member_id_fk" FOREIGN KEY ("staff_member_id") REFERENCES "staff_members"(id)[0m
  [1m[35m (0.7ms)[0m  CREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) 
  [1m[36m (4.5ms)[0m  [1mCREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")[0m
  [1m[35m (0.3ms)[0m  SELECT version FROM "schema_migrations"
  [1m[36m (1.0ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812093211')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140723082116')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140723111825')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140803013844')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140809065211')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140809065229')
  [1m[36m (1.3ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140811122237')[0m
  [1m[35m (1.3ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812034537')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812034548')[0m
  [1m[35m (0.8ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812041117')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140812080925')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140812082005')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.7ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin1@example.com' LIMIT 1
  [1m[36mSQL (9.7ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:25.543879"], ["email", "admin1@example.com"], ["email_for_index", "admin1@example.com"], ["hashed_password", "$2a$10$Ui2ShoO92TSQAXz/x5sUZ.Kjk1rm/6RjTl2G9K7o1wNEF0ahPKaSm"], ["updated_at", "2014-08-26 12:14:25.543879"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.4ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:25.680478"], ["email", "member1@example.com"], ["email_for_index", "member1@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$moip6hFo6cQDQHkFBU17d.58HBiAHY3nAea88nYkqcnlfQ4.qw4Oq"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:25.680478"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 109ms (ActiveRecord: 2.9ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:14:25.778824"], ["email", "admin2@example.com"], ["email_for_index", "admin2@example.com"], ["hashed_password", "$2a$10$rCDqgRVBwbfr.2ebsh7Eq.WrQWFMEPKg3FjKCZo9bunecAedD4zQS"], ["updated_at", "2014-08-26 12:14:25.778824"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.2ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 2 LIMIT 1
Completed 400 Bad Request in 2ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:25.870865"], ["email", "admin3@example.com"], ["email_for_index", "admin3@example.com"], ["hashed_password", "$2a$10$7p11CBsG0EJo.AfE2g0XiOnX4TlmPp.kYAoZFITgeb5OtlW0D9X4C"], ["updated_at", "2014-08-26 12:14:25.870865"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:25.957901"], ["email", "member3@example.com"], ["email_for_index", "member3@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$M8rd0hWHS.Y9J3/ld7FdW.rmJ6C2NKcYOIngmyhSKFP7HQYp4dOX2"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:25.957901"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}, "id"=>"2"}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 3 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1  [["id", 2]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member2@example.com' AND "staff_members"."id" != 2) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "hashed_password" = $3, "suspended" = $4, "updated_at" = $5 WHERE "staff_members"."id" = 2[0m  [["email", "member2@example.com"], ["email_for_index", "member2@example.com"], ["hashed_password", "$2a$10$T9P/kyirmjY8FGIvls0hF.Fajzb24ohTD6/ROa2hIRaVzOYJ7f6nS"], ["suspended", "t"], ["updated_at", "2014-08-26 12:14:26.058314"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 101ms (ActiveRecord: 1.4ms)
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.146814"], ["email", "admin4@example.com"], ["email_for_index", "admin4@example.com"], ["hashed_password", "$2a$10$y3NDHyX.sBueJP/Gqyz2hO3QzLnZZZqBVft595P/ojeZ1.A54DTVq"], ["updated_at", "2014-08-26 12:14:26.146814"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.247411"], ["email", "member5@example.com"], ["email_for_index", "member5@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$CmavqX8Yb6iuaJat57bDUueu5Nym.seXfxXB2aOFmw8Sx1Dj7GGX."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:26.247411"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"3"}
  [1m[35mAdminMember Load (0.2ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 4 LIMIT 1
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 3]]
Unpermitted parameters: hashed_password
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member4@example.com' AND "staff_members"."id" != 3) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 3  [["email", "member4@example.com"], ["email_for_index", "member4@example.com"], ["updated_at", "2014-08-26 12:14:26.258747"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 7ms (ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.340066"], ["email", "admin5@example.com"], ["email_for_index", "admin5@example.com"], ["hashed_password", "$2a$10$hT83AkFz.HmYuiIFn2W3P.nKWyLBzJbGZD9fuKMdMKSSzS4aH8gcC"], ["updated_at", "2014-08-26 12:14:26.340066"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.2ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 5 LIMIT 1
Completed 200 OK in 74ms (Views: 72.6ms | ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin6@example.com' LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:26.510875"], ["email", "admin6@example.com"], ["email_for_index", "admin6@example.com"], ["hashed_password", "$2a$10$TWHwGSb5c/pVUQniv8WpcuUm8Rc0troxQGEQkSA.sGrBVV6OzBvi2"], ["updated_at", "2014-08-26 12:14:26.510875"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "admin_members" SET "suspended" = 't' WHERE "admin_members"."id" = 6[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.2ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 6 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:26.595346"], ["email", "admin7@example.com"], ["email_for_index", "admin7@example.com"], ["hashed_password", "$2a$10$hPFG.o3i0qUI2aJa.vIhZu8dkRP091L2396Usx/mRrdxnNM6.4.qq"], ["updated_at", "2014-08-26 12:14:26.595346"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 7 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.690564"], ["email", "member6@example.com"], ["email_for_index", "member6@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ncgBpr22f1Qdav3aGZY7tOrwdfrxAe/7EESXmTriEwFlMCcr/8YmK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:26.690564"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"4", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 4 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'test@example.com' AND "staff_members"."id" != 4) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 4[0m  [["email", "test@example.com"], ["email_for_index", "test@example.com"], ["updated_at", "2014-08-26 12:14:26.699613"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 4]]
  [1m[35m (1.3ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.801027"], ["email", "member8@example.com"], ["email_for_index", "member8@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Pfc5ILI1deBlQlklmlyDruUjjBJPP/tB6pUpKfbChWAQR4rW9lEC6"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:26.801027"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"5"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 5 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:26.893045"], ["email", "member9@example.com"], ["email_for_index", "member9@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$QMCekAhGnfkarZOBu.X6s.TGi./oaFAI6aFb1yTib.RJRhvM1wPg2"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:26.893045"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"6", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>"2014-08-27", "suspended"=>false}}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 6 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member10@example.com' AND "staff_members"."id" != 6) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 6  [["email", "member10@example.com"], ["email_for_index", "member10@example.com"], ["updated_at", "2014-08-26 12:14:26.902504"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:26.997720"], ["email", "member11@example.com"], ["email_for_index", "member11@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$TlMUPeHroYpbUpuVzKz78eliZKSoqjHpbXUyK4uLfd72UFJFOBXyy"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:26.997720"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"7", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.7ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 7 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member12@example.com' AND "staff_members"."id" != 7) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 7[0m  [["email", "member12@example.com"], ["email_for_index", "member12@example.com"], ["updated_at", "2014-08-26 12:14:27.006865"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.4ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:27.088917"], ["email", "member13@example.com"], ["email_for_index", "member13@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Ms9Xt5iIUjWoup81IH1O2.dVZjKN9r.GECNNg4O8F2LVy77oOsTGu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:27.088917"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.8ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 8 LIMIT 1[0m
Completed 200 OK in 55ms (Views: 52.5ms | ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:27.242768"], ["email", "member14@example.com"], ["email_for_index", "member14@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$5hygKBWom1PbbRTbmaQwVelapkukcGOxcbGYHl7wkkRzHmZ89OO6q"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:27.242768"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "suspended" = 't' WHERE "staff_members"."id" = 9
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 9 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:27.327864"], ["email", "member15@example.com"], ["email_for_index", "member15@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Iybp2TfUCCtPU8HPzyqZO.opvLYNfTVV/nL.rV5KAUTYs2RB/W6ne"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:27.327864"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 10 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (1.2ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member1@example.jp' LIMIT 1
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:27.570882"], ["email", "member1@example.jp"], ["email_for_index", "member1@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$zP8KuQPCBjiK5b0zd2EceuUs/FVgOsdhCkK41KoZFGMIz8dEoLqXi"], ["updated_at", "2014-08-26 12:14:27.570882"]]
  [1m[35mSQL (4.0ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:27.573537"], ["customer_id", 1], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:27.573537"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:27.579347"], ["customer_id", 1], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:27.579347"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:27.677573"], ["email", "member16@example.com"], ["email_for_index", "member16@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$r8P3MP.ahx6ZQbJdy21LzOiv3REkK5s1Ga2q9Fn5ThR9wH5NS3acG"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:27.677573"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:27 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.4ms)
Completed 200 OK in 220ms (Views: 182.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:27 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:28.101357"], ["staff_member_id", 11], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 143ms (ActiveRecord: 2.4ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:28 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 41ms (Views: 38.4ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:28 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (60.5ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (1.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 231ms (Views: 216.4ms | ActiveRecord: 2.1ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:14:28 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (8.4ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_customer_fields.html.erb (93.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (32.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_work_address_fields.html.erb (14.0ms)
  Rendered staff/customers/_form.html.erb (207.6ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 335ms (Views: 280.9ms | ActiveRecord: 1.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:14:28 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:28.916884"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$8SmJJn0zI3H/Tgcu6E7sjO.z7Iy5m6s2O1IUg2FAOE7X/QWPE8/Pi"], ["updated_at", "2014-08-26 12:14:28.916884"]]
  [1m[35mSQL (8.9ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:28.918602"], ["customer_id", 2], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:28.918602"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:28.930264"], ["customer_id", 2], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:28.930264"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 115ms (ActiveRecord: 10.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:28 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 11 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.7ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 57ms (Views: 53.4ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 2]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 2]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.7ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:29.096099"], ["email", "member2@example.jp"], ["email_for_index", "member2@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$WKf9ne3Lp2slEGdqHyCfmuenyL7Pz5KkEDNYiocj8oQIM3HDlnLo6"], ["updated_at", "2014-08-26 12:14:29.096099"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:29.098058"], ["customer_id", 3], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:29.098058"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:29.099983"], ["customer_id", 3], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:29.099983"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:29.178392"], ["email", "member17@example.com"], ["email_for_index", "member17@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P1pOGn4C12IEQYT2czgkYenJ/xaol3PKu0ASa4uomC51vD0phlRm2"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:29.178392"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 26ms (Views: 26.0ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:29.295260"], ["staff_member_id", 12], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 83ms (ActiveRecord: 1.4ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 25ms (Views: 23.1ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 56ms (Views: 52.5ms | ActiveRecord: 0.9ms)
Started GET "/customers/3/edit" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"3"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 3]]
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 3]]
  [1m[35mHomeAddress Load (0.9ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 5]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 6]]
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_customer_fields.html.erb (11.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.8ms)
  Rendered staff/customers/_form.html.erb (37.1ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 132ms (Views: 118.1ms | ActiveRecord: 2.6ms)
Started PATCH "/customers/3" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"3"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 3]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 5]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 6]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'test@example.jp' AND "customers"."id" != 3) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "customers" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "customers"."id" = 3[0m  [["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["updated_at", "2014-08-26 12:14:29.569315"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "addresses" SET "postal_code" = $1, "updated_at" = $2 WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."id" = 5  [["postal_code", "9999999"], ["updated_at", "2014-08-26 12:14:29.571060"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 24ms (ActiveRecord: 3.1ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 52ms (Views: 48.5ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 3]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 3]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:29.719119"], ["email", "member3@example.jp"], ["email_for_index", "member3@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$XZ2k1yhhYY8MsVZG62Q8AuHBLQrYTKk9cdCPu53lFXG1x/P3BCJni"], ["updated_at", "2014-08-26 12:14:29.719119"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:29.731424"], ["customer_id", 4], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:29.731424"]]
  [1m[35mSQL (0.7ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:29.733897"], ["customer_id", 4], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:29.733897"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:29.826666"], ["email", "member18@example.com"], ["email_for_index", "member18@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$TCEbpM71dhf43BTLdIzbUeHgSJL73nFxgyYMqCx1hhtztGPe3EhBK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:29.826666"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 34ms (Views: 33.3ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:14:29.951048"], ["staff_member_id", 13], ["type", "logged_in"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 82ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:29 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 45ms (Views: 42.6ms | ActiveRecord: 0.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:30 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (20.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 51ms (Views: 47.1ms | ActiveRecord: 1.1ms)
Started GET "/customers/4/edit" for 127.0.0.1 at 2014-08-26 12:14:30 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"4"}
  [1m[35mStaffMember Load (0.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 4]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 4]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 4]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 4]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 7]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 8]]
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (11.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.8ms)
  Rendered staff/customers/_form.html.erb (36.5ms)
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 76ms (Views: 64.6ms | ActiveRecord: 1.4ms)
Started PATCH "/customers/4" for 127.0.0.1 at 2014-08-26 12:14:30 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"4"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 13 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 4]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 4]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 4]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 4]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 7]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 8]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member3@example.jp' AND "customers"."id" != 4) LIMIT 1[0m
  [1m[35m (3.0ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (12.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.8ms)
  Rendered staff/customers/_form.html.erb (38.7ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 645ms (Views: 63.9ms | ActiveRecord: 5.5ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.7ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:30.914426"], ["email", "member4@example.jp"], ["email_for_index", "member4@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$6ghAr2FbfPIPxIAHrKM.teqyj/25k8BTY2z.0xQxfd52chkGVHPw."], ["updated_at", "2014-08-26 12:14:30.914426"]]
  [1m[35mSQL (1.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:30.916849"], ["customer_id", 5], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:30.916849"]]
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:30.919636"], ["customer_id", 5], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:30.919636"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:31.011992"], ["email", "member19@example.com"], ["email_for_index", "member19@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$tJFW8tM/q5L6SoT5yOPaR.oVFNIYyPd99shOchHHJ91Rilu56QWEe"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:31.011992"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 26ms (Views: 25.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:31.125142"], ["staff_member_id", 14], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 43ms (Views: 40.9ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.9ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 50.0ms | ActiveRecord: 1.3ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_customer_fields.html.erb (10.5ms)
  Rendered staff/customers/_phone_fields.html.erb (2.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (15.5ms)
  Rendered staff/customers/_form.html.erb (39.8ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 76ms (Views: 69.3ms | ActiveRecord: 0.4ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:31.459745"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$xXzpKyGEhQxnvQQnMdPacO/qMIkqT7jJ0TNcj466KHp5B.bcNYaW2"], ["updated_at", "2014-08-26 12:14:31.459745"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 104ms (ActiveRecord: 1.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 14 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 55ms (Views: 52.1ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 6]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 6]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:31.608023"], ["email", "member5@example.jp"], ["email_for_index", "member5@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$7RFqT2bAUten2QomGQYyv.tBqE6TEdioeUR6q3iLYyjcoNMC7Oury"], ["updated_at", "2014-08-26 12:14:31.608023"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:31.610930"], ["customer_id", 7], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:31.610930"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:31.614086"], ["customer_id", 7], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:31.614086"]]
  [1m[35m (1.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:31.706303"], ["email", "member20@example.com"], ["email_for_index", "member20@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$1u0aEmkYnJCymFn.KQLlhOc50H8wfS6x9kx1UFRixtZfcLnn8iGIW"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:31.706303"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (6.9ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 34ms (Views: 33.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:31.828558"], ["staff_member_id", 15], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 81ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 38ms (Views: 36.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 12]]
  [1m[35mSQL (0.4ms)[0m  DELETE FROM "addresses" WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."id" = $1  [["id", 12]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (25.3ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 72ms (Views: 69.1ms | ActiveRecord: 0.8ms)
Started GET "/customers/7/edit" for 127.0.0.1 at 2014-08-26 12:14:31 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 7]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 7]]
  [1m[36mWorkAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 11]]
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (14.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.1ms)
  Rendered staff/customers/_form.html.erb (40.1ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 85ms (Views: 73.4ms | ActiveRecord: 1.5ms)
Started PATCH "/customers/7" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 7]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 7]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 11]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.5ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member5@example.jp' AND "customers"."id" != 7) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テストテスト"], ["created_at", "2014-08-26 12:14:32.080353"], ["customer_id", 7], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:32.080353"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 26ms (ActiveRecord: 2.7ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 15 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 49.9ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 7]]
  [1m[35m (2.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:32.239867"], ["email", "member6@example.jp"], ["email_for_index", "member6@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Xv90SlKGar9grgzeUMokZOsylDxwNN4UfMKyJGY3YrAQ/uJU7akPC"], ["updated_at", "2014-08-26 12:14:32.239867"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:32.241756"], ["customer_id", 8], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:32.241756"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:32.244177"], ["customer_id", 8], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:32.244177"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:32.331399"], ["email", "member21@example.com"], ["email_for_index", "member21@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$O0Y1A5O4Et4Bt5/X.tGrtO7XCeUVV8lZUID2udQcEINsDBW7q0vW."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:32.331399"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 26ms (Views: 25.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:14:32.447439"], ["staff_member_id", 16], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 35ms (Views: 32.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 65ms (Views: 61.7ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_customer_fields.html.erb (12.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (14.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.5ms)
  Rendered staff/customers/_form.html.erb (41.6ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 75ms (Views: 67.8ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:32.798434"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$dTakPivh.m4TVKnRJFmrfOVN7zSEnY4Zs5gfPoafLU6RtPES3gYhy"], ["updated_at", "2014-08-26 12:14:32.798434"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:32.800592"], ["customer_id", 9], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:32.800592"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 110ms (ActiveRecord: 1.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:32 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.9ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 50.7ms | ActiveRecord: 1.0ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 9]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 9]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:32.946923"], ["email", "member7@example.jp"], ["email_for_index", "member7@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$94KoxZze43/BL5hsIdT.1.M8tUWMNstVpoyCf60NF4nL9tHne9h5i"], ["updated_at", "2014-08-26 12:14:32.946923"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:32.948667"], ["customer_id", 10], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:32.948667"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:32.950695"], ["customer_id", 10], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:32.950695"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:33.035869"], ["email", "member22@example.com"], ["email_for_index", "member22@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$2JnmNj4KfivURzoIa/vSNOJOBeRmyqnSdXdCBNYNkRkuNEA/L3QUe"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:33.035869"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 27.5ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:33.151477"], ["staff_member_id", 17], ["type", "logged_in"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 44ms (Views: 33.7ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.4ms)
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (1.0ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 69ms (Views: 65.3ms | ActiveRecord: 1.4ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (12.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.6ms)
  Rendered staff/customers/_form.html.erb (39.9ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 72ms (Views: 64.8ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.5ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.6ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:33.501319"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$LjIbvPr6Bj..fwkeKcB4IO27Vw6GAn5OvK0xcaX2nBxY9/Dk06lDu"], ["updated_at", "2014-08-26 12:14:33.501319"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:33.504039"], ["customer_id", 11], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:33.504039"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 104ms (ActiveRecord: 2.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.2ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 49.8ms | ActiveRecord: 0.7ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 11]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 11]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:33.655612"], ["email", "member8@example.jp"], ["email_for_index", "member8@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ZBUB8oDYI8tOnEoJnj3W7.tGBU7502ae80KCTDd6yxFWXQB5c1iA2"], ["updated_at", "2014-08-26 12:14:33.655612"]]
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:33.658160"], ["customer_id", 12], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:33.658160"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:33.662287"], ["customer_id", 12], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:33.662287"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:33.745990"], ["email", "member23@example.com"], ["email_for_index", "member23@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$uILq1r2TQxTcMq62C8N0qu5x5svxHsM6a2qxMyzCSK.EFBOMhBBcK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:33.745990"]]
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 26ms (Views: 25.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:14:33.864500"], ["staff_member_id", 18], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.6ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 27.0ms | ActiveRecord: 0.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (22.9ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 70ms (Views: 65.4ms | ActiveRecord: 0.9ms)
Started GET "/customers/12/edit" for 127.0.0.1 at 2014-08-26 12:14:33 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"12"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  [1m[36mCustomer Load (0.1ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 12]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 12]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 12]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 12]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 20]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 21]]
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (13.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.8ms)
  Rendered staff/customers/_form.html.erb (40.8ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 76ms (Views: 63.9ms | ActiveRecord: 1.6ms)
Started PATCH "/customers/12" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"12"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 12]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 12]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 12]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 12]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 20]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 21]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member8@example.jp' AND "customers"."id" != 12) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "phones" ("created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["created_at", "2014-08-26 12:14:34.099815"], ["customer_id", 12], ["last_four_digits", "9999"], ["number", "090-9999-9999"], ["number_for_index", "09099999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:14:34.099815"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 38ms (ActiveRecord: 2.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 18 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (21.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 65ms (Views: 61.6ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (1.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 12]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 12]]
  [1m[36mPhone Load (0.3ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  ORDER BY "phones"."id" ASC[0m  [["customer_id", 12]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:34.276251"], ["email", "member9@example.jp"], ["email_for_index", "member9@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$pO87BqirnfNpRNqe7pty7ecXP3Dc3WXKuOYPboIfrThd2EDinOeES"], ["updated_at", "2014-08-26 12:14:34.276251"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:34.278667"], ["customer_id", 13], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:34.278667"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:34.279998"], ["customer_id", 13], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:34.279998"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:34.363324"], ["email", "member24@example.com"], ["email_for_index", "member24@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$qAW4WINNQuD4TI.R5F74ueKtcvGkcek3FErg3gC3GHgpjlhOyqVWa"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:34.363324"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 30ms (Views: 29.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (1.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:14:34.497531"], ["staff_member_id", 19], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 83ms (ActiveRecord: 1.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.1ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 57ms (Views: 53.1ms | ActiveRecord: 1.0ms)
Started GET "/customers/13/edit" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"13"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 13]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 13]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 22]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 23]]
  Rendered staff/customers/_phone_fields.html.erb (2.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (28.3ms)
  Rendered staff/customers/_phone_fields.html.erb (3.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_home_address_fields.html.erb (15.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (14.1ms)
  Rendered staff/customers/_form.html.erb (59.6ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 108ms (Views: 96.6ms | ActiveRecord: 1.4ms)
Started PATCH "/customers/13" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"13"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 13]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 13]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36mWorkAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 13]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 22]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 23]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member9@example.jp' AND "customers"."id" != 13) LIMIT 1[0m
  [1m[35mAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1  [["id", 22]]
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["address_id", 22], ["created_at", "2014-08-26 12:14:34.753354"], ["customer_id", 13], ["last_four_digits", "9999"], ["number", "03-9999-9999"], ["number_for_index", "0399999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:14:34.753354"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 43ms (ActiveRecord: 2.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:34 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 19 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.2ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 61ms (Views: 56.8ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 13]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 22]]
  [1m[35mPhone Load (0.3ms)[0m  SELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC  [["address_id", 22]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.5ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:14:34.947130"], ["email", "member10@example.jp"], ["email_for_index", "member10@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$uset8yt0OAMMZtBRT27lMuuy5oVlaCABvo/1NlrKXZsb8F9BXeW.O"], ["updated_at", "2014-08-26 12:14:34.947130"]]
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:14:34.948973"], ["customer_id", 14], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:14:34.948973"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:14:34.950692"], ["customer_id", 14], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:14:34.950692"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:35.027906"], ["email", "member25@example.com"], ["email_for_index", "member25@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$F6h3JBDz2KAX9dcnd73sZ.T5sOhMoqRVCdO9G9KaKaIzLZR5EYrD."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:35.027906"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 28.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:35.161270"], ["staff_member_id", 20], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 90ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 37ms (Views: 34.3ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (23.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 58ms (Views: 54.0ms | ActiveRecord: 0.9ms)
Started GET "/customers/14/edit" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"14"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36m (0.8ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 14]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 14]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 24]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 25]]
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (14.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (12.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.9ms)
  Rendered staff/customers/_form.html.erb (42.1ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 96ms (Views: 83.1ms | ActiveRecord: 2.2ms)
Started PATCH "/customers/14" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"14"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 14]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 14]]
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 14]]
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 24]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 25]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member10@example.jp' AND "customers"."id" != 14) LIMIT 1
  [1m[36mAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1[0m  [["id", 25]]
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["address_id", 25], ["created_at", "2014-08-26 12:14:35.406629"], ["customer_id", 14], ["last_four_digits", "1111"], ["number", "03-9999-1111"], ["number_for_index", "0399991111"], ["primary", "t"], ["updated_at", "2014-08-26 12:14:35.406629"]]
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 25ms (ActiveRecord: 3.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:14:35 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 20 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (26.6ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 62ms (Views: 57.7ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 14]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 14]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 25]]
  [1m[36mPhone Load (0.3ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 25]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:35.752239"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$liOmIRjmLCgQeCK/KwSIQe0HLQbfwH15LApRhSNewb9f8Q/PDGpoK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:35.752239"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (1.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:35.847497"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$G/m13wAQX/37LfVOhNozjuOmwgQrC1ZyJLmkTa1gth6bAeHMh/LTK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:35.847497"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:35.929710"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$JDf96do09gXXtg3uHRyvi.kO/6UFxGwX3mABqB2OyUOXnEnCRt3By"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:35.929710"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:36.015777"], ["email", "member26@example.com"], ["email_for_index", "member26@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wfjn17cWqff.l7bYE6H4qeJ2ckdSYnjOKHjcYXHOUSPIzJb070AFa"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:36.015777"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:14:36.110159"], ["email", "member27@example.com"], ["email_for_index", "member27@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P5oRqzXfAIWprjZOC/b/a.jnkl831DkOBobedCNMKVBmQhMrFVGMq"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:36.110159"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member29@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:14:36.453710"], ["email", "member30@example.com"], ["email_for_index", "member30@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Y5rmZavjCrknx4x4gqOjGOWMrDBkSnk7HLrWnAvwuaph6Vagq9UsC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:14:36.453710"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member31@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (1.2ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin1@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:14.151688"], ["email", "admin1@example.com"], ["email_for_index", "admin1@example.com"], ["hashed_password", "$2a$10$eK1/VIFBaHLfdTiPeRVtq.m12JZ5d0PY1iy.U2uB9dYhRSgYmx3eq"], ["updated_at", "2014-08-26 12:16:14.151688"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 8 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:14.276674"], ["email", "member1@example.com"], ["email_for_index", "member1@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$XBKH2QA2T.JKhZpRN.atlO0gyl1ZAsob5stpGEcpJDnSGR/Ra4wtK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:14.276674"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 113ms (ActiveRecord: 2.4ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:16:14.359868"], ["email", "admin2@example.com"], ["email_for_index", "admin2@example.com"], ["hashed_password", "$2a$10$Vyf69UyNL5iPFql0CgrsJuCoVy8iCDG539BD.sRyrxmeRvxcMMW6S"], ["updated_at", "2014-08-26 12:16:14.359868"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.1ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 9 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:14.468248"], ["email", "admin3@example.com"], ["email_for_index", "admin3@example.com"], ["hashed_password", "$2a$10$oNOjoAWYqrr9D6qePS0/yu6Nrc4kEH8JeL3jJ4Uo9qzzkr/2ey2wq"], ["updated_at", "2014-08-26 12:16:14.468248"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (1.1ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:14.548507"], ["email", "member3@example.com"], ["email_for_index", "member3@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$x21mxUKynN8KqMZXODrnKuV2sSv8QdO6hn6ZDm1GR9ZDdUaYzsc1K"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:14.548507"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}, "id"=>"28"}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 10 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1  [["id", 28]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.9ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member2@example.com' AND "staff_members"."id" != 28) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "hashed_password" = $3, "suspended" = $4, "updated_at" = $5 WHERE "staff_members"."id" = 28[0m  [["email", "member2@example.com"], ["email_for_index", "member2@example.com"], ["hashed_password", "$2a$10$C8GODfFEJC5s2jTEu30iI.zOh0cWr7sdjH8E1PHsqux8Pyt/16.vK"], ["suspended", "t"], ["updated_at", "2014-08-26 12:16:14.645444"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 97ms (ActiveRecord: 2.0ms)
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 28]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:16:14.730596"], ["email", "admin4@example.com"], ["email_for_index", "admin4@example.com"], ["hashed_password", "$2a$10$fz8/lUZJZqAG1/l.EKubWuW9AWG7I3tOilP4VUmuWFYasbLzh7Bli"], ["updated_at", "2014-08-26 12:16:14.730596"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:14.815510"], ["email", "member5@example.com"], ["email_for_index", "member5@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$4vJeNTAXB2QQS1SfKHEr1.3VHs9BuBAoObFiGg9pXIhB29unq1C2i"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:14.815510"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"29"}
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 11 LIMIT 1
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 29]]
Unpermitted parameters: hashed_password
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member4@example.com' AND "staff_members"."id" != 29) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 29  [["email", "member4@example.com"], ["email_for_index", "member4@example.com"], ["updated_at", "2014-08-26 12:16:14.825863"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 9ms (ActiveRecord: 1.4ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:16:14.921747"], ["email", "admin5@example.com"], ["email_for_index", "admin5@example.com"], ["hashed_password", "$2a$10$7IP4tLgvX.xM6/rTRcvq6Od76XtLA0DWoQcjtldG/uI4cCjUPS8F."], ["updated_at", "2014-08-26 12:16:14.921747"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.0ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 12 LIMIT 1
Completed 200 OK in 59ms (Views: 57.7ms | ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin6@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:15.063692"], ["email", "admin6@example.com"], ["email_for_index", "admin6@example.com"], ["hashed_password", "$2a$10$9mBXFwdxWNVYn3k6wYS3be.ZY9n/3wwQshVAStfe5C8VOzosfHxdK"], ["updated_at", "2014-08-26 12:16:15.063692"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "admin_members" SET "suspended" = 't' WHERE "admin_members"."id" = 13[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 13 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:15.161656"], ["email", "admin7@example.com"], ["email_for_index", "admin7@example.com"], ["hashed_password", "$2a$10$hU0HuKdVSiWQ8mk3IrE8FOOtDwgceXKcPnrjpm9aEUh2Kt0x2eRW6"], ["updated_at", "2014-08-26 12:16:15.161656"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.2ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 14 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:15.255581"], ["email", "member6@example.com"], ["email_for_index", "member6@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$xtTxROoBhh1gB2Blf2hmF..ejfGPPG0PFQLxuw63evYOBZiwaAkj."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.255581"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"30", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 30 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'test@example.com' AND "staff_members"."id" != 30) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 30[0m  [["email", "test@example.com"], ["email_for_index", "test@example.com"], ["updated_at", "2014-08-26 12:16:15.264707"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.9ms)
  [1m[36mStaffMember Load (0.8ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 30]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (1.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:15.366953"], ["email", "member8@example.com"], ["email_for_index", "member8@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Lr962bt7lKIuwWmWDZhQFOUjAdXiDdcBjKbbvsg/nAg6K8fIeNTli"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.366953"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"31"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 31 LIMIT 1
Completed 400 Bad Request in 3ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:15.455345"], ["email", "member9@example.com"], ["email_for_index", "member9@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$QaCQDphVn1sbLkrNXDsvBeqPDSF.b8Y9hrd.OM4P76vmWSZqByR/m"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.455345"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"32", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>"2014-08-27", "suspended"=>false}}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 32 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member10@example.com' AND "staff_members"."id" != 32) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 32  [["email", "member10@example.com"], ["email_for_index", "member10@example.com"], ["updated_at", "2014-08-26 12:16:15.463925"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:15.545242"], ["email", "member11@example.com"], ["email_for_index", "member11@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$fs24fQ.wXXB.oTk1KlhasOIOGKevlCbPzh5AwbZ2BPoH/72VwzJe6"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.545242"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"33", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 33 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member12@example.com' AND "staff_members"."id" != 33) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 33[0m  [["email", "member12@example.com"], ["email_for_index", "member12@example.com"], ["updated_at", "2014-08-26 12:16:15.554958"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 7ms (ActiveRecord: 1.1ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:15.655251"], ["email", "member13@example.com"], ["email_for_index", "member13@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$mWIQTJ6xckK2/2WGmKzOr.zSr3ZqVYjMfan3xseov30sXJ/S92KwO"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.655251"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 34 LIMIT 1[0m
Completed 200 OK in 39ms (Views: 37.2ms | ActiveRecord: 0.1ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:15.777392"], ["email", "member14@example.com"], ["email_for_index", "member14@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$HgyFY6h42gSKbH8KEDVgZ.euJ/zN/X7NSk.cY9JQ8jhNuYdegBZAi"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.777392"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE "staff_members" SET "suspended" = 't' WHERE "staff_members"."id" = 35
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 35 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:15.880209"], ["email", "member15@example.com"], ["email_for_index", "member15@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$gUPeEGBXcGzbmx6dqlZmUOrIP5.MVc3OBA11uYR4T09yTnWJJycpi"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:15.880209"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 36 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.6ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member1@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:16.117313"], ["email", "member1@example.jp"], ["email_for_index", "member1@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$hommLAJbPZrehIiLc7JGx.y3tB7KqNiBP1YMX2jbd9dLnSi0X8Sky"], ["updated_at", "2014-08-26 12:16:16.117313"]]
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:16.119123"], ["customer_id", 15], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:16.119123"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:16.121466"], ["customer_id", 15], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:16.121466"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:16.204178"], ["email", "member16@example.com"], ["email_for_index", "member16@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$7/8UHk8.v5v1j/fv4KjRWuB9dQOW/KiNM8ORy8PDf2HpkSxMTdsU."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:16.204178"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:16 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.3ms)
Completed 200 OK in 208ms (Views: 154.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:16 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:16.595629"], ["staff_member_id", 37], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 140ms (ActiveRecord: 2.5ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:16 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 37 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 34ms (Views: 31.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:16 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 37 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (80.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (1.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 227ms (Views: 214.0ms | ActiveRecord: 1.7ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:16:16 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 37 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (9.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (81.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (33.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_work_address_fields.html.erb (35.0ms)
  Rendered staff/customers/_form.html.erb (211.1ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 337ms (Views: 285.4ms | ActiveRecord: 1.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 37 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:17.376148"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$z1DZaZG0RDvxDf7Veomm8eOG3bhqnfh63iAFSq099U14chrfyjvOS"], ["updated_at", "2014-08-26 12:16:17.376148"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:17.377918"], ["customer_id", 16], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:17.377918"]]
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:17.379960"], ["customer_id", 16], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:17.379960"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 96ms (ActiveRecord: 2.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 37 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 60ms (Views: 57.0ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 16]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 16]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:17.534649"], ["email", "member2@example.jp"], ["email_for_index", "member2@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$W36pHKPjEUrh.0JKIFVJounhkb.rNSH0jYgKX4F0ZWvBZ9esmouua"], ["updated_at", "2014-08-26 12:16:17.534649"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:17.536084"], ["customer_id", 17], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:17.536084"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:17.538470"], ["customer_id", 17], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:17.538470"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:17.616059"], ["email", "member17@example.com"], ["email_for_index", "member17@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$kxgDcEiQqlaRgId7VziEnebd1NGjhrKaSFSh7W744G1mmogMkt3AG"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:17.616059"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 40ms (Views: 39.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:17.743518"], ["staff_member_id", 38], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 38 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 27ms (Views: 24.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 38 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 54ms (Views: 51.4ms | ActiveRecord: 0.9ms)
Started GET "/customers/17/edit" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"17"}
  [1m[36mStaffMember Load (1.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 38 LIMIT 1[0m
  [1m[35mCustomer Load (6.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 17]]
  [1m[36m (1.0ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 17]]
  [1m[35mHomeAddress Load (1.0ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 17]]
  [1m[36mWorkAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 17]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 30]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 31]]
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (10.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.7ms)
  Rendered staff/customers/_form.html.erb (34.4ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 110ms (Views: 81.3ms | ActiveRecord: 10.0ms)
Started PATCH "/customers/17" for 127.0.0.1 at 2014-08-26 12:16:17 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"17"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 38 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 17]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 17]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 17]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 17]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 30]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 31]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'test@example.jp' AND "customers"."id" != 17) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "customers" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "customers"."id" = 17[0m  [["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["updated_at", "2014-08-26 12:16:18.031208"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "addresses" SET "postal_code" = $1, "updated_at" = $2 WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."id" = 30  [["postal_code", "9999999"], ["updated_at", "2014-08-26 12:16:18.033299"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 64ms (ActiveRecord: 3.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 38 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 64ms (Views: 61.2ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 17]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 17]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 17]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:18.192098"], ["email", "member3@example.jp"], ["email_for_index", "member3@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ePqc8AqNxdRiD099CzZEnOimirTtf6DEz/MSezZm9w44qUreNELAa"], ["updated_at", "2014-08-26 12:16:18.192098"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:18.194318"], ["customer_id", 18], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:18.194318"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:18.195945"], ["customer_id", 18], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:18.195945"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:18.273733"], ["email", "member18@example.com"], ["email_for_index", "member18@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$B.hWSXWz7t6e1RSmFwMUHe4hkIhhyFHeITstLxO7XzdT02Q5MSOni"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:18.273733"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 35.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.5ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:16:18.404540"], ["staff_member_id", 39], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 85ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 39 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 26.6ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 39 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 51ms (Views: 47.4ms | ActiveRecord: 0.9ms)
Started GET "/customers/18/edit" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"18"}
  [1m[35mStaffMember Load (0.5ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 39 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 18]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 18]]
  [1m[36mHomeAddress Load (0.7ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 18]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 18]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 32]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 33]]
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (19.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.4ms)
  Rendered staff/customers/_form.html.erb (44.7ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 88ms (Views: 72.1ms | ActiveRecord: 2.4ms)
Started PATCH "/customers/18" for 127.0.0.1 at 2014-08-26 12:16:18 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"18"}
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 39 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 18]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 18]]
  [1m[35mHomeAddress Load (0.6ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 18]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 18]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 32]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 33]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member3@example.jp' AND "customers"."id" != 18) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (12.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (16.8ms)
  Rendered staff/customers/_form.html.erb (42.3ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 453ms (Views: 74.6ms | ActiveRecord: 3.1ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:19.148114"], ["email", "member4@example.jp"], ["email_for_index", "member4@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$vVOsChSmL9DeAUN763cOaeVppv15lqUn9zg5H1.tIiG8CUUs.R2Iu"], ["updated_at", "2014-08-26 12:16:19.148114"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:19.149912"], ["customer_id", 19], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:19.149912"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:19.152449"], ["customer_id", 19], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:19.152449"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:19.229021"], ["email", "member19@example.com"], ["email_for_index", "member19@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$BZgQa7FDQ9wjoWjz388pGeo8zqAr.XXqSmocDHjZsxA/qrMeEZrRC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:19.229021"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 35.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:19.351760"], ["staff_member_id", 40], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 40 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 26.4ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 40 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.6ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 49ms (Views: 46.2ms | ActiveRecord: 1.0ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 40 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (14.1ms)
  Rendered staff/customers/_phone_fields.html.erb (2.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (14.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (2.3ms)
  Rendered staff/customers/_work_address_fields.html.erb (20.3ms)
  Rendered staff/customers/_form.html.erb (51.0ms)
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 86ms (Views: 79.5ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 40 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:19.656882"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$bYEZIKx19UCfMOEgVoXh/eKRoK1sygRjqqcRdyiCAUd9fnOO6Cf/2"], ["updated_at", "2014-08-26 12:16:19.656882"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 96ms (ActiveRecord: 1.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 40 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (24.0ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 70ms (Views: 66.6ms | ActiveRecord: 1.0ms)
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 20]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 20]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (1.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:19.831147"], ["email", "member5@example.jp"], ["email_for_index", "member5@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$fyNJpDs8SA9Tnamr4gR0Te.SsrV5daUMnDVT8YqKhrDDOPQ3Rzqbq"], ["updated_at", "2014-08-26 12:16:19.831147"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:19.832589"], ["customer_id", 21], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:19.832589"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:19.834761"], ["customer_id", 21], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:19.834761"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:19.912848"], ["email", "member20@example.com"], ["email_for_index", "member20@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$oDYH9tngGfcKRGu0Or2JyOm5nREA8tuiRtnxQaqDVIKN75nxuwc0W"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:19.912848"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 35ms (Views: 35.0ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:19 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:20.033543"], ["staff_member_id", 41], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 41 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.0ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 37]]
  [1m[35mSQL (0.5ms)[0m  DELETE FROM "addresses" WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."id" = $1  [["id", 37]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 41 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (26.3ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 60ms (Views: 56.8ms | ActiveRecord: 0.9ms)
Started GET "/customers/21/edit" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"21"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 41 LIMIT 1[0m
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 21]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 21]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 21]]
  [1m[36mWorkAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 21]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 36]]
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (13.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.6ms)
  Rendered staff/customers/_form.html.erb (39.6ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 87ms (Views: 72.3ms | ActiveRecord: 1.9ms)
Started PATCH "/customers/21" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"21"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 41 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 21]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 21]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 21]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 21]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 36]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member5@example.jp' AND "customers"."id" != 21) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テストテスト"], ["created_at", "2014-08-26 12:16:20.276339"], ["customer_id", 21], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:20.276339"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 28ms (ActiveRecord: 2.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 41 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (22.0ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 64ms (Views: 59.9ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 21]]
  [1m[36mWorkAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 21]]
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:20.449857"], ["email", "member6@example.jp"], ["email_for_index", "member6@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Og8QdnVwSslp5.Sg7f6K7O36BefxtZ2s84RBFqOPJ05PcdsgXtK5O"], ["updated_at", "2014-08-26 12:16:20.449857"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:20.451526"], ["customer_id", 22], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:20.451526"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:20.452788"], ["customer_id", 22], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:20.452788"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:20.530050"], ["email", "member21@example.com"], ["email_for_index", "member21@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$j43hPOqtaMMILjej342M2eNI3Sg4ry2redZUj1TIrzITixm1mWoe2"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:20.530050"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 30ms (Views: 29.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:16:20.659025"], ["staff_member_id", 42], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 92ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 42 LIMIT 1
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 32ms (Views: 29.9ms | ActiveRecord: 0.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 42 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.7ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 50.1ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 42 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_customer_fields.html.erb (12.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.5ms)
  Rendered staff/customers/_form.html.erb (37.9ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 69ms (Views: 63.1ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 42 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:20.984642"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$qyavUzPClfJC9iofvypQYe4W1zmB/rV3VnZBZA9m5umYDqHfzAa1e"], ["updated_at", "2014-08-26 12:16:20.984642"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:20.986138"], ["customer_id", 23], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:20.986138"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 91ms (ActiveRecord: 1.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:20 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 42 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (15.8ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 51.1ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 23]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 23]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (1.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:21.146615"], ["email", "member7@example.jp"], ["email_for_index", "member7@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$7jMictHUDGmVdLHWLSorn./N7rDvlwD2z1cN5haC2yRJuk5TNCJlS"], ["updated_at", "2014-08-26 12:16:21.146615"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:21.148953"], ["customer_id", 24], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:21.148953"]]
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:21.150224"], ["customer_id", 24], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:21.150224"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:21.226563"], ["email", "member22@example.com"], ["email_for_index", "member22@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ilrD.0UG4sgZkgjyZ25esOFO.EpYPx2nfNGnZaHjV2oAer.7lzAxe"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:21.226563"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 25ms (Views: 25.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:21.336240"], ["staff_member_id", 43], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 43 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 38ms (Views: 35.8ms | ActiveRecord: 0.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 43 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.1ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 50ms (Views: 47.0ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 43 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (10.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.2ms)
  Rendered staff/customers/_form.html.erb (33.7ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 65ms (Views: 59.5ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 43 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:21.651503"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$/Ur4uo7n.pRUsWP7YlSZc.loBDplDnDfqt35RjsfbqiXaHJP0CJvm"], ["updated_at", "2014-08-26 12:16:21.651503"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:21.653328"], ["customer_id", 25], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:21.653328"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 105ms (ActiveRecord: 1.7ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 43 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (77.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 109ms (Views: 104.8ms | ActiveRecord: 1.0ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 25]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 25]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:21.873071"], ["email", "member8@example.jp"], ["email_for_index", "member8@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$iFb4m9glJ7Qt6xboSxcOmuooNjGkmhvBy84uDOf5IAG6.JlsA.i.a"], ["updated_at", "2014-08-26 12:16:21.873071"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:21.875122"], ["customer_id", 26], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:21.875122"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:21.876921"], ["customer_id", 26], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:21.876921"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:21.953989"], ["email", "member23@example.com"], ["email_for_index", "member23@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$qyUP8oz5c64/Rx1jIbP.teyyLWnHb4vlvH9Faz1gFoW9IHp/r.u5a"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:21.953989"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 27ms (Views: 26.4ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:21 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1
  [1m[36m (7.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:16:22.073710"], ["staff_member_id", 44], ["type", "logged_in"]]
  [1m[36m (1.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 90ms (ActiveRecord: 9.4ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 44 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 57ms (Views: 51.8ms | ActiveRecord: 0.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 44 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (20.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 50ms (Views: 47.2ms | ActiveRecord: 1.0ms)
Started GET "/customers/26/edit" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"26"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 44 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 26]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 26]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 26]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 26]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 45]]
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 46]]
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (11.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (10.9ms)
  Rendered staff/customers/_form.html.erb (34.2ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 68ms (Views: 57.3ms | ActiveRecord: 1.6ms)
Started PATCH "/customers/26" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"26"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 44 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 26]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 26]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 26]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 26]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 45]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 46]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member8@example.jp' AND "customers"."id" != 26) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "phones" ("created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["created_at", "2014-08-26 12:16:22.310477"], ["customer_id", 26], ["last_four_digits", "9999"], ["number", "090-9999-9999"], ["number_for_index", "09099999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:16:22.310477"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 41ms (ActiveRecord: 2.1ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 44 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 59ms (Views: 55.7ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 26]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 26]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  ORDER BY "phones"."id" ASC[0m  [["customer_id", 26]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:22.483262"], ["email", "member9@example.jp"], ["email_for_index", "member9@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$LxWwa/r.dZFXDHbNKFAkwOFmqGVBlqtRlenzbjcAWkqbsJEFnIKJ2"], ["updated_at", "2014-08-26 12:16:22.483262"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:22.484814"], ["customer_id", 27], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:22.484814"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:22.487155"], ["customer_id", 27], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:22.487155"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:22.571701"], ["email", "member24@example.com"], ["email_for_index", "member24@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$/H7bpmk3u3V792vGuiXp1ectP8/RsPaM.IJ2MC7uUhhE9FBSCJv.i"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:22.571701"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 39.0ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:16:22.696506"], ["staff_member_id", 45], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 45 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 31ms (Views: 28.3ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 45 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (80.7ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 114ms (Views: 111.0ms | ActiveRecord: 1.0ms)
Started GET "/customers/27/edit" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"27"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 45 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 27]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 27]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 27]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 47]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 48]]
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (12.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.3ms)
  Rendered staff/customers/_form.html.erb (34.4ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 70ms (Views: 57.0ms | ActiveRecord: 1.5ms)
Started PATCH "/customers/27" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"27"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 45 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 27]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 27]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 27]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 27]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 47]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 48]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member9@example.jp' AND "customers"."id" != 27) LIMIT 1[0m
  [1m[35mAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1  [["id", 47]]
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["address_id", 47], ["created_at", "2014-08-26 12:16:22.961012"], ["customer_id", 27], ["last_four_digits", "9999"], ["number", "03-9999-9999"], ["number_for_index", "0399999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:16:22.961012"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 41ms (ActiveRecord: 2.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 45 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 59ms (Views: 55.4ms | ActiveRecord: 1.2ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 27]]
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 47]]
  [1m[35mPhone Load (0.2ms)[0m  SELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC  [["address_id", 47]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:16:23.134751"], ["email", "member10@example.jp"], ["email_for_index", "member10@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$6eMabDD2w4wco5pKsF6k3uZVqMWxq9g2lTD0kpjrydudd2Sxfn40i"], ["updated_at", "2014-08-26 12:16:23.134751"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:16:23.136350"], ["customer_id", 28], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:16:23.136350"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:16:23.138038"], ["customer_id", 28], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:16:23.138038"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:23.215063"], ["email", "member25@example.com"], ["email_for_index", "member25@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$MkKhfg5gL8aYT3n810UjjuRSiLGLJp7REVD2rpHEET.UEqHQ3Aj/."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:23.215063"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 40ms (Views: 39.3ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:23.344272"], ["staff_member_id", 46], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 81ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 46 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 46 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (15.3ms)
  [1m[36m (0.6ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 49ms (Views: 44.7ms | ActiveRecord: 1.4ms)
Started GET "/customers/28/edit" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"28"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 46 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 28]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 28]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 28]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 28]]
  [1m[35m (16.7ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 49]]
  [1m[36m (1.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 50]]
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_customer_fields.html.erb (15.4ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.3ms)
  Rendered staff/customers/_form.html.erb (39.8ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 125ms (Views: 63.9ms | ActiveRecord: 18.7ms)
Started PATCH "/customers/28" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"28"}
  [1m[35mStaffMember Load (0.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 46 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 28]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 28]]
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 28]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 28]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 49]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 50]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member10@example.jp' AND "customers"."id" != 28) LIMIT 1
  [1m[36mAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1[0m  [["id", 50]]
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 28]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["address_id", 50], ["created_at", "2014-08-26 12:16:23.595754"], ["customer_id", 28], ["last_four_digits", "1111"], ["number", "03-9999-1111"], ["number_for_index", "0399991111"], ["primary", "t"], ["updated_at", "2014-08-26 12:16:23.595754"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 24ms (ActiveRecord: 2.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:16:23 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 46 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (17.9ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 48ms (Views: 45.0ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 28]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 28]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 50]]
  [1m[36mPhone Load (0.8ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 50]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:23.918476"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Bq95.LuDgdSuFn1YxCF64.TfP.oJObJoev10HvDwO6G6.HjptYFJC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:23.918476"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.0ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:24.012509"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Q7lfZRfktFBpuZtvJ45YaOtSLFGViqMk.OqGzbBophxiMC8BlPS6."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:24.012509"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:24.091852"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$naWumUFJ8OM/tlZUrRU9NOmLBYAhy5C3YIa/eLL0xg0uMJtqNH.Ca"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:24.091852"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:24.172356"], ["email", "member26@example.com"], ["email_for_index", "member26@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$E3edK/GmpFDb6lekklo45.prUU8v0z.nCLy4R7E2Rd/Sgi5XscwcW"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:24.172356"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:16:24.266931"], ["email", "member27@example.com"], ["email_for_index", "member27@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$JlOHTi0Pd/eG9//qKuX6i.2pVMa0QdH0nu5qqjTFePycaV2AABbcm"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:24.266931"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member29@example.com' LIMIT 1
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:16:24.603739"], ["email", "member30@example.com"], ["email_for_index", "member30@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$o1GrPMv3.D2VDSBAjL3AZuiDEiNcf5MDlSk7QtQ9dSwIM7VMLOEdm"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:16:24.603739"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.5ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member31@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (1.7ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.7ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin1@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:18.406142"], ["email", "admin1@example.com"], ["email_for_index", "admin1@example.com"], ["hashed_password", "$2a$10$fZj8WSlGlu8jEDA2YetsMuJVQTpVeet6jYucoSgNFTpI7wTxA/Oui"], ["updated_at", "2014-08-26 12:17:18.406142"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 15 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:18.534605"], ["email", "member1@example.com"], ["email_for_index", "member1@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$GGtYRqfiMA0MKuDQXaRBIuOv2ttv7jtN/uOEvp6fPeid0HwmEqp1K"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:18.534605"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 116ms (ActiveRecord: 2.6ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:18.620847"], ["email", "admin2@example.com"], ["email_for_index", "admin2@example.com"], ["hashed_password", "$2a$10$HxetbRxKP9Li43a0WGRQ0.EM2ULOiE344NCNU20oHBLmvFQeXN4xq"], ["updated_at", "2014-08-26 12:17:18.620847"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 16 LIMIT 1
Completed 400 Bad Request in 2ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:18.725276"], ["email", "admin3@example.com"], ["email_for_index", "admin3@example.com"], ["hashed_password", "$2a$10$zlxDq9XDZuG5kP3lBBSqE.YTkPLRRhxFiYoW0F70ypZWzyyo4aRVi"], ["updated_at", "2014-08-26 12:17:18.725276"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:18.805092"], ["email", "member3@example.com"], ["email_for_index", "member3@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wncMeK4f2zy9QK02CA9pR.r5Q1e/N.GvO1NeR5mrABBsYF92TSnzS"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:18.805092"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}, "id"=>"54"}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 17 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1  [["id", 54]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member2@example.com' AND "staff_members"."id" != 54) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "hashed_password" = $3, "suspended" = $4, "updated_at" = $5 WHERE "staff_members"."id" = 54[0m  [["email", "member2@example.com"], ["email_for_index", "member2@example.com"], ["hashed_password", "$2a$10$j8DLQcHk3l.pTrBchCOF0uwu.bUsEl9DFAJ2wglSji7Eg/5dg1jie"], ["suspended", "t"], ["updated_at", "2014-08-26 12:17:18.887287"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 80ms (ActiveRecord: 1.4ms)
  [1m[36mStaffMember Load (0.8ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 54]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:18.979887"], ["email", "admin4@example.com"], ["email_for_index", "admin4@example.com"], ["hashed_password", "$2a$10$QL.DU5xOiq0gW9vME31kwePcugUClZyr0.NuHprGNmvsk4RrmmvVi"], ["updated_at", "2014-08-26 12:17:18.979887"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:19.067377"], ["email", "member5@example.com"], ["email_for_index", "member5@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P/ViGeFC/.PW/dokJCDv3eUs4rAz1qXBew.12y97NeKeshR53jfsu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.067377"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"55"}
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 18 LIMIT 1
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 55]]
Unpermitted parameters: hashed_password
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member4@example.com' AND "staff_members"."id" != 55) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 55  [["email", "member4@example.com"], ["email_for_index", "member4@example.com"], ["updated_at", "2014-08-26 12:17:19.077624"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 8ms (ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:19.160048"], ["email", "admin5@example.com"], ["email_for_index", "admin5@example.com"], ["hashed_password", "$2a$10$8Em9wX7Rt5RvSFtVcJYJTuhx/v7vL4bFazJFMQFvtxV/t7p4g0r3i"], ["updated_at", "2014-08-26 12:17:19.160048"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 19 LIMIT 1
Completed 200 OK in 72ms (Views: 70.5ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.5ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin6@example.com' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:19.328817"], ["email", "admin6@example.com"], ["email_for_index", "admin6@example.com"], ["hashed_password", "$2a$10$XrgJEv3JlaMZUvblJ19yCOOaIgWanec0h7zUaZBRf4C1LCBDFT/tS"], ["updated_at", "2014-08-26 12:17:19.328817"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "admin_members" SET "suspended" = 't' WHERE "admin_members"."id" = 20[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 20 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:19.416986"], ["email", "admin7@example.com"], ["email_for_index", "admin7@example.com"], ["hashed_password", "$2a$10$yBIOmNaLTRUN2lWLZaYwfOHtFlqD4u/aj.yCaRdZ12EDfsK26OREC"], ["updated_at", "2014-08-26 12:17:19.416986"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.5ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 21 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 7ms (ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:19.521280"], ["email", "member6@example.com"], ["email_for_index", "member6@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$J9cDylbNfa48YuWEqrWyV.RPrVcrmDgevmdDVe4Jut7I8NH/8JRPu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.521280"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"56", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 56 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (1.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'test@example.com' AND "staff_members"."id" != 56) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 56[0m  [["email", "test@example.com"], ["email_for_index", "test@example.com"], ["updated_at", "2014-08-26 12:17:19.531510"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 2.0ms)
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 56]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:19.621889"], ["email", "member8@example.com"], ["email_for_index", "member8@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$.TvDK4L1SPvKSR8o5GjOMuBbZZAfQGcDYpfHhkZj8ifJMnzQbmwVK"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.621889"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"57"}
  [1m[35mStaffMember Load (0.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 57 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:19.720288"], ["email", "member9@example.com"], ["email_for_index", "member9@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wteMkp46.cGbajaoSUaYiuwprE9QibSxD6xUGgIiIkZQXacYzWBFq"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.720288"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"58", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>"2014-08-27", "suspended"=>false}}
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 58 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member10@example.com' AND "staff_members"."id" != 58) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 58  [["email", "member10@example.com"], ["email_for_index", "member10@example.com"], ["updated_at", "2014-08-26 12:17:19.729581"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:19.814862"], ["email", "member11@example.com"], ["email_for_index", "member11@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$StqS7yQHP6Y4LfSwryTlZew1Trr3.QSq0ySCCr3UoFi0MHIYOgzSO"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.814862"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"59", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 59 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member12@example.com' AND "staff_members"."id" != 59) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 59[0m  [["email", "member12@example.com"], ["email_for_index", "member12@example.com"], ["updated_at", "2014-08-26 12:17:19.824213"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.9ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:19.920291"], ["email", "member13@example.com"], ["email_for_index", "member13@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$jQBiX97He6prmR.tTZlnNONbljB5JEREDSCnGLOD27.bNsoj/8NZm"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:19.920291"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 60 LIMIT 1[0m
Completed 200 OK in 38ms (Views: 37.2ms | ActiveRecord: 0.1ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:20.042675"], ["email", "member14@example.com"], ["email_for_index", "member14@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$If5sZMBtVzqP95D5VXbgxuZQ62.19kZQml5vfSEzp2F8eDadBrNWq"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:20.042675"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  UPDATE "staff_members" SET "suspended" = 't' WHERE "staff_members"."id" = 61
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (1.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 61 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 1.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:20.137321"], ["email", "member15@example.com"], ["email_for_index", "member15@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$flE911iR7tn9iii0VYKDteuu7KtJAsQbnO1RvwcF17fsb10XLCzVO"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:20.137321"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (1.5ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 62 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 1.5ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (1.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.6ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member1@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:20.352298"], ["email", "member1@example.jp"], ["email_for_index", "member1@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P.qG4iRauDkGa5PLBqbcNupLpBjgjGyADyMJQZmHFn2H/e4.Uhi0G"], ["updated_at", "2014-08-26 12:17:20.352298"]]
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:20.354683"], ["customer_id", 29], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:20.354683"]]
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:20.357475"], ["customer_id", 29], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:20.357475"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:20.451626"], ["email", "member16@example.com"], ["email_for_index", "member16@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ku.Wr6WNZqinTCLo2PNwZ.Rz2dLPr/yziJ7xeShOBa3pFPX/47UD."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:20.451626"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:20 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.4ms)
Completed 200 OK in 206ms (Views: 170.5ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:20 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:20.835884"], ["staff_member_id", 63], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 134ms (ActiveRecord: 3.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:20 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (2.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 63 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 34.3ms | ActiveRecord: 2.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:20 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 63 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (108.5ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.9ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 249ms (Views: 237.2ms | ActiveRecord: 1.5ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:21 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 63 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (7.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (82.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (32.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.6ms)
  Rendered staff/customers/_form.html.erb (199.3ms)
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 324ms (Views: 265.1ms | ActiveRecord: 1.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:21 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 63 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:21.654826"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$QaZ40ijO0Pq7LrvXkaL4I.6AGSCcG/87k.7RaIChjGeTiOfoWMife"], ["updated_at", "2014-08-26 12:17:21.654826"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:21.656547"], ["customer_id", 30], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:21.656547"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:21.658291"], ["customer_id", 30], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:21.658291"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 94ms (ActiveRecord: 1.9ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:21 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 63 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (17.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 49ms (Views: 46.6ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 30]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 30]]
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:21.815695"], ["email", "member2@example.jp"], ["email_for_index", "member2@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$P6qElfMD3BZAi.uLuqZiyewWzZLvM2vDQdE3TleNcKmGdaH6y/LD6"], ["updated_at", "2014-08-26 12:17:21.815695"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:21.817415"], ["customer_id", 31], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:21.817415"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:21.819283"], ["customer_id", 31], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:21.819283"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:21.896334"], ["email", "member17@example.com"], ["email_for_index", "member17@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$SZkdpbgGmtuo2d1/o0SCa.hj7fa0JogS1GfLs2f9SfW.h3Gg.DoxS"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:21.896334"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:21 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 25ms (Views: 24.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:21 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:22.007885"], ["staff_member_id", 64], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 0.5ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.9ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 64 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 33ms (Views: 25.9ms | ActiveRecord: 0.9ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 64 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.6ms)
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 49.8ms | ActiveRecord: 1.2ms)
Started GET "/customers/31/edit" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"31"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 64 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 31]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 31]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 31]]
  [1m[36mWorkAddress Load (0.5ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 31]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 55]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 56]]
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.4ms)
  Rendered staff/customers/_form.html.erb (36.8ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 128ms (Views: 104.3ms | ActiveRecord: 1.9ms)
Started PATCH "/customers/31" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"31"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 64 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 31]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 31]]
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 31]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 31]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 55]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 56]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'test@example.jp' AND "customers"."id" != 31) LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE "customers" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "customers"."id" = 31[0m  [["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["updated_at", "2014-08-26 12:17:22.286586"]]
  [1m[35mSQL (0.2ms)[0m  UPDATE "addresses" SET "postal_code" = $1, "updated_at" = $2 WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."id" = 55  [["postal_code", "9999999"], ["updated_at", "2014-08-26 12:17:22.288643"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 26ms (ActiveRecord: 3.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 64 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.8ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 61ms (Views: 57.7ms | ActiveRecord: 1.0ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 31]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 31]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 31]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:22.443182"], ["email", "member3@example.jp"], ["email_for_index", "member3@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$xDZB93uZ6QLRv8ks/ckTmudcj8461AKvJ46xqommeRuhJL/Ws0vHS"], ["updated_at", "2014-08-26 12:17:22.443182"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:22.445832"], ["customer_id", 32], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:22.445832"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:22.448724"], ["customer_id", 32], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:22.448724"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:22.536807"], ["email", "member18@example.com"], ["email_for_index", "member18@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$GPDwxtZuHl3Jq8GbUNGlvOmZ1FVEM7yO60gUCzrKLU9HipwbyOsx."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:22.536807"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 31ms (Views: 31.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:22.653358"], ["staff_member_id", 65], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 65 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 65 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (22.5ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 61ms (Views: 58.0ms | ActiveRecord: 1.0ms)
Started GET "/customers/32/edit" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"32"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 65 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 32]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 32]]
  [1m[36mHomeAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 32]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 32]]
  [1m[36m (1.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 57]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 58]]
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.9ms)
  Rendered staff/customers/_phone_fields.html.erb (2.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (16.0ms)
  Rendered staff/customers/_form.html.erb (40.2ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 82ms (Views: 69.5ms | ActiveRecord: 2.5ms)
Started PATCH "/customers/32" for 127.0.0.1 at 2014-08-26 12:17:22 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"32"}
  [1m[36mStaffMember Load (0.0ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 65 LIMIT 1[0m
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 32]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 32]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 32]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 32]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 57]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 58]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member3@example.jp' AND "customers"."id" != 32) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (11.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.5ms)
  Rendered staff/customers/_form.html.erb (37.3ms)
  Rendered staff/shared/_header.html.erb (1.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 440ms (Views: 63.5ms | ActiveRecord: 2.2ms)
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:23.397698"], ["email", "member4@example.jp"], ["email_for_index", "member4@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$LC2WGhieJpkfXge6/RZB/.sJtDTq8CZ4DbzWi2ldXlAqYXjJO.PUC"], ["updated_at", "2014-08-26 12:17:23.397698"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:23.399052"], ["customer_id", 33], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:23.399052"]]
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:23.400868"], ["customer_id", 33], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:23.400868"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:23.496182"], ["email", "member19@example.com"], ["email_for_index", "member19@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ucciCfBsHkmkfs8U6PNA.uCrSbYptYGOzhmG13Xf0BYYOnlWcC3am"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:23.496182"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 27ms (Views: 26.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:23.610647"], ["staff_member_id", 66], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 66 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 66 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (25.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 66ms (Views: 63.3ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 66 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_customer_fields.html.erb (11.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (21.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.9ms)
  Rendered staff/customers/_form.html.erb (47.1ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 78ms (Views: 71.3ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 66 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (1.6ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:23.939978"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$Z0HbJE9OA7GKwxYK2CroRuKig..NlMNltvv0lDAx3JTX8qXu12yhK"], ["updated_at", "2014-08-26 12:17:23.939978"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 99ms (ActiveRecord: 3.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:23 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 66 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.2ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.5ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 62ms (Views: 58.8ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 34]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 34]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:24.096938"], ["email", "member5@example.jp"], ["email_for_index", "member5@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$YLTqW9wrBtL1o5oGI5Tk7.zTQHyN19pRe9vJTnstC2Wyhy55SfXMC"], ["updated_at", "2014-08-26 12:17:24.096938"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:24.098626"], ["customer_id", 35], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:24.098626"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:24.100674"], ["customer_id", 35], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:24.100674"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.5ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:24.186298"], ["email", "member20@example.com"], ["email_for_index", "member20@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$JP7b6Lw9q0DEw9tktF.wh.C7t/g6eQEJmU2a6Ex/REYptDdAzKokG"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:24.186298"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 24ms (Views: 23.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:24.303827"], ["staff_member_id", 67], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 82ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 67 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 24.7ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 62]]
  [1m[35mSQL (0.4ms)[0m  DELETE FROM "addresses" WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."id" = $1  [["id", 62]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 67 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (21.7ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 66ms (Views: 62.4ms | ActiveRecord: 1.2ms)
Started GET "/customers/35/edit" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"35"}
  [1m[36mStaffMember Load (0.9ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 67 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 35]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 35]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 35]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 35]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 61]]
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (12.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (18.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.0ms)
  Rendered staff/customers/_form.html.erb (46.0ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 90ms (Views: 79.2ms | ActiveRecord: 1.8ms)
Started PATCH "/customers/35" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"35"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 67 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 35]]
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 35]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 35]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 35]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 61]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member5@example.jp' AND "customers"."id" != 35) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テストテスト"], ["created_at", "2014-08-26 12:17:24.543673"], ["customer_id", 35], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:24.543673"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 20ms (ActiveRecord: 2.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.9ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 67 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (28.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 70ms (Views: 65.3ms | ActiveRecord: 1.6ms)
  [1m[35mCustomer Load (7.3ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 35]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 35]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:24.711183"], ["email", "member6@example.jp"], ["email_for_index", "member6@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$5URTksr1tCoDChtPjJHiC.i5kZ5I0CZNf6XR1FpWlA.kWhEWPYtXe"], ["updated_at", "2014-08-26 12:17:24.711183"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:24.713550"], ["customer_id", 36], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:24.713550"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:24.715013"], ["customer_id", 36], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:24.715013"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:24.791227"], ["email", "member21@example.com"], ["email_for_index", "member21@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Prw5V1fM5.MnsG1GpTyI3ulzS9Rq0CPAZKBe2iLbBR32arwmRWg2."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:24.791227"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 44ms (Views: 43.2ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:24.924084"], ["staff_member_id", 68], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 81ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 68 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 36ms (Views: 33.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:24 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 68 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (20.7ms)
  [1m[35m (0.9ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 56ms (Views: 51.8ms | ActiveRecord: 1.5ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 68 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_customer_fields.html.erb (14.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (13.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.4ms)
  Rendered staff/customers/_form.html.erb (43.0ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 83ms (Views: 76.5ms | ActiveRecord: 0.4ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 68 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.9ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:25.239508"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$LIpvgQCGoyGkl2kr4hSaaeveJogB8hjyY.stuoAHSi0hWbUdu2oxa"], ["updated_at", "2014-08-26 12:17:25.239508"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:25.241001"], ["customer_id", 37], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:25.241001"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 86ms (ActiveRecord: 1.9ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 68 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (16.7ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (2.2ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 65ms (Views: 62.6ms | ActiveRecord: 0.8ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 37]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 37]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:25.400877"], ["email", "member7@example.jp"], ["email_for_index", "member7@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$uehaWY3s1APBM6k7Mmh.3upnCytTR1bEtzA4wfXNar6e03Zc.bqfq"], ["updated_at", "2014-08-26 12:17:25.400877"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:25.402667"], ["customer_id", 38], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:25.402667"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:25.403990"], ["customer_id", 38], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:25.403990"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:25.482624"], ["email", "member22@example.com"], ["email_for_index", "member22@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$CX6p1e9U7N/vGgAOWhL24e3W0znx5yXLt2qsoza4Y4gRqqLKMZkum"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:25.482624"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 36ms (Views: 35.9ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:25.611312"], ["staff_member_id", 69], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 84ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 69 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 27ms (Views: 24.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 69 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.0ms)
  [1m[36m (0.0ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 51ms (Views: 48.9ms | ActiveRecord: 0.5ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 69 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (72.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (85.5ms)
  Rendered staff/customers/_form.html.erb (111.3ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 148ms (Views: 142.7ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 69 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:25.988980"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$Yub/zOdilJOJQp6CLqnKXusZUxPAhq5y3.M670LhA2SpfHZfPJbFe"], ["updated_at", "2014-08-26 12:17:25.988980"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:25.990952"], ["customer_id", 39], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:25.990952"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 88ms (ActiveRecord: 1.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:25 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 69 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (21.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 64ms (Views: 60.7ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 39]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 39]]
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:26.148116"], ["email", "member8@example.jp"], ["email_for_index", "member8@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$bpUEB/htl1qhoIlxQTvileOy8PUr3qKXtSECtlHvW/einyGHOL9d."], ["updated_at", "2014-08-26 12:17:26.148116"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:26.149666"], ["customer_id", 40], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:26.149666"]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:26.150934"], ["customer_id", 40], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:26.150934"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:26.233284"], ["email", "member23@example.com"], ["email_for_index", "member23@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$1dym6chvN8NXH3PyKvZY2.xXfnWEWv3q4abiHhpg0/h2kdvW3nMCm"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:26.233284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 40ms (Views: 39.0ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:26.361574"], ["staff_member_id", 70], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 70 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 26.8ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 70 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 56ms (Views: 52.7ms | ActiveRecord: 0.8ms)
Started GET "/customers/40/edit" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"40"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 70 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 40]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 40]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 40]]
  [1m[35mWorkAddress Load (0.6ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 40]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 70]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 71]]
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_customer_fields.html.erb (13.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (10.4ms)
  Rendered staff/customers/_form.html.erb (37.3ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 78ms (Views: 62.0ms | ActiveRecord: 2.1ms)
Started PATCH "/customers/40" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"40"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 70 LIMIT 1[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 40]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 40]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 40]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 40]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 70]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 71]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member8@example.jp' AND "customers"."id" != 40) LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "phones" ("created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["created_at", "2014-08-26 12:17:26.579897"], ["customer_id", 40], ["last_four_digits", "9999"], ["number", "090-9999-9999"], ["number_for_index", "09099999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:26.579897"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 43ms (ActiveRecord: 2.8ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 70 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (65.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 99ms (Views: 95.7ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.1ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 40]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 40]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  ORDER BY "phones"."id" ASC[0m  [["customer_id", 40]]
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:26.803294"], ["email", "member9@example.jp"], ["email_for_index", "member9@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$sEfeZqnkcjz0WqLlbEwE1eOyEie/Y5PMkp/2zJWZbqKEftyDSuvEy"], ["updated_at", "2014-08-26 12:17:26.803294"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:26.805316"], ["customer_id", 41], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:26.805316"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:26.807014"], ["customer_id", 41], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:26.807014"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:26.885430"], ["email", "member24@example.com"], ["email_for_index", "member24@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$1UY.Amo3oiHUBf.9Oq0wEujeys2BGABZB9QDKmY2K6FoUBllI9IeC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:26.885430"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 25ms (Views: 24.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:26 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:27.015617"], ["staff_member_id", 71], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 96ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 71 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 27ms (Views: 23.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 71 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (25.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 59ms (Views: 56.5ms | ActiveRecord: 0.9ms)
Started GET "/customers/41/edit" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"41"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 71 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 41]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 41]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 41]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 41]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 72]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 73]]
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_customer_fields.html.erb (9.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_home_address_fields.html.erb (8.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_form.html.erb (32.5ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 81ms (Views: 69.3ms | ActiveRecord: 1.2ms)
Started PATCH "/customers/41" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"41"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 71 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 41]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 41]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 41]]
  [1m[36mWorkAddress Load (0.0ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 41]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 72]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 73]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member9@example.jp' AND "customers"."id" != 41) LIMIT 1[0m
  [1m[35mAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1  [["id", 72]]
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 41]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["address_id", 72], ["created_at", "2014-08-26 12:17:27.230816"], ["customer_id", 41], ["last_four_digits", "9999"], ["number", "03-9999-9999"], ["number_for_index", "0399999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:27.230816"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 41ms (ActiveRecord: 2.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 71 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (15.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 53ms (Views: 49.4ms | ActiveRecord: 1.0ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 41]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 41]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 72]]
  [1m[35mPhone Load (0.4ms)[0m  SELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC  [["address_id", 72]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (1.8ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:27.405458"], ["email", "member10@example.jp"], ["email_for_index", "member10@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$.rs/P0D6YVYDRCnLZXAEHurvigao/pkArAPCwfeg2pJIHjYAGJ.7e"], ["updated_at", "2014-08-26 12:17:27.405458"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:27.407425"], ["customer_id", 42], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:27.407425"]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:27.409332"], ["customer_id", 42], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:27.409332"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:27.493994"], ["email", "member25@example.com"], ["email_for_index", "member25@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$5j4uFK1VYqU8oMmFFyUKouFixLzFrQoG7C/i4yu7xjPv.AeOdvRSC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:27.493994"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 32ms (Views: 32.0ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:27.610563"], ["staff_member_id", 72], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 72 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 85ms (Views: 82.7ms | ActiveRecord: 0.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 72 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (21.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 51ms (Views: 47.3ms | ActiveRecord: 1.1ms)
Started GET "/customers/42/edit" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"42"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 72 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 42]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 42]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 42]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 42]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 74]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 75]]
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (11.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.9ms)
  Rendered staff/customers/_form.html.erb (35.8ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 76ms (Views: 64.4ms | ActiveRecord: 1.5ms)
Started PATCH "/customers/42" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"42"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 72 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 42]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 42]]
  [1m[36mHomeAddress Load (0.5ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 42]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 42]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 74]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 75]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member10@example.jp' AND "customers"."id" != 42) LIMIT 1
  [1m[36mAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1[0m  [["id", 75]]
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 42]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["address_id", 75], ["created_at", "2014-08-26 12:17:27.873030"], ["customer_id", 42], ["last_four_digits", "1111"], ["number", "03-9999-1111"], ["number_for_index", "0399991111"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:27.873030"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 25ms (ActiveRecord: 2.8ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:27 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 72 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 56ms (Views: 52.9ms | ActiveRecord: 1.1ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 42]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 42]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 75]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 75]]
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:28.207245"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$cLo3n.eUnYSYrQ/0pxE95eV5R/PHrAlhvaXK19gHn4kAq70hM3IgO"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.207245"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:28.288774"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$V2DCRWKgSoX5OtDQ9Z0FZONXzFeN5TXJ.8uvItVYlvdwUwQ58kq7q"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.288774"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (6.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (1.7ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:28.382390"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wx6WO9P/rVPHBbtmbRBTfeL3CyDRVCyh3ICMHJ7ROXFAg/9TiEMeW"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.382390"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:28.466458"], ["email", "member26@example.com"], ["email_for_index", "member26@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$O8T0cmFtBfpXteasblocKeK1XfLbNHjRMY2ZL8RjnoGEFKB44xQ/q"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.466458"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:28.548389"], ["email", "member27@example.com"], ["email_for_index", "member27@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$pDcqNAcae0GbETbNT6S3yehgnxjYWcdydOmTgtF0GrTO5jY.xCSnS"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.548389"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member29@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:28.893369"], ["email", "member30@example.com"], ["email_for_index", "member30@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$qNNnd9/xGJEuH0mmnXTHW.M79dUmxLHPpFi5pZf44SlGu7QhMEecy"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:28.893369"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member31@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.8ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin1@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:36.501681"], ["email", "admin1@example.com"], ["email_for_index", "admin1@example.com"], ["hashed_password", "$2a$10$D/f6kN7l86E9bzCuF87G/.umcEXEEgAJ09MwtSftPS5kjiqHR8ym."], ["updated_at", "2014-08-26 12:17:36.501681"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 22 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:36.624821"], ["email", "member1@example.com"], ["email_for_index", "member1@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$WjcPd/mA5JzqCS1YzpDYyOtD8Jtj7Y487oc2bja2wY4LJ8GnKsu4G"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:36.624821"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 112ms (ActiveRecord: 2.5ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.7ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (1.2ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:36.712398"], ["email", "admin2@example.com"], ["email_for_index", "admin2@example.com"], ["hashed_password", "$2a$10$9XgsI52V3/7HbxeE1sM.n.HFn5DBvr1cYFkgmkKFZWphTk4GFlveG"], ["updated_at", "2014-08-26 12:17:36.712398"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 23 LIMIT 1
Completed 400 Bad Request in 1ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:36.810431"], ["email", "admin3@example.com"], ["email_for_index", "admin3@example.com"], ["hashed_password", "$2a$10$1McUWQ4Aasd7JDuulLtdK..QBdYUYu980YiwvostqGO17SCBlg6/."], ["updated_at", "2014-08-26 12:17:36.810431"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:36.889568"], ["email", "member3@example.com"], ["email_for_index", "member3@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$p7mA6BKl2bGs9kVvwd3J9uVefwjF6wMu/ojcZoKiNNzWrZLFIpgI."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:36.889568"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}, "id"=>"80"}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 24 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1  [["id", 80]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member2@example.com' AND "staff_members"."id" != 80) LIMIT 1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "hashed_password" = $3, "suspended" = $4, "updated_at" = $5 WHERE "staff_members"."id" = 80[0m  [["email", "member2@example.com"], ["email_for_index", "member2@example.com"], ["hashed_password", "$2a$10$PJl5AXpI6AJ.WNF5hDMM9O2hc.h4Gyjm00OUoUEy9UpC5CGqTTR8S"], ["suspended", "t"], ["updated_at", "2014-08-26 12:17:36.984586"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 95ms (ActiveRecord: 1.7ms)
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 80]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.081124"], ["email", "admin4@example.com"], ["email_for_index", "admin4@example.com"], ["hashed_password", "$2a$10$/lEmQB2KJ9MfmdLAcNOTjeWRa7WqIW5DJk80UuyKKghzTlqm1BnDu"], ["updated_at", "2014-08-26 12:17:37.081124"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.166579"], ["email", "member5@example.com"], ["email_for_index", "member5@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$9zkzxx7EgSTo4ql.3P3NxOpCVup8iyT4q0r8QB6RDnML4VQVZDNA."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:37.166579"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"81"}
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 25 LIMIT 1
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 81]]
Unpermitted parameters: hashed_password
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member4@example.com' AND "staff_members"."id" != 81) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 81  [["email", "member4@example.com"], ["email_for_index", "member4@example.com"], ["updated_at", "2014-08-26 12:17:37.175969"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 7ms (ActiveRecord: 1.2ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.271544"], ["email", "admin5@example.com"], ["email_for_index", "admin5@example.com"], ["hashed_password", "$2a$10$U/iZ.jnUfQAgBxdKUCyMouLuKBJi7oEh14znJtPwUhq33R2uEY1f2"], ["updated_at", "2014-08-26 12:17:37.271544"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 26 LIMIT 1
Completed 200 OK in 59ms (Views: 57.3ms | ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin6@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:37.415851"], ["email", "admin6@example.com"], ["email_for_index", "admin6@example.com"], ["hashed_password", "$2a$10$7ZVCh2Pqizqv.J2V8Ee8c.4VKreCZEMrVhKKaLDJuikuXM8pkh2lG"], ["updated_at", "2014-08-26 12:17:37.415851"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "admin_members" SET "suspended" = 't' WHERE "admin_members"."id" = 27[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 27 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "admin_members"  WHERE "admin_members"."email_for_index" = 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "admin_members" ("created_at", "email", "email_for_index", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:37.517606"], ["email", "admin7@example.com"], ["email_for_index", "admin7@example.com"], ["hashed_password", "$2a$10$.IlkcvKcpZkSSFcxXr2h3urvEsv93PcKmRXOwL1qt7SXl8sVhw2dG"], ["updated_at", "2014-08-26 12:17:37.517606"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  "admin_members".* FROM "admin_members"  WHERE "admin_members"."id" = 28 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.611312"], ["email", "member6@example.com"], ["email_for_index", "member6@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$5tRoqRxSxsUCi3U1Sqpuuus8cRb5UDqZmvoIdRpOJ4TD.sFnz.dfu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:37.611312"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"82", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 82 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'test@example.com' AND "staff_members"."id" != 82) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 82[0m  [["email", "test@example.com"], ["email_for_index", "test@example.com"], ["updated_at", "2014-08-26 12:17:37.620696"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.9ms)
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = $1 LIMIT 1[0m  [["id", 82]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.720580"], ["email", "member8@example.com"], ["email_for_index", "member8@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$wWwCy6b0n3rmF5Xh9aLGq.Wt.DaPPhhuzhuqxJCvyVK2boToVoF42"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:37.720580"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"83"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 83 LIMIT 1
Completed 400 Bad Request in 2ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:37.809815"], ["email", "member9@example.com"], ["email_for_index", "member9@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$YKHAHDA60Sxr71O6UnWsS.Ie8TFVWQPlsbHBlohWzanAIl0NKduAa"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:37.809815"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"84", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>"2014-08-27", "suspended"=>false}}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 84 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member10@example.com' AND "staff_members"."id" != 84) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 84  [["email", "member10@example.com"], ["email_for_index", "member10@example.com"], ["updated_at", "2014-08-26 12:17:37.818505"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:37.905715"], ["email", "member11@example.com"], ["email_for_index", "member11@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$tIkA2i5FEENPpuReKJjMAekF0ELKnu3kNv9mLCFDBWid3ItaG5yhy"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:37.905715"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"85", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-25", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 85 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE ("staff_members"."email_for_index" = 'member12@example.com' AND "staff_members"."id" != 85) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "staff_members" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "staff_members"."id" = 85[0m  [["email", "member12@example.com"], ["email_for_index", "member12@example.com"], ["updated_at", "2014-08-26 12:17:37.914587"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:38.017032"], ["email", "member13@example.com"], ["email_for_index", "member13@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$iAn.6Qs4PQtgU0mNrxgNnuX3VUg6YOb2RPryCEji6WGVCwdiE6R8O"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:38.017032"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 86 LIMIT 1[0m
Completed 200 OK in 38ms (Views: 36.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:38.141874"], ["email", "member14@example.com"], ["email_for_index", "member14@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$SY4UXhpkeRtAJlOONMJaqeRIxNlP8..bLSNsQAPFOqp/wUUtNF2NS"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:38.141874"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  UPDATE "staff_members" SET "suspended" = 't' WHERE "staff_members"."id" = 87
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.7ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 87 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:38.240207"], ["email", "member15@example.com"], ["email_for_index", "member15@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$WVjf7jFXISXDb/AjfRG6Z.JOhGDIXWUJB.D.7AX2cBbzue3hu15Fe"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:38.240207"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 88 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.1ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member1@example.jp' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:38.460949"], ["email", "member1@example.jp"], ["email_for_index", "member1@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Nqa31PjQro4B3R0rIgkuJun3s92QmeUfyvSdIyn6AIXiXyPjTdYTK"], ["updated_at", "2014-08-26 12:17:38.460949"]]
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:38.463274"], ["customer_id", 43], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:38.463274"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:38.465437"], ["customer_id", 43], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:38.465437"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:38.546700"], ["email", "member16@example.com"], ["email_for_index", "member16@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Wiga7xyQZImPkgvOU8lRbeuQ92dJLpu6MQt6tfHjtDxDiUbhIH2DG"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:38.546700"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:38 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.3ms)
Completed 200 OK in 213ms (Views: 172.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:38 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:38.937774"], ["staff_member_id", 89], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 134ms (ActiveRecord: 2.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:38 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 89 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 35ms (Views: 32.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:38 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.7ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 89 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (73.1ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 225ms (Views: 213.3ms | ActiveRecord: 1.4ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:39 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 89 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (7.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (74.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (30.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_work_address_fields.html.erb (14.4ms)
  Rendered staff/customers/_form.html.erb (191.6ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 336ms (Views: 283.2ms | ActiveRecord: 1.2ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:39 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 89 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:39.725308"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$jl7j4LwU/oqBQqzgXPdG6evkEaTHDGXj.G/qW3U.2318rrymeFlo."], ["updated_at", "2014-08-26 12:17:39.725308"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:39.727600"], ["customer_id", 44], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:39.727600"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:39.729721"], ["customer_id", 44], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:39.729721"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 94ms (ActiveRecord: 2.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:39 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 89 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (26.6ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (1.1ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 64ms (Views: 60.1ms | ActiveRecord: 1.6ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 44]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 44]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:39.888139"], ["email", "member2@example.jp"], ["email_for_index", "member2@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$N9wmM.IcBQp8uZbWnaw58u4JkXGsIJZF/FhrerPep0PD28zJyu6e6"], ["updated_at", "2014-08-26 12:17:39.888139"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:39.890596"], ["customer_id", 45], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:39.890596"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:39.892678"], ["customer_id", 45], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:39.892678"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:39.969029"], ["email", "member17@example.com"], ["email_for_index", "member17@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$fo4maL3Wy5AktiaK3jr2o.ofRqHBCtrBaU0yX5/dxVKztQeu2qmuy"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:39.969029"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:39 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 34ms (Views: 34.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:40.090002"], ["staff_member_id", 90], ["type", "logged_in"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 90 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (1.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 30ms (Views: 28.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 90 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (61.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 102ms (Views: 98.5ms | ActiveRecord: 0.9ms)
Started GET "/customers/45/edit" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"45"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 90 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 45]]
  [1m[36m (0.9ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 45]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 45]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 45]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 80]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 81]]
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (11.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (12.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.7ms)
  Rendered staff/customers/_form.html.erb (39.8ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 96ms (Views: 83.5ms | ActiveRecord: 2.2ms)
Started PATCH "/customers/45" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"45"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 90 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 45]]
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 45]]
  [1m[36mHomeAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 45]]
  [1m[35mWorkAddress Load (0.7ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 45]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 80]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 81]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.5ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'test@example.jp' AND "customers"."id" != 45) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "customers" SET "email" = $1, "email_for_index" = $2, "updated_at" = $3 WHERE "customers"."id" = 45[0m  [["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["updated_at", "2014-08-26 12:17:40.380267"]]
  [1m[35mSQL (0.4ms)[0m  UPDATE "addresses" SET "postal_code" = $1, "updated_at" = $2 WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."id" = 80  [["postal_code", "9999999"], ["updated_at", "2014-08-26 12:17:40.382136"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 31ms (ActiveRecord: 4.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 90 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.2ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 60ms (Views: 56.6ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 45]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 45]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 45]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:40.538201"], ["email", "member3@example.jp"], ["email_for_index", "member3@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$PTMHZIzOTdSuBN3AJTEzDuzG4JXS1swQz8Xq.7TRnu4nn.Q/u9nWu"], ["updated_at", "2014-08-26 12:17:40.538201"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:40.539756"], ["customer_id", 46], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:40.539756"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:40.541977"], ["customer_id", 46], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:40.541977"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:40.619927"], ["email", "member18@example.com"], ["email_for_index", "member18@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$kAF5XXKQgXQEA..mMH7HDe5hWefy/zRplo4UPxJl5CA8VSltljZae"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:40.619927"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 38ms (Views: 37.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (1.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member18@example.com' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:40.744592"], ["staff_member_id", 91], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 1.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 91 LIMIT 1
  Rendered staff/shared/_header.html.erb (1.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 37ms (Views: 34.3ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 91 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (21.8ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 57ms (Views: 54.2ms | ActiveRecord: 0.9ms)
Started GET "/customers/46/edit" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"46"}
  [1m[35mStaffMember Load (0.7ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 91 LIMIT 1
  [1m[36mCustomer Load (0.7ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 46]]
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 46]]
  [1m[36mHomeAddress Load (0.4ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 46]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 46]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 82]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 83]]
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (11.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.3ms)
  Rendered staff/customers/_form.html.erb (47.3ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 89ms (Views: 76.3ms | ActiveRecord: 2.7ms)
Started PATCH "/customers/46" for 127.0.0.1 at 2014-08-26 12:17:40 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"46"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 91 LIMIT 1[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 46]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 46]]
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 46]]
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 46]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 82]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 83]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member3@example.jp' AND "customers"."id" != 46) LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (2.0ms)
  Rendered staff/customers/_customer_fields.html.erb (14.6ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_home_address_fields.html.erb (15.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.7ms)
  Rendered staff/customers/_form.html.erb (43.8ms)
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 450ms (Views: 79.6ms | ActiveRecord: 2.7ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:41.511603"], ["email", "member4@example.jp"], ["email_for_index", "member4@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ReNk4bcQl03skL.5MK3zUeBTI7qZn9atB4gRiS6TofnQgxhH4FTEG"], ["updated_at", "2014-08-26 12:17:41.511603"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:41.514093"], ["customer_id", 47], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:41.514093"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:41.515688"], ["customer_id", 47], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:41.515688"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:41.610443"], ["email", "member19@example.com"], ["email_for_index", "member19@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$BUPnOQ7QGv6q9dhwsAiBzONPB7q9X1mffDG93ZqqUTm6NGWzDQahu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:41.610443"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 28.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:41.730610"], ["staff_member_id", 92], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 81ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 92 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 29ms (Views: 26.4ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.7ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 92 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 69ms (Views: 58.8ms | ActiveRecord: 1.3ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 92 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_customer_fields.html.erb (13.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.3ms)
  Rendered staff/customers/_form.html.erb (38.6ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 74ms (Views: 68.0ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:41 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 92 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:42.061271"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$JFlh/LMmhCdxniB.MnSJ8O7WXdg3VMkRcBb8olCi7NIkY/WYF0eIq"], ["updated_at", "2014-08-26 12:17:42.061271"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 98ms (ActiveRecord: 1.1ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 92 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (24.5ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 61ms (Views: 57.5ms | ActiveRecord: 1.0ms)
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 48]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 48]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:42.216218"], ["email", "member5@example.jp"], ["email_for_index", "member5@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$3Dp4Kg2XByVbeK12UUvCKudIbtzsQj58waZx.LeMQWZDJoqAdJej."], ["updated_at", "2014-08-26 12:17:42.216218"]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:42.218360"], ["customer_id", 49], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:42.218360"]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:42.220161"], ["customer_id", 49], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:42.220161"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:42.310450"], ["email", "member20@example.com"], ["email_for_index", "member20@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$iuDm6DOF.8sZUqIru7fqHezqWtIKZsQr7oAUgWp.xnw5vbF01D//i"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:42.310450"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 28ms (Views: 27.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:42.425354"], ["staff_member_id", 93], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 93 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 31ms (Views: 28.3ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 87]]
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "addresses" WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."id" = $1  [["id", 87]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 93 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.2ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 74ms (Views: 71.2ms | ActiveRecord: 0.9ms)
Started GET "/customers/49/edit" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"49"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 93 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 49]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 49]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 49]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 49]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 86]]
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.0ms)
  Rendered staff/customers/_form.html.erb (38.4ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 84ms (Views: 65.4ms | ActiveRecord: 1.3ms)
Started PATCH "/customers/49" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"49"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 93 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 49]]
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 49]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 49]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 49]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 86]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member5@example.jp' AND "customers"."id" != 49) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テストテスト"], ["created_at", "2014-08-26 12:17:42.669421"], ["customer_id", 49], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:42.669421"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 22ms (ActiveRecord: 2.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 93 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (22.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 68ms (Views: 63.9ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 49]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 49]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:42.831143"], ["email", "member6@example.jp"], ["email_for_index", "member6@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$qsm7hAZ.LLevIMQWKLyuMedme5Sf7uQxekBZHorOpFnYCusBo/DNK"], ["updated_at", "2014-08-26 12:17:42.831143"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:42.832524"], ["customer_id", 50], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:42.832524"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:42.834088"], ["customer_id", 50], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:42.834088"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:42.911506"], ["email", "member21@example.com"], ["email_for_index", "member21@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$M.hMuh9hkp.Ct9GVHUV.1Olr6U/FeGBQ/qk7xDkH11Bhmrn29hSpe"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:42.911506"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 40ms (Views: 39.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:42 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member21@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:43.036573"], ["staff_member_id", 94], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 94 LIMIT 1
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 26.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 94 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (22.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 63ms (Views: 59.8ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 94 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (16.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (12.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.2ms)
  Rendered staff/customers/_form.html.erb (43.9ms)
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 94ms (Views: 72.0ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 94 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:43.373136"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$cfNkeU5XfZMs8KungKn7TOqqX0Pun1Eszu7eqUjLjnjCp1DbR.QpW"], ["updated_at", "2014-08-26 12:17:43.373136"]]
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "千代田1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:43.375823"], ["customer_id", 51], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:43.375823"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 94ms (ActiveRecord: 2.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.8ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 94 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (29.8ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.7ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 68ms (Views: 63.2ms | ActiveRecord: 1.9ms)
  [1m[35mCustomer Load (1.0ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 51]]
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 51]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:43.539081"], ["email", "member7@example.jp"], ["email_for_index", "member7@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$DHzzd5DTwnUnq3EF83MKi.VNuBsstWazCYalUOwq2rj8ZxucIucCG"], ["updated_at", "2014-08-26 12:17:43.539081"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:43.540554"], ["customer_id", 52], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:43.540554"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:43.542077"], ["customer_id", 52], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:43.542077"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:43.619197"], ["email", "member22@example.com"], ["email_for_index", "member22@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$valUjDuVSEJr63m0Xh8CkuRG.Qc8e5pp83KDeRwx3XbkbpWpZoMzm"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:43.619197"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 42ms (Views: 41.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:43.748305"], ["staff_member_id", 95], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 95 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 35ms (Views: 33.1ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 95 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (22.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 72ms (Views: 68.9ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.7ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 95 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (10.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.3ms)
  Rendered staff/customers/_form.html.erb (31.5ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 72ms (Views: 63.6ms | ActiveRecord: 0.7ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-26 12:17:43 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 95 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:44.079567"], ["email", "test@example.jp"], ["email_for_index", "test@example.jp"], ["family_name", "試験"], ["family_name_kana", "シケン"], ["gender", "female"], ["given_name", "花子"], ["given_name_kana", "ハナコ"], ["hashed_password", "$2a$10$K3f3Mp17KcsTQlVvT3NVTeD1MkFNXWpgr4cDf30sGd5tP6jwEtkS."], ["updated_at", "2014-08-26 12:17:44.079567"]]
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["address1", ""], ["address2", ""], ["city", ""], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:44.082869"], ["customer_id", 53], ["postal_code", ""], ["prefecture", ""], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:44.082869"]]
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 96ms (ActiveRecord: 1.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 95 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (16.4ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 51ms (Views: 47.7ms | ActiveRecord: 1.2ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."id" DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 53]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 53]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:44.235104"], ["email", "member8@example.jp"], ["email_for_index", "member8@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$Hnc39rBB/7KBUA9PXnp2pOT6wYYS4l4L6agERDNdEQrFWEAMCQehS"], ["updated_at", "2014-08-26 12:17:44.235104"]]
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:44.236855"], ["customer_id", 54], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:44.236855"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:44.239443"], ["customer_id", 54], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:44.239443"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:44.321221"], ["email", "member23@example.com"], ["email_for_index", "member23@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$1dPY5XJRAa9ZKg97jIVCxOYFbyqmKgzqTm2QukekvWZzZNwxJNRRS"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:44.321221"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 28.2ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member23@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:44.437266"], ["staff_member_id", 96], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 96 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 25.2ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 96 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (17.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.9ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 50.9ms | ActiveRecord: 1.5ms)
Started GET "/customers/54/edit" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"54"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 96 LIMIT 1
  [1m[36mCustomer Load (0.1ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 54]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 54]]
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 54]]
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 54]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 95]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 96]]
  Rendered staff/customers/_phone_fields.html.erb (60.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_customer_fields.html.erb (80.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.3ms)
  Rendered staff/customers/_form.html.erb (105.7ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 145ms (Views: 130.1ms | ActiveRecord: 1.3ms)
Started PATCH "/customers/54" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"54"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 96 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 54]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 54]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 54]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 54]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 95]]
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 96]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member8@example.jp' AND "customers"."id" != 54) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "phones" ("created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"  [["created_at", "2014-08-26 12:17:44.715805"], ["customer_id", 54], ["last_four_digits", "9999"], ["number", "090-9999-9999"], ["number_for_index", "09099999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:44.715805"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 34ms (ActiveRecord: 2.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 96 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (17.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 51.4ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 54]]
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 54]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  ORDER BY "phones"."id" ASC[0m  [["customer_id", 54]]
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:44.891893"], ["email", "member9@example.jp"], ["email_for_index", "member9@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$bWrpsyolcIG1hDL5vouN0ejttxuvOV9d4YzWvqpE5WSbR0wGbPnsG"], ["updated_at", "2014-08-26 12:17:44.891893"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:44.894153"], ["customer_id", 55], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:44.894153"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:44.895756"], ["customer_id", 55], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:44.895756"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:44.972071"], ["email", "member24@example.com"], ["email_for_index", "member24@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ZaODZMvgkBjQeDRg1uVx3uoBrblpqypOVbrY64fq7verwTxPx82/."], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:44.972071"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:44 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 24ms (Views: 23.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member24@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-08-26 12:17:45.091449"], ["staff_member_id", 97], ["type", "logged_in"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 88ms (ActiveRecord: 1.2ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 97 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 26ms (Views: 23.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 97 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (16.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 50ms (Views: 45.5ms | ActiveRecord: 1.1ms)
Started GET "/customers/55/edit" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"55"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 97 LIMIT 1
  [1m[36mCustomer Load (0.1ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 55]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 55]]
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 55]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 55]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 97]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 98]]
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (10.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (55.5ms)
  Rendered staff/customers/_form.html.erb (75.7ms)
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 130ms (Views: 119.6ms | ActiveRecord: 1.1ms)
Started PATCH "/customers/55" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"55"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 97 LIMIT 1[0m
  [1m[35mCustomer Load (0.1ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 55]]
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 55]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 55]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 55]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 97]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 98]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member9@example.jp' AND "customers"."id" != 55) LIMIT 1[0m
  [1m[35mAddress Load (0.3ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1  [["id", 97]]
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 55]]
  [1m[35mSQL (1.6ms)[0m  INSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["address_id", 97], ["created_at", "2014-08-26 12:17:45.348430"], ["customer_id", 55], ["last_four_digits", "9999"], ["number", "03-9999-9999"], ["number_for_index", "0399999999"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:45.348430"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 45ms (ActiveRecord: 3.8ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.6ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 97 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.7ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 56ms (Views: 52.5ms | ActiveRecord: 1.4ms)
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 55]]
  [1m[35mHomeAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 55]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 97]]
  [1m[35mPhone Load (0.2ms)[0m  SELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC  [["address_id", 97]]
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (2.5ms)[0m  SELECT  1 AS one FROM "customers"  WHERE "customers"."email_for_index" = 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "customers" ("birth_mday", "birth_month", "birth_year", "birthday", "created_at", "email", "email_for_index", "family_name", "family_name_kana", "gender", "given_name", "given_name_kana", "hashed_password", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14) RETURNING "id"[0m  [["birth_mday", 1], ["birth_month", 1], ["birth_year", 1970], ["birthday", "1970-01-01"], ["created_at", "2014-08-26 12:17:45.533719"], ["email", "member10@example.jp"], ["email_for_index", "member10@example.jp"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["gender", "male"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$AoOG9.YUK/z6FMhIv56RMuHjeVxbrmvvQzs1thceABCtMBf02upFS"], ["updated_at", "2014-08-26 12:17:45.533719"]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "addresses" ("address1", "address2", "city", "created_at", "customer_id", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9) RETURNING "id"  [["address1", "試験1-1-1"], ["address2", ""], ["city", "千代田区"], ["created_at", "2014-08-26 12:17:45.539292"], ["customer_id", 56], ["postal_code", "1000001"], ["prefecture", "東京都"], ["type", "HomeAddress"], ["updated_at", "2014-08-26 12:17:45.539292"]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "addresses" ("address1", "address2", "city", "company_name", "created_at", "customer_id", "division_name", "postal_code", "prefecture", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11) RETURNING "id"[0m  [["address1", "試験1-1-1"], ["address2", ""], ["city", "港区"], ["company_name", "テスト"], ["created_at", "2014-08-26 12:17:45.540986"], ["customer_id", 56], ["division_name", "開発部"], ["postal_code", "1050000"], ["prefecture", "東京都"], ["type", "WorkAddress"], ["updated_at", "2014-08-26 12:17:45.540986"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:45.617592"], ["email", "member25@example.com"], ["email_for_index", "member25@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$DdtHXyvfoqhsvv7EsK3sqOOwXfRGsk53fqA53rEJQJrrCOA4xklkC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:45.617592"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 28ms (Views: 27.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "staff_events" ("created_at", "staff_member_id", "type") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:45.731518"], ["staff_member_id", 98], ["type", "logged_in"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 98 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 35ms (Views: 32.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.6ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 98 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (16.4ms)
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "customers"[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 48ms (Views: 45.7ms | ActiveRecord: 1.0ms)
Started GET "/customers/56/edit" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"56"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 98 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 56]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL[0m  [["customer_id", 56]]
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 56]]
  [1m[36mWorkAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 56]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 99]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 100]]
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_customer_fields.html.erb (10.3ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.3ms)
  Rendered staff/customers/_form.html.erb (34.6ms)
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 68ms (Views: 57.6ms | ActiveRecord: 1.1ms)
Started PATCH "/customers/56" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"56"}
  [1m[35mStaffMember Load (0.1ms)[0m  SELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 98 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1[0m  [["id", 56]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."customer_id" = $1 AND "phones"."address_id" IS NULL  [["customer_id", 56]]
  [1m[36mHomeAddress Load (0.1ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('HomeAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 56]]
  [1m[35mWorkAddress Load (0.1ms)[0m  SELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1  [["customer_id", 56]]
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1[0m  [["address_id", 99]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 100]]
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM "customers"  WHERE ("customers"."email_for_index" = 'member10@example.jp' AND "customers"."id" != 56) LIMIT 1
  [1m[36mAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."id" = $1 LIMIT 1[0m  [["id", 100]]
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 56]]
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "phones" ("address_id", "created_at", "customer_id", "last_four_digits", "number", "number_for_index", "primary", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["address_id", 100], ["created_at", "2014-08-26 12:17:45.931306"], ["customer_id", 56], ["last_four_digits", "1111"], ["number", "03-9999-1111"], ["number_for_index", "0399991111"], ["primary", "t"], ["updated_at", "2014-08-26 12:17:45.931306"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 21ms (ActiveRecord: 2.4ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-26 12:17:45 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  "staff_members".* FROM "staff_members"  WHERE "staff_members"."id" = 98 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (73.6ms)
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "customers"
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  "customers".* FROM "customers"   ORDER BY "customers"."family_name_kana" ASC, "customers"."given_name_kana" ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 106ms (Views: 103.0ms | ActiveRecord: 0.6ms)
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  "customers".* FROM "customers"  WHERE "customers"."id" = $1 LIMIT 1  [["id", 56]]
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  "addresses".* FROM "addresses"  WHERE "addresses"."type" IN ('WorkAddress') AND "addresses"."customer_id" = $1 LIMIT 1[0m  [["customer_id", 56]]
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "phones"  WHERE "phones"."address_id" = $1  [["address_id", 100]]
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT "phones".* FROM "phones"  WHERE "phones"."address_id" = $1  ORDER BY "phones"."id" ASC[0m  [["address_id", 100]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35m (1.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:46.310801"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$DrUClft.EuSrYSdVWlePD.YLt.muGp0eijs12dMj9rFLZvd09NIE6"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.310801"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:46.391835"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$81DPvw7f3V6tFM6yQzuBH.Er2CFrP7UnRTyfgqfqWpfBEw1IYFN/a"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.391835"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:46.479184"], ["email", "test@example.com"], ["email_for_index", "test@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$UBWoQaAaipCeYJPp7MDtzeLBZfPNFdu1P/LBz94iXWkj15SZeWZbu"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.479184"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (6.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:46.567845"], ["email", "member26@example.com"], ["email_for_index", "member26@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$l.yoJ1athTdWU8PgoS7hrudwdPXtlKTPzU0V9scEqGRR/fVhOovGO"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.567845"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", "2014-08-26 12:17:46.650716"], ["email", "member27@example.com"], ["email_for_index", "member27@example.com"], ["family_name", "山田"], ["family_name_kana", "テスト"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$PnK9NqabEregS48PdKb21ONS8yni/i.i41m2fvsEux.UtrS60ylra"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.650716"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'test@@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member29@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (1.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "staff_members" ("created_at", "email", "email_for_index", "family_name", "family_name_kana", "given_name", "given_name_kana", "hashed_password", "start_date", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["created_at", "2014-08-26 12:17:46.994421"], ["email", "member30@example.com"], ["email_for_index", "member30@example.com"], ["family_name", "山田"], ["family_name_kana", "ヤマダ"], ["given_name", "太郎"], ["given_name_kana", "タロウ"], ["hashed_password", "$2a$10$ZB.DXcjzUG/OWOjr85gtqeUh7HN1OGVUh30EXW12.35aNcfi7NeBC"], ["start_date", "2014-08-25"], ["updated_at", "2014-08-26 12:17:46.994421"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.4ms)[0m  SELECT  1 AS one FROM "staff_members"  WHERE "staff_members"."email_for_index" = 'member31@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (0.3ms)[0m  [1mCREATE DATABASE `baukis_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`[0m
  [1m[36m (37.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (37.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations`  ON `schema_migrations` (`version`) 
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
Migrating to CreateStaffMembers (20140723082116)
  [1m[35m (15.0ms)[0m  CREATE TABLE `staff_members` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `family_name` varchar(255) NOT NULL, `given_name` varchar(255) NOT NULL, `family_name_kana` varchar(255) NOT NULL, `given_name_kana` varchar(255) NOT NULL, `hashed_password` varchar(255), `start_date` date NOT NULL, `end_date` date, `suspended` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (24.4ms)[0m  [1mCREATE UNIQUE INDEX `index_staff_members_on_email_for_index`  ON `staff_members` (`email_for_index`) [0m
  [1m[35m (21.0ms)[0m  CREATE  INDEX `index_staff_members_on_family_name_kana_and_given_name_kana`  ON `staff_members` (`family_name_kana`, `given_name_kana`) 
  [1m[36m (0.6ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140723082116')
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
Migrating to CreateAdminMembers (20140723111825)
  [1m[35m (15.2ms)[0m  CREATE TABLE `admin_members` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `hashed_password` varchar(255), `suspended` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (21.6ms)[0m  [1mCREATE UNIQUE INDEX `index_admin_members_on_email_for_index`  ON `admin_members` (`email_for_index`) [0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `schema_migrations` (`version`) VALUES ('20140723111825')[0m
  [1m[35m (5.1ms)[0m  COMMIT
Migrating to CreateStaffEvents (20140803013844)
  [1m[36m (13.4ms)[0m  [1mCREATE TABLE `staff_events` (`id` int(11) auto_increment PRIMARY KEY, `staff_member_id` int(11) NOT NULL, `type` varchar(255) NOT NULL, `created_at` datetime NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (20.3ms)[0m  CREATE  INDEX `index_staff_events_on_created_at`  ON `staff_events` (`created_at`) 
  [1m[36m (20.4ms)[0m  [1mCREATE  INDEX `index_staff_events_on_staff_member_id_and_created_at`  ON `staff_events` (`staff_member_id`, `created_at`) [0m
  [1m[35m (60.6ms)[0m  ALTER TABLE `staff_events` ADD CONSTRAINT `staff_events_staff_member_id_fk` FOREIGN KEY (`staff_member_id`) REFERENCES `staff_members`(id)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140803013844')
  [1m[36m (1.0ms)[0m  [1mCOMMIT[0m
Migrating to CreateCustomers (20140809065211)
  [1m[35m (21.7ms)[0m  CREATE TABLE `customers` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `family_name` varchar(255) NOT NULL, `given_name` varchar(255) NOT NULL, `family_name_kana` varchar(255) NOT NULL, `given_name_kana` varchar(255) NOT NULL, `gender` varchar(255), `birthday` date, `hashed_password` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (20.6ms)[0m  [1mCREATE UNIQUE INDEX `index_customers_on_email_for_index`  ON `customers` (`email_for_index`) [0m
  [1m[35m (21.9ms)[0m  CREATE  INDEX `index_customers_on_family_name_kana_and_given_name_kana`  ON `customers` (`family_name_kana`, `given_name_kana`) 
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140809065211')
  [1m[36m (2.6ms)[0m  [1mCOMMIT[0m
Migrating to CreateAddresses (20140809065229)
  [1m[35m (13.5ms)[0m  CREATE TABLE `addresses` (`id` int(11) auto_increment PRIMARY KEY, `customer_id` int(11) NOT NULL, `type` varchar(255) NOT NULL, `postal_code` varchar(255) NOT NULL, `prefecture` varchar(255) NOT NULL, `city` varchar(255) NOT NULL, `address1` varchar(255) NOT NULL, `address2` varchar(255) NOT NULL, `company_name` varchar(255) DEFAULT '' NOT NULL, `division_name` varchar(255) DEFAULT '' NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (21.4ms)[0m  [1mCREATE  INDEX `index_addresses_on_customer_id`  ON `addresses` (`customer_id`) [0m
  [1m[35m (23.8ms)[0m  CREATE UNIQUE INDEX `index_addresses_on_type_and_customer_id`  ON `addresses` (`type`, `customer_id`) 
  [1m[36m (53.1ms)[0m  [1mALTER TABLE `addresses` ADD CONSTRAINT `addresses_customer_id_fk` FOREIGN KEY (`customer_id`) REFERENCES `customers`(id)[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (`version`) VALUES ('20140809065229')[0m
  [1m[35m (0.9ms)[0m  COMMIT
Migrating to CreatePhones (20140811122237)
  [1m[36m (25.3ms)[0m  [1mCREATE TABLE `phones` (`id` int(11) auto_increment PRIMARY KEY, `customer_id` int(11) NOT NULL, `address_id` int(11), `number` varchar(255) NOT NULL, `number_for_index` varchar(255) NOT NULL, `primary` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (19.6ms)[0m  CREATE  INDEX `index_phones_on_customer_id`  ON `phones` (`customer_id`) 
  [1m[36m (20.0ms)[0m  [1mCREATE  INDEX `index_phones_on_address_id`  ON `phones` (`address_id`) [0m
  [1m[35m (21.3ms)[0m  CREATE  INDEX `index_phones_on_number_for_index`  ON `phones` (`number_for_index`) 
  [1m[36m (63.9ms)[0m  [1mALTER TABLE `phones` ADD CONSTRAINT `phones_customer_id_fk` FOREIGN KEY (`customer_id`) REFERENCES `customers`(id)[0m
  [1m[35m (86.9ms)[0m  ALTER TABLE `phones` ADD CONSTRAINT `phones_address_id_fk` FOREIGN KEY (`address_id`) REFERENCES `addresses`(id)
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140811122237')
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers1 (20140812034537)
  [1m[35m (71.5ms)[0m  ALTER TABLE `customers` ADD `birth_year` int(11)
  [1m[36m (55.0ms)[0m  [1mALTER TABLE `customers` ADD `birth_month` int(11)[0m
  [1m[35m (55.8ms)[0m  ALTER TABLE `customers` ADD `birth_mday` int(11)
  [1m[36m (22.8ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_year_and_birth_month_and_birth_mday`  ON `customers` (`birth_year`, `birth_month`, `birth_mday`) [0m
  [1m[35m (29.9ms)[0m  CREATE  INDEX `index_customers_on_birth_month_and_birth_mday`  ON `customers` (`birth_month`, `birth_mday`) 
  [1m[36m (21.4ms)[0m  [1mCREATE  INDEX `index_customers_on_given_name_kana`  ON `customers` (`given_name_kana`) [0m
  [1m[35m (22.9ms)[0m  CREATE  INDEX `index_customers_on_birth_year_and_furigana`  ON `customers` (`birth_year`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (23.7ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_year_and_given_name_kana`  ON `customers` (`birth_year`, `given_name_kana`) [0m
  [1m[35m (24.7ms)[0m  CREATE  INDEX `index_customers_on_birth_month_and_furigana`  ON `customers` (`birth_month`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (21.0ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_month_and_given_name_kana`  ON `customers` (`birth_month`, `given_name_kana`) [0m
  [1m[35m (24.1ms)[0m  CREATE  INDEX `index_customers_on_birth_mday_and_furigana`  ON `customers` (`birth_mday`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (22.8ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_mday_and_given_name_kana`  ON `customers` (`birth_mday`, `given_name_kana`) [0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO `schema_migrations` (`version`) VALUES ('20140812034537')[0m
  [1m[35m (3.4ms)[0m  COMMIT
Migrating to AlterAddresses1 (20140812034548)
  [1m[36m (25.5ms)[0m  [1mCREATE  INDEX `index_addresses_on_type_and_prefecture_and_city`  ON `addresses` (`type`, `prefecture`, `city`) [0m
  [1m[35m (21.7ms)[0m  CREATE  INDEX `index_addresses_on_type_and_city`  ON `addresses` (`type`, `city`) 
  [1m[36m (22.7ms)[0m  [1mCREATE  INDEX `index_addresses_on_prefecture_and_city`  ON `addresses` (`prefecture`, `city`) [0m
  [1m[35m (21.5ms)[0m  CREATE  INDEX `index_addresses_on_city`  ON `addresses` (`city`) 
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140812034548')
  [1m[36m (3.7ms)[0m  [1mCOMMIT[0m
Migrating to UpdateCustomers1 (20140812041117)
  [1m[35m (1.1ms)[0m  
      UPDATE customers SET birth_year = EXTRACT(YEAR FROM birthday),
        birth_month = EXTRACT(MONTH FROM birthday),
        birth_mday = EXTRACT(DAY FROM birthday)
        WHERE birthday IS NOT NULL
      
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140812041117')
  [1m[36m (1.6ms)[0m  [1mCOMMIT[0m
Migrating to AlterCustomers2 (20140812080925)
  [1m[35m (22.7ms)[0m  CREATE  INDEX `index_customers_on_gender_and_furigana`  ON `customers` (`gender`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140812080925')
  [1m[36m (4.0ms)[0m  [1mCOMMIT[0m
Migrating to AlterAddress2 (20140812082005)
  [1m[35m (20.4ms)[0m  CREATE  INDEX `index_addresses_on_postal_code`  ON `addresses` (`postal_code`) 
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `schema_migrations` (`version`) VALUES ('20140812082005')
  [1m[36m (3.0ms)[0m  [1mCOMMIT[0m
Migrating to AlterPhone2 (20140812093211)
  [1m[35m (46.6ms)[0m  ALTER TABLE `phones` ADD `last_four_digits` varchar(255)
  [1m[36m (18.4ms)[0m  [1mCREATE  INDEX `index_phones_on_last_four_digits`  ON `phones` (`last_four_digits`) [0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (`version`) VALUES ('20140812093211')[0m
  [1m[35m (3.3ms)[0m  COMMIT
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35m (0.2ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'addresses'
        
  [1m[36m (0.2ms)[0m  [1mSHOW CREATE TABLE `addresses`[0m
  [1m[35m (0.3ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'admin_members'
        
  [1m[36m (0.1ms)[0m  [1mSHOW CREATE TABLE `admin_members`[0m
  [1m[35m (0.2ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'customers'
        
  [1m[36m (0.2ms)[0m  [1mSHOW CREATE TABLE `customers`[0m
  [1m[35m (0.3ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'phones'
        
  [1m[36m (0.2ms)[0m  [1mSHOW CREATE TABLE `phones`[0m
  [1m[35m (0.2ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'staff_events'
        
  [1m[36m (0.0ms)[0m  [1mSHOW CREATE TABLE `staff_events`[0m
  [1m[35m (0.2ms)[0m  
          SELECT fk.referenced_table_name as 'to_table'
                ,fk.referenced_column_name as 'primary_key'
                ,fk.column_name as 'column'
                ,fk.constraint_name as 'name'
          FROM information_schema.key_column_usage fk
          WHERE fk.referenced_column_name is not null
            AND fk.table_schema = 'baukis_test'
            AND fk.table_name = 'staff_members'
        
  [1m[36m (0.3ms)[0m  [1mSHOW CREATE TABLE `staff_members`[0m
  [1m[36m (147.4ms)[0m  [1mDROP DATABASE IF EXISTS `baukis_test`[0m
  [1m[35m (0.2ms)[0m  CREATE DATABASE `baukis_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (25.7ms)[0m  [1mCREATE TABLE `addresses` (`id` int(11) auto_increment PRIMARY KEY, `customer_id` int(11) NOT NULL, `type` varchar(255) NOT NULL, `postal_code` varchar(255) NOT NULL, `prefecture` varchar(255) NOT NULL, `city` varchar(255) NOT NULL, `address1` varchar(255) NOT NULL, `address2` varchar(255) NOT NULL, `company_name` varchar(255) DEFAULT '' NOT NULL, `division_name` varchar(255) DEFAULT '' NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (20.4ms)[0m  CREATE  INDEX `index_addresses_on_city` USING btree ON `addresses` (`city`) 
  [1m[36m (21.4ms)[0m  [1mCREATE  INDEX `index_addresses_on_customer_id` USING btree ON `addresses` (`customer_id`) [0m
  [1m[35m (20.4ms)[0m  CREATE  INDEX `index_addresses_on_postal_code` USING btree ON `addresses` (`postal_code`) 
  [1m[36m (26.8ms)[0m  [1mCREATE  INDEX `index_addresses_on_prefecture_and_city` USING btree ON `addresses` (`prefecture`, `city`) [0m
  [1m[35m (26.0ms)[0m  CREATE  INDEX `index_addresses_on_type_and_city` USING btree ON `addresses` (`type`, `city`) 
  [1m[36m (21.3ms)[0m  [1mCREATE UNIQUE INDEX `index_addresses_on_type_and_customer_id` USING btree ON `addresses` (`type`, `customer_id`) [0m
  [1m[35m (21.3ms)[0m  CREATE  INDEX `index_addresses_on_type_and_prefecture_and_city` USING btree ON `addresses` (`type`, `prefecture`, `city`) 
  [1m[36m (14.1ms)[0m  [1mCREATE TABLE `admin_members` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `hashed_password` varchar(255), `suspended` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (21.1ms)[0m  CREATE UNIQUE INDEX `index_admin_members_on_email_for_index` USING btree ON `admin_members` (`email_for_index`) 
  [1m[36m (17.0ms)[0m  [1mCREATE TABLE `customers` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `family_name` varchar(255) NOT NULL, `given_name` varchar(255) NOT NULL, `family_name_kana` varchar(255) NOT NULL, `given_name_kana` varchar(255) NOT NULL, `gender` varchar(255), `birthday` date, `hashed_password` varchar(255), `created_at` datetime, `updated_at` datetime, `birth_year` int(11), `birth_month` int(11), `birth_mday` int(11)) ENGINE=InnoDB[0m
  [1m[35m (33.0ms)[0m  CREATE  INDEX `index_customers_on_birth_mday_and_furigana` USING btree ON `customers` (`birth_mday`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (20.9ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_mday_and_given_name_kana` USING btree ON `customers` (`birth_mday`, `given_name_kana`) [0m
  [1m[35m (21.3ms)[0m  CREATE  INDEX `index_customers_on_birth_month_and_birth_mday` USING btree ON `customers` (`birth_month`, `birth_mday`) 
  [1m[36m (27.9ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_month_and_furigana` USING btree ON `customers` (`birth_month`, `family_name_kana`, `given_name_kana`) [0m
  [1m[35m (21.6ms)[0m  CREATE  INDEX `index_customers_on_birth_month_and_given_name_kana` USING btree ON `customers` (`birth_month`, `given_name_kana`) 
  [1m[36m (22.3ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_year_and_birth_month_and_birth_mday` USING btree ON `customers` (`birth_year`, `birth_month`, `birth_mday`) [0m
  [1m[35m (20.8ms)[0m  CREATE  INDEX `index_customers_on_birth_year_and_furigana` USING btree ON `customers` (`birth_year`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (21.8ms)[0m  [1mCREATE  INDEX `index_customers_on_birth_year_and_given_name_kana` USING btree ON `customers` (`birth_year`, `given_name_kana`) [0m
  [1m[35m (20.1ms)[0m  CREATE UNIQUE INDEX `index_customers_on_email_for_index` USING btree ON `customers` (`email_for_index`) 
  [1m[36m (21.7ms)[0m  [1mCREATE  INDEX `index_customers_on_family_name_kana_and_given_name_kana` USING btree ON `customers` (`family_name_kana`, `given_name_kana`) [0m
  [1m[35m (22.5ms)[0m  CREATE  INDEX `index_customers_on_gender_and_furigana` USING btree ON `customers` (`gender`, `family_name_kana`, `given_name_kana`) 
  [1m[36m (24.8ms)[0m  [1mCREATE  INDEX `index_customers_on_given_name_kana` USING btree ON `customers` (`given_name_kana`) [0m
  [1m[35m (24.6ms)[0m  CREATE TABLE `phones` (`id` int(11) auto_increment PRIMARY KEY, `customer_id` int(11) NOT NULL, `address_id` int(11), `number` varchar(255) NOT NULL, `number_for_index` varchar(255) NOT NULL, `primary` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime, `last_four_digits` varchar(255)) ENGINE=InnoDB
  [1m[36m (19.9ms)[0m  [1mCREATE  INDEX `index_phones_on_address_id` USING btree ON `phones` (`address_id`) [0m
  [1m[35m (22.5ms)[0m  CREATE  INDEX `index_phones_on_customer_id` USING btree ON `phones` (`customer_id`) 
  [1m[36m (20.4ms)[0m  [1mCREATE  INDEX `index_phones_on_last_four_digits` USING btree ON `phones` (`last_four_digits`) [0m
  [1m[35m (21.5ms)[0m  CREATE  INDEX `index_phones_on_number_for_index` USING btree ON `phones` (`number_for_index`) 
  [1m[36m (15.0ms)[0m  [1mCREATE TABLE `staff_events` (`id` int(11) auto_increment PRIMARY KEY, `staff_member_id` int(11) NOT NULL, `type` varchar(255) NOT NULL, `created_at` datetime NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (21.1ms)[0m  CREATE  INDEX `index_staff_events_on_created_at` USING btree ON `staff_events` (`created_at`) 
  [1m[36m (24.2ms)[0m  [1mCREATE  INDEX `index_staff_events_on_staff_member_id_and_created_at` USING btree ON `staff_events` (`staff_member_id`, `created_at`) [0m
  [1m[35m (13.2ms)[0m  CREATE TABLE `staff_members` (`id` int(11) auto_increment PRIMARY KEY, `email` varchar(255) NOT NULL, `email_for_index` varchar(255) NOT NULL, `family_name` varchar(255) NOT NULL, `given_name` varchar(255) NOT NULL, `family_name_kana` varchar(255) NOT NULL, `given_name_kana` varchar(255) NOT NULL, `hashed_password` varchar(255), `start_date` date NOT NULL, `end_date` date, `suspended` tinyint(1) DEFAULT 0 NOT NULL, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (20.1ms)[0m  [1mCREATE UNIQUE INDEX `index_staff_members_on_email_for_index` USING btree ON `staff_members` (`email_for_index`) [0m
  [1m[35m (29.2ms)[0m  CREATE  INDEX `index_staff_members_on_family_name_kana_and_given_name_kana` USING btree ON `staff_members` (`family_name_kana`, `given_name_kana`) 
  [1m[36m (98.8ms)[0m  [1mALTER TABLE `addresses` ADD CONSTRAINT `addresses_customer_id_fk` FOREIGN KEY (`customer_id`) REFERENCES `customers`(id)[0m
  [1m[35m (104.7ms)[0m  ALTER TABLE `phones` ADD CONSTRAINT `phones_address_id_fk` FOREIGN KEY (`address_id`) REFERENCES `addresses`(id)
  [1m[36m (101.2ms)[0m  [1mALTER TABLE `phones` ADD CONSTRAINT `phones_customer_id_fk` FOREIGN KEY (`customer_id`) REFERENCES `customers`(id)[0m
  [1m[35m (96.5ms)[0m  ALTER TABLE `staff_events` ADD CONSTRAINT `staff_events_staff_member_id_fk` FOREIGN KEY (`staff_member_id`) REFERENCES `staff_members`(id)
  [1m[36m (25.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (38.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations`  ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (3.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140812093211')
  [1m[36m (1.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140723082116')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140723111825')
  [1m[36m (1.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140803013844')[0m
  [1m[35m (2.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140809065211')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140809065229')[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140811122237')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140812034537')[0m
  [1m[35m (1.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140812034548')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140812041117')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20140812080925')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20140812082005')[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.6ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#index as HTML
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
Processing by Admin::StaffMembersController#show as HTML
  Parameters: {"id"=>"1"}
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.6ms)[0m  SELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin1@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:34', 'admin1@example.com', 'admin1@example.com', '$2a$10$ZDXFHI1j.8KDYudPCP0g.OQxf51Tx/ypUi/ONZsaB1Pw4iL/g14WG', '2014-08-27 08:30:34')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#create as HTML
  Parameters: {"staff_member"=>{"email"=>"member1@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-26", "end_date"=>nil, "suspended"=>false}}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member1@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:34', 'member1@example.com', 'member1@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$75da7oFPRHoo.QbDdBgkceYUMvrifYYcLTPaDFnUKFbym7pPZmTqS', '2014-08-26', '2014-08-27 08:30:34')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 112ms (ActiveRecord: 2.1ms)
  [1m[35m (15.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin2@example.com' LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:34', 'admin2@example.com', 'admin2@example.com', '$2a$10$xBAsVXrQLxJzVpJ7GWbXWOMvQAtmGw1sA7bWNmQq0fWUUiuld2XGO', '2014-08-27 08:30:34')
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#create as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 2 LIMIT 1
Completed 400 Bad Request in 2ms
  [1m[36m (1.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin3@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'admin3@example.com', 'admin3@example.com', '$2a$10$EaIUh8EpxU96avm4jTYwE.vLJwCm0DX4w..OXRnoabI1j3E5zKvWy', '2014-08-27 08:30:35')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member3@example.com' LIMIT 1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'member3@example.com', 'member3@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$kYTTw/Myop5Y7LXc2CB6ZeIXv9AiiNV19qGPiWwoa21TW//SFrrxu', '2014-08-26', '2014-08-27 08:30:35')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member2@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-26", "end_date"=>nil, "suspended"=>true}, "id"=>"2"}
  [1m[36mAdminMember Load (0.3ms)[0m  [1mSELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 3 LIMIT 1[0m
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 2 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (11.4ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE (`staff_members`.`email_for_index` = BINARY 'member2@example.com' AND `staff_members`.`id` != 2) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `staff_members` SET `email` = 'member2@example.com', `email_for_index` = 'member2@example.com', `hashed_password` = '$2a$10$jw6CXB3msbGhxp/VhbeajujjZMXDk1vd9SsRMgh4ju8QiSPxu01rq', `suspended` = 1, `updated_at` = '2014-08-27 08:30:35' WHERE `staff_members`.`id` = 2[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 92ms (ActiveRecord: 12.4ms)
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 2 LIMIT 1[0m
  [1m[35m (10.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin4@example.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'admin4@example.com', 'admin4@example.com', '$2a$10$FqKOGJDAQj9.UUO7vEWIaOT.dJnBjHqFC7LyfgevhLME8WY2aFeNO', '2014-08-27 08:30:35')
  [1m[36m (0.6ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'member5@example.com', 'member5@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$0ftRCAgXx5CRd9vdhgVB6OF98T0QijUu0unMFsAQy03kkWbKAGcAu', '2014-08-26', '2014-08-27 08:30:35')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::StaffMembersController#update as HTML
  Parameters: {"staff_member"=>{"email"=>"member4@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "start_date"=>"2014-08-26", "end_date"=>nil, "suspended"=>false, "hashed_password"=>"[FILTERED]"}, "id"=>"3"}
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 4 LIMIT 1
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 3 LIMIT 1[0m
Unpermitted parameters: hashed_password
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE (`staff_members`.`email_for_index` = BINARY 'member4@example.com' AND `staff_members`.`id` != 3) LIMIT 1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `staff_members` SET `email` = 'member4@example.com', `email_for_index` = 'member4@example.com', `updated_at` = '2014-08-27 08:30:35' WHERE `staff_members`.`id` = 3
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/admin/staff_members
Completed 302 Found in 7ms (ActiveRecord: 1.9ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mAdminMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin5@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'admin5@example.com', 'admin5@example.com', '$2a$10$J3sA1vwFaneeh9ZWIUTfNu.sbPmU/sGHhls2zpyqLjwxftjTXY.Mi', '2014-08-27 08:30:35')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.3ms)[0m  SELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 5 LIMIT 1
Completed 200 OK in 61ms (Views: 59.7ms | ActiveRecord: 0.3ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.6ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin6@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'admin6@example.com', 'admin6@example.com', '$2a$10$bj1u48fFjnDVQX9P1prMIO8tcF/JXn7bT0Y6YO2tlCW28i2eCqpCi', '2014-08-27 08:30:35')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `admin_members` SET `admin_members`.`suspended` = 1 WHERE `admin_members`.`id` = 6[0m
Processing by Admin::TopController#index as HTML
  [1m[35mAdminMember Load (0.2ms)[0m  SELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 6 LIMIT 1
Redirected to http://baukis.example.com/admin
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.2ms)
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mAdminMember Exists (0.4ms)[0m  SELECT  1 AS one FROM `admin_members`  WHERE `admin_members`.`email_for_index` = BINARY 'admin7@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `admin_members` (`created_at`, `email`, `email_for_index`, `hashed_password`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'admin7@example.com', 'admin7@example.com', '$2a$10$G2A8y8bH2fg6kOvi/aY9I.KWeIPuppCycQ6wvfnF2iQZmCYW3EuVu', '2014-08-27 08:30:35')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Admin::TopController#index as HTML
  [1m[36mAdminMember Load (0.1ms)[0m  [1mSELECT  `admin_members`.* FROM `admin_members`  WHERE `admin_members`.`id` = 7 LIMIT 1[0m
Redirected to http://baukis.example.com/admin/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.1ms)
  [1m[35m (1.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Processing by Staff::AccountsController#show as HTML
Redirected to http://baukis.example.com/login
Filter chain halted as :authorize rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member6@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'member6@example.com', 'member6@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$MxEV5NNOsZhWTf8jEyaAJ.m0IaxsSHhWp/xXxGOZy9quTZjOsUIyq', '2014-08-26', '2014-08-27 08:30:35')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"4", "staff_member"=>{"email"=>"test@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-26", "end_date"=>nil, "suspended"=>false}}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 4 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE (`staff_members`.`email_for_index` = BINARY 'test@example.com' AND `staff_members`.`id` != 4) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `staff_members` SET `email` = 'test@example.com', `email_for_index` = 'test@example.com', `updated_at` = '2014-08-27 08:30:35' WHERE `staff_members`.`id` = 4[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 6ms (ActiveRecord: 1.0ms)
  [1m[36mStaffMember Load (0.8ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 4 LIMIT 1[0m
  [1m[35m (1.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member8@example.com' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:35', 'member8@example.com', 'member8@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$rCII2jLTirZCxY7u465MlOJQJUvcz9W63twGMS04Gmnn/Cqjs8DHa', '2014-08-26', '2014-08-27 08:30:35')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"5"}
  [1m[35mStaffMember Load (0.8ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 5 LIMIT 1
Completed 400 Bad Request in 2ms
  [1m[36m (9.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member9@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member9@example.com', 'member9@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$9AuDdHYK/zMhbOxlfxzulOaEch0t/LFZwUFM5MWUJasmhXQXRJkrq', '2014-08-26', '2014-08-27 08:30:36')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"6", "staff_member"=>{"email"=>"member10@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-26", "end_date"=>"2014-08-28", "suspended"=>false}}
  [1m[36mStaffMember Load (0.1ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 6 LIMIT 1[0m
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE (`staff_members`.`email_for_index` = BINARY 'member10@example.com' AND `staff_members`.`id` != 6) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `staff_members` SET `email` = 'member10@example.com', `email_for_index` = 'member10@example.com', `updated_at` = '2014-08-27 08:30:36' WHERE `staff_members`.`id` = 6
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/account
Completed 302 Found in 5ms (ActiveRecord: 0.8ms)
  [1m[35m (2.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.8ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member11@example.com' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member11@example.com', 'member11@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$SP6rrtxZOZ.6QWnt/18Rre1.xU/c/9jBWs/9gmiCsVXCKItRPDvGe', '2014-08-26', '2014-08-27 08:30:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::AccountsController#update as HTML
  Parameters: {"id"=>"7", "staff_member"=>{"email"=>"member12@example.com", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "password"=>"[FILTERED]", "start_date"=>"2014-08-26", "end_date"=>nil, "suspended"=>true}}
  [1m[35mStaffMember Load (0.9ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 7 LIMIT 1
Unpermitted parameters: password, start_date, end_date, suspended
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE (`staff_members`.`email_for_index` = BINARY 'member12@example.com' AND `staff_members`.`id` != 7) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE `staff_members` SET `email` = 'member12@example.com', `email_for_index` = 'member12@example.com', `updated_at` = '2014-08-27 08:30:36' WHERE `staff_members`.`id` = 7[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/account
Completed 302 Found in 10ms (ActiveRecord: 1.7ms)
  [1m[36m (1.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member13@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member13@example.com', 'member13@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$vchq0ggv22DwrPb3rXhQbOzWTjqFdk12grcmTvazHh7awMcToX/rK', '2014-08-26', '2014-08-27 08:30:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 8 LIMIT 1[0m
Completed 200 OK in 44ms (Views: 42.2ms | ActiveRecord: 0.5ms)
  [1m[35m (1.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member14@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member14@example.com', 'member14@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$yWnABt0F1SExoYbH221NrOrFEXkH6hrv9WBmLV3KjA8bEuqYzzLzu', '2014-08-26', '2014-08-27 08:30:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `staff_members` SET `staff_members`.`suspended` = 1 WHERE `staff_members`.`id` = 9
Processing by Staff::TopController#index as HTML
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 9 LIMIT 1[0m
Redirected to http://baukis.example.com/
Filter chain halted as :check_account rendered or redirected
Completed 302 Found in 3ms (ActiveRecord: 0.5ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member15@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member15@example.com', 'member15@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$r2XbvR/OOsMS4Mqtkm0iBeidGyFMpJe3QjOvAgiyFChK5qteRxREa', '2014-08-26', '2014-08-27 08:30:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Staff::TopController#index as HTML
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 10 LIMIT 1
Redirected to http://baukis.example.com/login
Filter chain halted as :check_timeout rendered or redirected
Completed 302 Found in 2ms (ActiveRecord: 0.3ms)
  [1m[36m (9.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member1@example.jp' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:36', 'member1@example.jp', 'member1@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$PehJsY6zxb4lj1S3Tkm4UerQ1tyoGnVG0Gj7XTO2k9LIEEHmOh6i6', '2014-08-27 08:30:36')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:36', 1, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:36')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:36', 1, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member16@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:36', 'member16@example.com', 'member16@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$iQCBV9X436IxHfdljIeFUuO827ocRnN1qeCt.S9JgI.JDhAkAY4hy', '2014-08-26', '2014-08-27 08:30:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:36 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (1.1ms)
  Rendered shared/_footer.html.erb (0.4ms)
Completed 200 OK in 465ms (Views: 423.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:37 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member16@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member16@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:37', 11, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 119ms (ActiveRecord: 2.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:37 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 11 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 25ms (Views: 22.2ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:37 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 11 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (103.4ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (1.8ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 255ms (Views: 242.0ms | ActiveRecord: 2.2ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-27 08:30:37 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 11 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (11.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (77.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_home_address_fields.html.erb (27.4ms)
  Rendered staff/customers/_phone_fields.html.erb (2.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (15.2ms)
  Rendered staff/customers/_form.html.erb (188.0ms)
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 309ms (Views: 260.4ms | ActiveRecord: 1.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 11 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:38', 'test@example.jp', 'test@example.jp', '試験', 'シケン', 'female', '花子', 'ハナコ', '$2a$10$flZcsE0NxkL6.ZuiGU0RQ.frs2OqSKQgS5yazSH0208EjYTFjdHZe', '2014-08-27 08:30:38')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('千代田1-1-1', '', '千代田区', '2014-08-27 08:30:38', 2, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:38')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('', '', '', 'テスト', '2014-08-27 08:30:38', 2, '', '', 'WorkAddress', '2014-08-27 08:30:38')[0m
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 103ms (ActiveRecord: 1.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 11 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (19.0ms)
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 54ms (Views: 50.9ms | ActiveRecord: 1.0ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`id` DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 2 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 2 LIMIT 1
  [1m[36m (17.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.2ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member2@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:38', 'member2@example.jp', 'member2@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$jp7R9Sg7jfCd4UHC/xsOlO2/01dSvbwsTapKH911jq2RsqmwfeJEO', '2014-08-27 08:30:38')[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:38', 3, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:38')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:38', 3, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:38')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.2ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member17@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:38', 'member17@example.com', 'member17@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$rmuo/cpScZnqHgAaRyS6gewHF2YFOfmvpJPCM0g1jeB8iav0vnL8i', '2014-08-26', '2014-08-27 08:30:38')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 22ms (Views: 21.5ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member17@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member17@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:38', 12, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 81ms (ActiveRecord: 1.1ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 12 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 27ms (Views: 24.8ms | ActiveRecord: 0.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (29.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (1.2ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 61ms (Views: 58.8ms | ActiveRecord: 0.8ms)
Started GET "/customers/3/edit" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"3"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 12 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 3 LIMIT 1
  [1m[36m (8.9ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 3 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 3 LIMIT 1
  [1m[36mWorkAddress Load (0.8ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 3 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 5
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 6[0m
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.7ms)
  Rendered staff/customers/_customer_fields.html.erb (10.3ms)
  Rendered staff/customers/_phone_fields.html.erb (2.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_work_address_fields.html.erb (15.4ms)
  Rendered staff/customers/_form.html.erb (40.5ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 117ms (Views: 84.7ms | ActiveRecord: 11.1ms)
Started PATCH "/customers/3" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"9999999", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"3"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 12 LIMIT 1
  [1m[36mCustomer Load (0.5ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 3 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 3 AND `phones`.`address_id` IS NULL
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 3 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.5ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 3 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 5[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 6
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.2ms)[0m  SELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'test@example.jp' AND `customers`.`id` != 3) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `customers` SET `email` = 'test@example.jp', `email_for_index` = 'test@example.jp', `updated_at` = '2014-08-27 08:30:38' WHERE `customers`.`id` = 3[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `addresses` SET `postal_code` = '9999999', `updated_at` = '2014-08-27 08:30:38' WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`id` = 5
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 26ms (ActiveRecord: 3.5ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:38 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 12 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (27.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 61ms (Views: 57.5ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 3 LIMIT 1[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 3 LIMIT 1
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 3 LIMIT 1[0m
  [1m[35m (11.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member3@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:38', 'member3@example.jp', 'member3@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$B.tTk7m4JP6xzxLZjaNYTuIKjHvIYW/AX5N7.hhOLtlbGxHCZFm/S', '2014-08-27 08:30:38')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:38', 4, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:38')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:38', 4, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:38')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member18@example.com' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:39', 'member18@example.com', 'member18@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$WR85mvg8XODU.9nS6XBEcuKDqq5VmSX6dAPfKfvEkhgh6Kkkdmjhm', '2014-08-26', '2014-08-27 08:30:39')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 30ms (Views: 29.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member18@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member18@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:39', 13, 'logged_in')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 76ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 13 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 31ms (Views: 28.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.6ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 13 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (28.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.5ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 73ms (Views: 68.2ms | ActiveRecord: 1.3ms)
Started GET "/customers/4/edit" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"4"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 13 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 4 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 4 AND `phones`.`address_id` IS NULL
  [1m[36mHomeAddress Load (1.0ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 4 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 4 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 7[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 8
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_customer_fields.html.erb (10.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.2ms)
  Rendered staff/customers/_form.html.erb (36.6ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 71ms (Views: 58.1ms | ActiveRecord: 2.5ms)
Started PATCH "/customers/4" for 127.0.0.1 at 2014-08-27 08:30:39 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member3@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"2100-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"XYZ", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"4"}
  [1m[36mStaffMember Load (0.2ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 13 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 4 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 4 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.5ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 4 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 4 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 7
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 8[0m
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'member3@example.jp' AND `customers`.`id` != 4) LIMIT 1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_customer_fields.html.erb (16.2ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_home_address_fields.html.erb (20.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.9ms)
  Rendered staff/customers/_form.html.erb (51.4ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 627ms (Views: 73.7ms | ActiveRecord: 2.8ms)
  [1m[36m (5.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member4@example.jp' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:40', 'member4@example.jp', 'member4@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$Ug1Ljd1h4Zd2ZziOHH6OAechHcJIxEMmR/Dqox/KH00KTpK4JbuPK', '2014-08-27 08:30:40')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:40', 5, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:40')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:40', 5, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member19@example.com' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:40', 'member19@example.com', 'member19@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$IRsY0sN34ptztvD8ziBtY.ZXXDFO8wr8Ds5tTDU8zN8HCoj1Wt8zK', '2014-08-26', '2014-08-27 08:30:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 22ms (Views: 22.1ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member19@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member19@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:40', 14, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 79ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 14 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 25ms (Views: 22.7ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 14 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.4ms)
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.4ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 47ms (Views: 43.9ms | ActiveRecord: 0.9ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 14 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (3.4ms)
  Rendered staff/customers/_phone_fields.html.erb (2.2ms)
  Rendered staff/customers/_customer_fields.html.erb (23.1ms)
  Rendered staff/customers/_phone_fields.html.erb (2.0ms)
  Rendered staff/customers/_phone_fields.html.erb (12.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (22.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (12.6ms)
  Rendered staff/customers/_form.html.erb (60.1ms)
  Rendered staff/shared/_header.html.erb (0.3ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 87ms (Views: 80.5ms | ActiveRecord: 0.3ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 14 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:40', 'test@example.jp', 'test@example.jp', '試験', 'シケン', 'female', '花子', 'ハナコ', '$2a$10$FsChrZCZI6ahfesiksURC.Jv/n1o.bg3eUaNRkkRg7nGopfefTF0C', '2014-08-27 08:30:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 88ms (ActiveRecord: 1.2ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 14 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (29.3ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.0ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 65ms (Views: 62.2ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`id` DESC LIMIT 1
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 6 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 6 LIMIT 1
  [1m[36m (8.9ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.4ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member5@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:40', 'member5@example.jp', 'member5@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$j9vUy7qBxDL4j2zMmlDvfOaJHlXvMy.R8Q1MC3DYqdeCmIB74k.eC', '2014-08-27 08:30:40')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:40', 7, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:40')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:40', 7, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:40')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.5ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member20@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:40', 'member20@example.com', 'member20@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$ldsxJg03eQ5kVUeqowMv0u0Sn6ksC32n1Vo5E.vMk580IOMoRGkJ6', '2014-08-26', '2014-08-27 08:30:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 22.8ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member20@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member20@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:40', 15, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 76ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:40 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 15 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (1.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 20.6ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mPhone Load (0.3ms)[0m  [1mSELECT `phones`.* FROM `phones`  WHERE `phones`.`address_id` = 12  ORDER BY `phones`.`id` ASC[0m
  [1m[35mSQL (9.8ms)[0m  DELETE FROM `addresses` WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`id` = 12
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 15 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (26.5ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 70ms (Views: 66.6ms | ActiveRecord: 0.9ms)
Started GET "/customers/7/edit" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 7 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 7 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 7 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 7 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 11
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (12.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (12.1ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_work_address_fields.html.erb (20.7ms)
  Rendered staff/customers/_form.html.erb (46.8ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 88ms (Views: 76.3ms | ActiveRecord: 1.7ms)
Started PATCH "/customers/7" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member5@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テストテスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"7"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 15 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 7 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 7 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.8ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 7 LIMIT 1
  [1m[36mWorkAddress Load (0.2ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 7 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 11
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'member5@example.jp' AND `customers`.`id` != 7) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('', '', '', 'テストテスト', '2014-08-27 08:30:41', 7, '', '', 'WorkAddress', '2014-08-27 08:30:41')[0m
  [1m[35m (0.5ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 22ms (ActiveRecord: 3.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 15 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (24.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (1.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 65ms (Views: 62.1ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.5ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 7 LIMIT 1
  [1m[36mWorkAddress Load (0.7ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 7 LIMIT 1[0m
  [1m[35m (9.5ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member6@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:41', 'member6@example.jp', 'member6@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$pNVC70JCcr3l4vhOo7uZsufUA3Qu3981PD.AumoJPPVlF8a0JiijK', '2014-08-27 08:30:41')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:41', 8, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:41')[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:41', 8, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:41')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member21@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:41', 'member21@example.com', 'member21@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$mtN.UbQ2h1cfmSBvMFXcmebWUdYEPxwk59GsYOxYK5agBVxCI.NNy', '2014-08-26', '2014-08-27 08:30:41')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 28ms (Views: 27.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member21@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member21@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:41', 16, 'logged_in')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 91ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 16 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 24ms (Views: 21.6ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (24.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 53ms (Views: 49.9ms | ActiveRecord: 1.0ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 16 LIMIT 1
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_customer_fields.html.erb (12.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_home_address_fields.html.erb (11.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.4ms)
  Rendered staff/customers/_work_address_fields.html.erb (24.3ms)
  Rendered staff/customers/_form.html.erb (50.2ms)
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.2ms)
Completed 200 OK in 95ms (Views: 88.8ms | ActiveRecord: 0.4ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"千代田1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"0", "work_address"=>{"company_name"=>"", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 16 LIMIT 1[0m
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'test@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:41', 'test@example.jp', 'test@example.jp', '試験', 'シケン', 'female', '花子', 'ハナコ', '$2a$10$MHytSLpBeek/3u1JK17oJ.StXosXbx285IUQmaouDm9zWFkFzAqTq', '2014-08-27 08:30:41')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('千代田1-1-1', '', '千代田区', '2014-08-27 08:30:41', 9, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:41')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 91ms (ActiveRecord: 2.0ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:41 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 16 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (23.1ms)
  [1m[35m (0.0ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 64ms (Views: 60.5ms | ActiveRecord: 0.6ms)
  [1m[35mCustomer Load (0.7ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`id` DESC LIMIT 1
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 9 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 9 LIMIT 1
  [1m[36m (9.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.9ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.7ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member7@example.jp' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:42', 'member7@example.jp', 'member7@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$DJ8r9XXT7JMRxF1paK.m1.osHq2DsozJ.AM3mFbDvmKojhO5A.Zu2', '2014-08-27 08:30:42')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:42', 10, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:42')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:42', 10, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:42')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member22@example.com' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:42', 'member22@example.com', 'member22@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$8Chz2DKezUQJM/CSkWhOTe5A0/sjlkMEhle3SRw9ZICyN7li077TC', '2014-08-26', '2014-08-27 08:30:42')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 32ms (Views: 31.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member22@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member22@example.com' LIMIT 1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:42', 17, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 78ms (ActiveRecord: 0.7ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 17 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 29ms (Views: 26.2ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (23.6ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 54ms (Views: 50.8ms | ActiveRecord: 0.8ms)
Started GET "/customers/new" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::CustomersController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 17 LIMIT 1[0m
  Rendered staff/customers/_phone_fields.html.erb (2.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_customer_fields.html.erb (17.1ms)
  Rendered staff/customers/_phone_fields.html.erb (2.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.8ms)
  Rendered staff/customers/_home_address_fields.html.erb (18.0ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_work_address_fields.html.erb (11.5ms)
  Rendered staff/customers/_form.html.erb (49.2ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 85ms (Views: 74.9ms | ActiveRecord: 0.5ms)
Started POST "/customers" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::CustomersController#create as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"test@example.jp", "password"=>"[FILTERED]", "family_name"=>"試験", "given_name"=>"花子", "family_name_kana"=>"シケン", "given_name_kana"=>"ハナコ", "birthday"=>"1970-01-01", "gender"=>"female", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"0", "home_address"=>{"postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"", "postal_code"=>"", "prefecture"=>"", "city"=>"", "address1"=>"", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"登録", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (2.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 17 LIMIT 1
Unpermitted parameters: phones
Unpermitted parameters: email, password, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.2ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'test@example.jp' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:42', 'test@example.jp', 'test@example.jp', '試験', 'シケン', 'female', '花子', 'ハナコ', '$2a$10$cDhnXPtRK/76EUwXhvvawOWzrzf3R9TMY0GGkQtLsWhpvODP9jJay', '2014-08-27 08:30:42')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('', '', '', 'テスト', '2014-08-27 08:30:42', 11, '', '', 'WorkAddress', '2014-08-27 08:30:42')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 97ms (ActiveRecord: 3.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.0ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 17 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (20.9ms)
  [1m[36m (0.5ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 55ms (Views: 52.2ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`id` DESC LIMIT 1[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 11 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 11 LIMIT 1[0m
  [1m[35m (8.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member8@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:42', 'member8@example.jp', 'member8@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$zVpMilbSbIP42wfrtiWNhOdhbKbchOTLoY1sSBsTjVUVFshDyZteS', '2014-08-27 08:30:42')
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:42', 12, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:42')[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:42', 12, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:42')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.6ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member23@example.com' LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:42', 'member23@example.com', 'member23@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$FNm4l8bmK8FgYCh0qS7cbOKoWxbJ1KZvXAF/zXdLMa5q9sC9i6uxm', '2014-08-26', '2014-08-27 08:30:42')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.4ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 22.6ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member23@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member23@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:42', 18, 'logged_in')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 1.0ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:42 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 18 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 20.5ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 18 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (16.9ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 48ms (Views: 45.2ms | ActiveRecord: 0.8ms)
Started GET "/customers/12/edit" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"12"}
  [1m[35mStaffMember Load (0.2ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 18 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 12 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 12 AND `phones`.`address_id` IS NULL
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 12 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 12 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 20[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 21
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_phone_fields.html.erb (1.7ms)
  Rendered staff/customers/_customer_fields.html.erb (28.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.6ms)
  Rendered staff/customers/_phone_fields.html.erb (1.3ms)
  Rendered staff/customers/_home_address_fields.html.erb (13.6ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.4ms)
  Rendered staff/customers/_form.html.erb (57.3ms)
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 90ms (Views: 78.2ms | ActiveRecord: 1.7ms)
Started PATCH "/customers/12" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member8@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"090-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"12"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 18 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 12 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 12 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 12 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 12 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 20
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 21[0m
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'member8@example.jp' AND `customers`.`id` != 12) LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `phones` (`created_at`, `customer_id`, `last_four_digits`, `number`, `number_for_index`, `primary`, `updated_at`) VALUES ('2014-08-27 08:30:43', 12, '9999', '090-9999-9999', '09099999999', 1, '2014-08-27 08:30:43')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 45ms (ActiveRecord: 2.7ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 18 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (18.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 61ms (Views: 57.2ms | ActiveRecord: 0.9ms)
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 12 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 12 AND `phones`.`address_id` IS NULL
  [1m[36mPhone Load (0.9ms)[0m  [1mSELECT `phones`.* FROM `phones`  WHERE `phones`.`customer_id` = 12 AND `phones`.`address_id` IS NULL  ORDER BY `phones`.`id` ASC[0m
  [1m[35m (1.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member9@example.jp' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:43', 'member9@example.jp', 'member9@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$L62D0uQZcIpwf9dsFPZBhuDo5QLNdDtBbHsrw2aGggWyhoflAwWFG', '2014-08-27 08:30:43')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:43', 13, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:43')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:43', 13, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member24@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:43', 'member24@example.com', 'member24@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$aiNLjBygDnvmjqlrnxU2N.Gh1/BjPeT/OH3px711YyUDeuy.LbIvC', '2014-08-26', '2014-08-27 08:30:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 39ms (Views: 38.4ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member24@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member24@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:43', 19, 'logged_in')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/
Completed 302 Found in 77ms (ActiveRecord: 0.8ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 19 LIMIT 1
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 22ms (Views: 19.8ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 19 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (16.0ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.2ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 45ms (Views: 41.8ms | ActiveRecord: 0.7ms)
Started GET "/customers/13/edit" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"13"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 19 LIMIT 1
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 13 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 13 AND `phones`.`address_id` IS NULL
  [1m[36mHomeAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 13 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.2ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 13 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 22[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 23
  Rendered staff/customers/_phone_fields.html.erb (1.5ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_customer_fields.html.erb (10.7ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_phone_fields.html.erb (1.0ms)
  Rendered staff/customers/_home_address_fields.html.erb (10.0ms)
  Rendered staff/customers/_phone_fields.html.erb (2.2ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (13.3ms)
  Rendered staff/customers/_form.html.erb (35.8ms)
  Rendered staff/shared/_header.html.erb (0.7ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 77ms (Views: 66.4ms | ActiveRecord: 1.7ms)
Started PATCH "/customers/13" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member9@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-9999", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"13"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 19 LIMIT 1[0m
  [1m[35mCustomer Load (0.2ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 13 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 13 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.2ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 13 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 13 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 22
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 23[0m
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mCustomer Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'member9@example.jp' AND `customers`.`id` != 13) LIMIT 1[0m
  [1m[35mAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`id` = 22 LIMIT 1
  [1m[36mCustomer Load (0.3ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 13 LIMIT 1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `phones` (`address_id`, `created_at`, `customer_id`, `last_four_digits`, `number`, `number_for_index`, `primary`, `updated_at`) VALUES (22, '2014-08-27 08:30:43', 13, '9999', '03-9999-9999', '0399999999', 1, '2014-08-27 08:30:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://baukis.example.com/customers
Completed 302 Found in 42ms (ActiveRecord: 3.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:43 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 19 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (64.0ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 95ms (Views: 92.5ms | ActiveRecord: 0.8ms)
  [1m[36mCustomer Load (0.4ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 13 LIMIT 1[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 13 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 22[0m
  [1m[35mPhone Load (0.2ms)[0m  SELECT `phones`.* FROM `phones`  WHERE `phones`.`address_id` = 22  ORDER BY `phones`.`id` ASC
  [1m[36m (12.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE `customers`.`email_for_index` = BINARY 'member10@example.jp' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `customers` (`birth_mday`, `birth_month`, `birth_year`, `birthday`, `created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `gender`, `given_name`, `given_name_kana`, `hashed_password`, `updated_at`) VALUES (1, 1, 1970, '1970-01-01', '2014-08-27 08:30:44', 'member10@example.jp', 'member10@example.jp', '山田', 'ヤマダ', 'male', '太郎', 'タロウ', '$2a$10$FRDFsbmam6Q2xV/ph2RkaOUTVFfqBxQYy1ixteM6TQdJtMh1K/MOC', '2014-08-27 08:30:44')[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `addresses` (`address1`, `address2`, `city`, `created_at`, `customer_id`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '千代田区', '2014-08-27 08:30:44', 14, '1000001', '東京都', 'HomeAddress', '2014-08-27 08:30:44')
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `addresses` (`address1`, `address2`, `city`, `company_name`, `created_at`, `customer_id`, `division_name`, `postal_code`, `prefecture`, `type`, `updated_at`) VALUES ('試験1-1-1', '', '港区', 'テスト', '2014-08-27 08:30:44', 14, '開発部', '1050000', '東京都', 'WorkAddress', '2014-08-27 08:30:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member25@example.com' LIMIT 1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:44', 'member25@example.com', 'member25@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$45jsZMQ2YdQigYnsGHL1zes86ePwJ1ImspUvsZ6tX/8Qvvu6Vjr3e', '2014-08-26', '2014-08-27 08:30:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/login" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::SessionsController#new as HTML
  Parameters: {"host"=>"baukis.example.com"}
  Rendered staff/shared/_header.html.erb (0.9ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 23ms (Views: 22.7ms | ActiveRecord: 0.0ms)
Started POST "/session" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::SessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "staff_login_form"=>{"email"=>"member25@example.com", "password"=>"[FILTERED]"}, "commit"=>"ログイン", "host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.4ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`email_for_index` = 'member25@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_events` (`created_at`, `staff_member_id`, `type`) VALUES ('2014-08-27 08:30:44', 20, 'logged_in')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/
Completed 302 Found in 88ms (ActiveRecord: 0.9ms)
Started GET "/" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::TopController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 20 LIMIT 1[0m
  Rendered staff/shared/_header.html.erb (0.8ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 33ms (Views: 30.0ms | ActiveRecord: 0.3ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[35mStaffMember Load (0.4ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 20 LIMIT 1
  Rendered staff/customers/_search_form.html.erb (19.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `customers`[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 47ms (Views: 43.9ms | ActiveRecord: 0.9ms)
Started GET "/customers/14/edit" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::CustomersController#edit as HTML
  Parameters: {"host"=>"baukis.example.com", "id"=>"14"}
  [1m[36mStaffMember Load (0.3ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 20 LIMIT 1[0m
  [1m[35mCustomer Load (0.3ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 14 LIMIT 1
  [1m[36m (8.8ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 14 AND `phones`.`address_id` IS NULL[0m
  [1m[35mHomeAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 14 LIMIT 1
  [1m[36mWorkAddress Load (0.3ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 14 LIMIT 1[0m
  [1m[35m (0.9ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 24
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 25[0m
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_phone_fields.html.erb (1.2ms)
  Rendered staff/customers/_customer_fields.html.erb (11.5ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.9ms)
  Rendered staff/customers/_home_address_fields.html.erb (9.7ms)
  Rendered staff/customers/_phone_fields.html.erb (1.1ms)
  Rendered staff/customers/_phone_fields.html.erb (0.8ms)
  Rendered staff/customers/_work_address_fields.html.erb (10.6ms)
  Rendered staff/customers/_form.html.erb (33.5ms)
  Rendered staff/shared/_header.html.erb (0.5ms)
  Rendered shared/_footer.html.erb (0.0ms)
Completed 200 OK in 79ms (Views: 56.1ms | ActiveRecord: 10.9ms)
Started PATCH "/customers/14" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::CustomersController#update as HTML
  Parameters: {"utf8"=>"✓", "form"=>{"customer"=>{"email"=>"member10@example.jp", "family_name"=>"山田", "given_name"=>"太郎", "family_name_kana"=>"ヤマダ", "given_name_kana"=>"タロウ", "birthday"=>"1970-01-01", "gender"=>"male", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_home_address"=>"1", "home_address"=>{"postal_code"=>"1000001", "prefecture"=>"東京都", "city"=>"千代田区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"", "primary"=>"0"}, "1"=>{"number"=>"", "primary"=>"0"}}}, "inputs_work_address"=>"1", "work_address"=>{"company_name"=>"テスト", "division_name"=>"開発部", "postal_code"=>"1050000", "prefecture"=>"東京都", "city"=>"港区", "address1"=>"試験1-1-1", "address2"=>"", "phones"=>{"0"=>{"number"=>"03-9999-1111", "primary"=>"1"}, "1"=>{"number"=>"", "primary"=>"0"}}}}, "commit"=>"更新", "host"=>"baukis.example.com", "id"=>"14"}
  [1m[35mStaffMember Load (0.3ms)[0m  SELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 20 LIMIT 1
  [1m[36mCustomer Load (0.5ms)[0m  [1mSELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 14 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`customer_id` = 14 AND `phones`.`address_id` IS NULL
  [1m[36mHomeAddress Load (0.2ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('HomeAddress') AND `addresses`.`customer_id` = 14 LIMIT 1[0m
  [1m[35mWorkAddress Load (0.3ms)[0m  SELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 14 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 24[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 25
Unpermitted parameters: phones
Unpermitted parameters: email, family_name, given_name, family_name_kana, given_name_kana, birthday, gender
Unpermitted parameters: phones
Unpermitted parameters: postal_code, prefecture, city, address1, address2
Unpermitted parameters: phones
Unpermitted parameters: company_name, division_name, postal_code, prefecture, city, address1, address2
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mCustomer Exists (0.3ms)[0m  SELECT  1 AS one FROM `customers`  WHERE (`customers`.`email_for_index` = BINARY 'member10@example.jp' AND `customers`.`id` != 14) LIMIT 1
  [1m[36mAddress Load (0.2ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`id` = 25 LIMIT 1[0m
  [1m[35mCustomer Load (0.6ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 14 LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `phones` (`address_id`, `created_at`, `customer_id`, `last_four_digits`, `number`, `number_for_index`, `primary`, `updated_at`) VALUES (25, '2014-08-27 08:30:44', 14, '1111', '03-9999-1111', '0399991111', 1, '2014-08-27 08:30:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://baukis.example.com/customers
Completed 302 Found in 27ms (ActiveRecord: 3.6ms)
Started GET "/customers" for 127.0.0.1 at 2014-08-27 08:30:44 +0000
Processing by Staff::CustomersController#index as HTML
  Parameters: {"host"=>"baukis.example.com"}
  [1m[36mStaffMember Load (0.5ms)[0m  [1mSELECT  `staff_members`.* FROM `staff_members`  WHERE `staff_members`.`id` = 20 LIMIT 1[0m
  Rendered staff/customers/_search_form.html.erb (18.6ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM `customers`
  [1m[36mCustomer Load (0.2ms)[0m  [1mSELECT  `customers`.* FROM `customers`   ORDER BY `customers`.`family_name_kana` ASC, `customers`.`given_name_kana` ASC LIMIT 10 OFFSET 0[0m
  Rendered staff/shared/_header.html.erb (0.6ms)
  Rendered shared/_footer.html.erb (0.1ms)
Completed 200 OK in 48ms (Views: 44.7ms | ActiveRecord: 0.9ms)
  [1m[35mCustomer Load (0.0ms)[0m  SELECT  `customers`.* FROM `customers`  WHERE `customers`.`id` = 14 LIMIT 1
  [1m[36mWorkAddress Load (0.4ms)[0m  [1mSELECT  `addresses`.* FROM `addresses`  WHERE `addresses`.`type` IN ('WorkAddress') AND `addresses`.`customer_id` = 14 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  SELECT COUNT(*) FROM `phones`  WHERE `phones`.`address_id` = 25
  [1m[36mPhone Load (0.2ms)[0m  [1mSELECT `phones`.* FROM `phones`  WHERE `phones`.`address_id` = 25  ORDER BY `phones`.`id` ASC[0m
  [1m[35m (1.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:44', 'test@example.com', 'test@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$5vbFolUPza6zhve0Ahah9O14e4RFdkkhEbrwsomgEnEZ6TjDaDPlO', '2014-08-26', '2014-08-27 08:30:44')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:44', 'test@example.com', 'test@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$M5Z4LeKkZZyxtcC9mljTYuxM7W9oLTFxzf0sDYJR7plzCJ5fZjUE6', '2014-08-26', '2014-08-27 08:30:44')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (10.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'test@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:44', 'test@example.com', 'test@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$LciNN8jc65IaoFqeDquvEOIH8S.2RyuVjj88K3PhXadauEp13J6P2', '2014-08-26', '2014-08-27 08:30:44')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member26@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:45', 'member26@example.com', 'member26@example.com', '山田', 'テスト', '太郎', 'タロウ', '$2a$10$dvDuZYj3jetvFq3RjD1wrezIuaQJ06LONd8myP2cJpppW.F3P8NXG', '2014-08-26', '2014-08-27 08:30:45')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member27@example.com' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:45', 'member27@example.com', 'member27@example.com', '山田', 'テスト', '太郎', 'タロウ', '$2a$10$CwQbKQOdBmvIdL1Mpu9/sO27e1FhScQO/3G9nyIwWPxosrkWk4iUa', '2014-08-26', '2014-08-27 08:30:45')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'test@@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mStaffMember Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member28@example.com' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.5ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member29@example.com' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member30@example.com' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `staff_members` (`created_at`, `email`, `email_for_index`, `family_name`, `family_name_kana`, `given_name`, `given_name_kana`, `hashed_password`, `start_date`, `updated_at`) VALUES ('2014-08-27 08:30:45', 'member30@example.com', 'member30@example.com', '山田', 'ヤマダ', '太郎', 'タロウ', '$2a$10$slXKw/ATFU9zoBO.KsSKIeEDS2hICL477Wo74.j5uns/w.T4IMCXe', '2014-08-26', '2014-08-27 08:30:45')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mStaffMember Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member30@example.com' LIMIT 1[0m
  [1m[35m (0.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mStaffMember Exists (0.3ms)[0m  SELECT  1 AS one FROM `staff_members`  WHERE `staff_members`.`email_for_index` = BINARY 'member31@example.com' LIMIT 1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.7ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.5ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
